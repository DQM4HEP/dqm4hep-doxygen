<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DQMNet: dqm4hep::net::SocketServerBase&lt; socket_type &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DQMNet
   &#160;<span id="projectnumber">0.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacedqm4hep.html">dqm4hep</a></li><li class="navelem"><a class="el" href="namespacedqm4hep_1_1net.html">net</a></li><li class="navelem"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">SocketServerBase</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classdqm4hep_1_1net_1_1SocketServerBase-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">dqm4hep::net::SocketServerBase&lt; socket_type &gt; Class Template Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="WsServer_8h_source.html">WsServer.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for dqm4hep::net::SocketServerBase&lt; socket_type &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classdqm4hep_1_1net_1_1SocketServerBase.png" usemap="#dqm4hep::net::SocketServerBase&lt; socket_type &gt;_map" alt=""/>
  <map id="dqm4hep::net::SocketServerBase&lt; socket_type &gt;_map" name="dqm4hep::net::SocketServerBase&lt; socket_type &gt;_map">
<area href="classdqm4hep_1_1net_1_1SocketServer.html" alt="dqm4hep::net::SocketServer&lt; socket_type &gt;" shape="rect" coords="0,56,287,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html">Config</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Message.html">Message</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1regex__orderable.html">regex_orderable</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1SendStream.html">SendStream</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1streambuffer.html">streambuffer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af3f985bb95a2f38878e9be4a23c28d7e"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#af3f985bb95a2f38878e9be4a23c28d7e">~SocketServerBase</a> ()</td></tr>
<tr class="separator:af3f985bb95a2f38878e9be4a23c28d7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16702a0101cc52df1dffad1d63ca05f4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a16702a0101cc52df1dffad1d63ca05f4">start</a> ()</td></tr>
<tr class="separator:a16702a0101cc52df1dffad1d63ca05f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c359458c531d453c9da57b313fcff4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a9c359458c531d453c9da57b313fcff4a">stop</a> ()</td></tr>
<tr class="separator:a9c359458c531d453c9da57b313fcff4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe21ad77ce8a2da231ef7c8b57db179c"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1SendStream.html">SendStream</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#abe21ad77ce8a2da231ef7c8b57db179c">prepareHeader</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1SendStream.html">SendStream</a> &gt; &amp;message_stream, unsigned char fin_rsv_opcode) const </td></tr>
<tr class="separator:abe21ad77ce8a2da231ef7c8b57db179c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b9bb31b0753f0f77fed9db6d499f370"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a4b9bb31b0753f0f77fed9db6d499f370">forward</a> (const std::unordered_set&lt; std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt;&gt; &amp;connections, const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1SendStream.html">SendStream</a> &gt; &amp;message_stream, const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;callback=nullptr, unsigned char fin_rsv_opcode=129) const </td></tr>
<tr class="separator:a4b9bb31b0753f0f77fed9db6d499f370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c9557d5442d9d957c4923f824cb4dfc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8c9557d5442d9d957c4923f824cb4dfc">send</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1SendStream.html">SendStream</a> &gt; &amp;message_stream, const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;callback=nullptr, unsigned char fin_rsv_opcode=129) const </td></tr>
<tr class="memdesc:a8c9557d5442d9d957c4923f824cb4dfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">fin_rsv_opcode: 129=one fragment, text, 130=one fragment, binary, 136=close connection.  <a href="#a8c9557d5442d9d957c4923f824cb4dfc">More...</a><br/></td></tr>
<tr class="separator:a8c9557d5442d9d957c4923f824cb4dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa345c6d91ca77b6a8ed919ba5a65f387"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa345c6d91ca77b6a8ed919ba5a65f387">send_close</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, int status, const std::string &amp;reason=&quot;&quot;, const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;callback=nullptr) const </td></tr>
<tr class="separator:aa345c6d91ca77b6a8ed919ba5a65f387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6befe4a38f8468a7f8df79cd009764f"><td class="memItemLeft" align="right" valign="top">std::unordered_set<br class="typebreak"/>
&lt; std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa6befe4a38f8468a7f8df79cd009764f">get_connections</a> ()</td></tr>
<tr class="separator:aa6befe4a38f8468a7f8df79cd009764f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3278baa010f69ff25265dddf4a96da18"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a3278baa010f69ff25265dddf4a96da18">upgrade</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection)</td></tr>
<tr class="memdesc:a3278baa010f69ff25265dddf4a96da18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Upgrades a request, from for instance Simple-Web-Server, to a WebSocket connection.  <a href="#a3278baa010f69ff25265dddf4a96da18">More...</a><br/></td></tr>
<tr class="separator:a3278baa010f69ff25265dddf4a96da18"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ad2a44585e5e5c778d75948651e798705"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html">Config</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a></td></tr>
<tr class="memdesc:ad2a44585e5e5c778d75948651e798705"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set before calling <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a16702a0101cc52df1dffad1d63ca05f4">start()</a>.  <a href="#ad2a44585e5e5c778d75948651e798705">More...</a><br/></td></tr>
<tr class="separator:ad2a44585e5e5c778d75948651e798705"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc85579f4c8875d8965174df8b09bbb"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1regex__orderable.html">regex_orderable</a>, <br class="typebreak"/>
<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a></td></tr>
<tr class="memdesc:a8dc85579f4c8875d8965174df8b09bbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Warning: do not add or remove endpoints after <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a16702a0101cc52df1dffad1d63ca05f4">start()</a> is called.  <a href="#a8dc85579f4c8875d8965174df8b09bbb">More...</a><br/></td></tr>
<tr class="separator:a8dc85579f4c8875d8965174df8b09bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9dac38e21b01d2867f44c9c845c15e7"><td class="memItemLeft" align="right" valign="top">std::shared_ptr<br class="typebreak"/>
&lt; boost::asio::io_service &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">io_service</a></td></tr>
<tr class="memdesc:ab9dac38e21b01d2867f44c9c845c15e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">If you have your own boost::asio::io_service, store its pointer here before running <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a16702a0101cc52df1dffad1d63ca05f4">start()</a>.  <a href="#ab9dac38e21b01d2867f44c9c845c15e7">More...</a><br/></td></tr>
<tr class="separator:ab9dac38e21b01d2867f44c9c845c15e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ace496718dbf430c2467c043c223a630a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ace496718dbf430c2467c043c223a630a">SocketServerBase</a> (unsigned short port)</td></tr>
<tr class="separator:ace496718dbf430c2467c043c223a630a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa488ddcfbdd6e525e30603933ff7db46"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa488ddcfbdd6e525e30603933ff7db46">accept</a> ()=0</td></tr>
<tr class="separator:aa488ddcfbdd6e525e30603933ff7db46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab17683d333147e40bf70b30aa5d59ef7"><td class="memItemLeft" align="right" valign="top">std::shared_ptr<br class="typebreak"/>
&lt; boost::asio::deadline_timer &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab17683d333147e40bf70b30aa5d59ef7">get_timeout_timer</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, size_t seconds)</td></tr>
<tr class="separator:ab17683d333147e40bf70b30aa5d59ef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf0f9a3697470c738b18c58993e1b65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a6bf0f9a3697470c738b18c58993e1b65">read_handshake</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection)</td></tr>
<tr class="separator:a6bf0f9a3697470c738b18c58993e1b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a956dda79c0c81accdc11e6c1121bdb3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a956dda79c0c81accdc11e6c1121bdb3a">parse_handshake</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, std::istream &amp;stream) const </td></tr>
<tr class="separator:a956dda79c0c81accdc11e6c1121bdb3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa07433c182af43ad9866cb141f008371"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa07433c182af43ad9866cb141f008371">write_handshake</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;read_buffer)</td></tr>
<tr class="separator:aa07433c182af43ad9866cb141f008371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a745537fddf9541eea42e0eeda1d74ac0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a745537fddf9541eea42e0eeda1d74ac0">generate_handshake</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, std::ostream &amp;handshake) const </td></tr>
<tr class="separator:a745537fddf9541eea42e0eeda1d74ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab803fe550ac395f4c6903f76adab437b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab803fe550ac395f4c6903f76adab437b">read_message</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;read_buffer, <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &amp;<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>) const </td></tr>
<tr class="separator:ab803fe550ac395f4c6903f76adab437b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd14d0483fbcc8165d0f2f3d37131c21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#acd14d0483fbcc8165d0f2f3d37131c21">read_message_content</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;read_buffer, size_t length, <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &amp;<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, unsigned char fin_rsv_opcode) const </td></tr>
<tr class="separator:acd14d0483fbcc8165d0f2f3d37131c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfb0f346aee5f6c72a1306870f885c6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#adfb0f346aee5f6c72a1306870f885c6f">connection_open</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &amp;<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>)</td></tr>
<tr class="separator:adfb0f346aee5f6c72a1306870f885c6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae88d906b5680b56905e053c499f1e00a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ae88d906b5680b56905e053c499f1e00a">connection_close</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &amp;<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, int status, const std::string &amp;reason) const </td></tr>
<tr class="separator:ae88d906b5680b56905e053c499f1e00a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d50d25bb410583480e3e4cea06fa182"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8d50d25bb410583480e3e4cea06fa182">connection_error</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection, <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &amp;<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, const boost::system::error_code &amp;ec) const </td></tr>
<tr class="separator:a8d50d25bb410583480e3e4cea06fa182"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a09dd1b531bc3d76f4ba4a55a01113"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa8a09dd1b531bc3d76f4ba4a55a01113">timer_idle_init</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection)</td></tr>
<tr class="separator:aa8a09dd1b531bc3d76f4ba4a55a01113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab93aeff2a658d0138bed8f37062cd35c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab93aeff2a658d0138bed8f37062cd35c">timer_idle_reset</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection) const </td></tr>
<tr class="separator:ab93aeff2a658d0138bed8f37062cd35c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c14ed034b6a93ed76d50f713320c83b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a3c14ed034b6a93ed76d50f713320c83b">timer_idle_cancel</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection) const </td></tr>
<tr class="separator:a3c14ed034b6a93ed76d50f713320c83b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad347c3e9ee2ad4142c0bdbefffc8de6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad347c3e9ee2ad4142c0bdbefffc8de6c">timer_idle_expired_function</a> (const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;connection) const </td></tr>
<tr class="separator:ad347c3e9ee2ad4142c0bdbefffc8de6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a9da983d3f5b891243b1069c153300602"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a9da983d3f5b891243b1069c153300602">ws_magic_string</a> = &quot;258EAFA5-E914-47DA-95CA-C5AB0DC85B11&quot;</td></tr>
<tr class="separator:a9da983d3f5b891243b1069c153300602"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f4346e16c6c4b7e7fa30c8d8dac309"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; boost::asio::ip::tcp::acceptor &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a91f4346e16c6c4b7e7fa30c8d8dac309">acceptor</a></td></tr>
<tr class="separator:a91f4346e16c6c4b7e7fa30c8d8dac309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22180377e3d7391233273d45b0c09a63"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::thread &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a22180377e3d7391233273d45b0c09a63">threads</a></td></tr>
<tr class="separator:a22180377e3d7391233273d45b0c09a63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class socket_type&gt;<br/>
class dqm4hep::net::SocketServerBase&lt; socket_type &gt;</h3>


<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00301">301</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="af3f985bb95a2f38878e9be4a23c28d7e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::~<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">SocketServerBase</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00303">303</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                  {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ace496718dbf430c2467c043c223a630a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">SocketServerBase</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>port</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00697">697</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                            : <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>(port) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ad2a44585e5e5c778d75948651e798705"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">dqm4hep::net::SocketServerBase::config</a></div><div class="ttdeci">Config config</div><div class="ttdoc">Set before calling start(). </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00495">WsServer.h:495</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa488ddcfbdd6e525e30603933ff7db46"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::accept </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classdqm4hep_1_1net_1_1SocketServer_3_01WS_01_4.html#a76b67e972029048457cc69f2f7578e47">dqm4hep::net::SocketServer&lt; WS &gt;</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00515">dqm4hep::net::SocketServerBase&lt; WS &gt;::start()</a>.</p>

</div>
</div>
<a class="anchor" id="ae88d906b5680b56905e053c499f1e00a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::connection_close </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &amp;&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00966">966</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                                                           {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a3c14ed034b6a93ed76d50f713320c83b">timer_idle_cancel</a>(connection);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        {</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;          std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.connections_mutex);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.connections.erase(connection);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.on_close)</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.on_close(connection, status, reason);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8dc85579f4c8875d8965174df8b09bbb"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">dqm4hep::net::SocketServerBase::endpoint</a></div><div class="ttdeci">std::map&lt; regex_orderable, Endpoint &gt; endpoint</div><div class="ttdoc">Warning: do not add or remove endpoints after start() is called. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00513">WsServer.h:513</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a3c14ed034b6a93ed76d50f713320c83b"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a3c14ed034b6a93ed76d50f713320c83b">dqm4hep::net::SocketServerBase::timer_idle_cancel</a></div><div class="ttdeci">void timer_idle_cancel(const std::shared_ptr&lt; Connection &gt; &amp;connection) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l01009">WsServer.h:1009</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8d50d25bb410583480e3e4cea06fa182"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::connection_error </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &amp;&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const boost::system::error_code &amp;&#160;</td>
          <td class="paramname"><em>ec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00979">979</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                                                                   {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a3c14ed034b6a93ed76d50f713320c83b">timer_idle_cancel</a>(connection);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;          std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.connections_mutex);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.connections.erase(connection);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.on_error)</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.on_error(connection, ec);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8dc85579f4c8875d8965174df8b09bbb"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">dqm4hep::net::SocketServerBase::endpoint</a></div><div class="ttdeci">std::map&lt; regex_orderable, Endpoint &gt; endpoint</div><div class="ttdoc">Warning: do not add or remove endpoints after start() is called. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00513">WsServer.h:513</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a3c14ed034b6a93ed76d50f713320c83b"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a3c14ed034b6a93ed76d50f713320c83b">dqm4hep::net::SocketServerBase::timer_idle_cancel</a></div><div class="ttdeci">void timer_idle_cancel(const std::shared_ptr&lt; Connection &gt; &amp;connection) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l01009">WsServer.h:1009</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adfb0f346aee5f6c72a1306870f885c6f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::connection_open </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &amp;&#160;</td>
          <td class="paramname"><em>endpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00954">954</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                                                                            {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa8a09dd1b531bc3d76f4ba4a55a01113">timer_idle_init</a>(connection);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;          std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.connections_mutex);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.connections.insert(connection);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.on_open)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.on_open(connection);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8dc85579f4c8875d8965174df8b09bbb"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">dqm4hep::net::SocketServerBase::endpoint</a></div><div class="ttdeci">std::map&lt; regex_orderable, Endpoint &gt; endpoint</div><div class="ttdoc">Warning: do not add or remove endpoints after start() is called. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00513">WsServer.h:513</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_aa8a09dd1b531bc3d76f4ba4a55a01113"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa8a09dd1b531bc3d76f4ba4a55a01113">dqm4hep::net::SocketServerBase::timer_idle_init</a></div><div class="ttdeci">void timer_idle_init(const std::shared_ptr&lt; Connection &gt; &amp;connection)</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00992">WsServer.h:992</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b9bb31b0753f0f77fed9db6d499f370"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::forward </td>
          <td>(</td>
          <td class="paramtype">const std::unordered_set&lt; std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>connections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1SendStream.html">SendStream</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>message_stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;&#160;</td>
          <td class="paramname"><em>callback</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>fin_rsv_opcode</em> = <code>129</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00600">600</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                                             {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keyword">auto</span> header_stream = <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#abe21ad77ce8a2da231ef7c8b57db179c">prepareHeader</a>(message_stream, fin_rsv_opcode);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> connection : connections) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          <span class="keywordflow">if</span> (fin_rsv_opcode != 136)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab93aeff2a658d0138bed8f37062cd35c">timer_idle_reset</a>(connection);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          connection-&gt;strand.post([<span class="keyword">this</span>, connection, header_stream, message_stream, callback]() {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            connection-&gt;send_queue.emplace_back(header_stream, message_stream, callback);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">if</span> (connection-&gt;send_queue.size() == 1)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;              connection-&gt;send_from_queue(connection);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          });</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_abe21ad77ce8a2da231ef7c8b57db179c"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#abe21ad77ce8a2da231ef7c8b57db179c">dqm4hep::net::SocketServerBase::prepareHeader</a></div><div class="ttdeci">std::shared_ptr&lt; SendStream &gt; prepareHeader(const std::shared_ptr&lt; SendStream &gt; &amp;message_stream, unsigned char fin_rsv_opcode) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00573">WsServer.h:573</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ab93aeff2a658d0138bed8f37062cd35c"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab93aeff2a658d0138bed8f37062cd35c">dqm4hep::net::SocketServerBase::timer_idle_reset</a></div><div class="ttdeci">void timer_idle_reset(const std::shared_ptr&lt; Connection &gt; &amp;connection) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l01002">WsServer.h:1002</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a745537fddf9541eea42e0eeda1d74ac0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::generate_handshake </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>handshake</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00803">803</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                                                                                        {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keyword">auto</span> header_it = connection-&gt;header.find(<span class="stringliteral">&quot;Sec-WebSocket-Key&quot;</span>);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordflow">if</span> (header_it == connection-&gt;header.end())</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keyword">auto</span> sha1 = <a class="code" href="classdqm4hep_1_1net_1_1Crypto.html#a51229f7a2fabc140bb32f4afb075e6a6">Crypto::sha1</a>(header_it-&gt;second + <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a9da983d3f5b891243b1069c153300602">ws_magic_string</a>);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        handshake &lt;&lt; <span class="stringliteral">&quot;HTTP/1.1 101 Web Socket Protocol Handshake\r\n&quot;</span>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        handshake &lt;&lt; <span class="stringliteral">&quot;Upgrade: websocket\r\n&quot;</span>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        handshake &lt;&lt; <span class="stringliteral">&quot;Connection: Upgrade\r\n&quot;</span>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        handshake &lt;&lt; <span class="stringliteral">&quot;Sec-WebSocket-Accept: &quot;</span> &lt;&lt; <a class="code" href="classdqm4hep_1_1net_1_1Crypto_1_1Base64.html#a23270685396b5ed726be6ce30743defa">Crypto::Base64::encode</a>(sha1) &lt;&lt; <span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        handshake &lt;&lt; <span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1Crypto_1_1Base64_html_a23270685396b5ed726be6ce30743defa"><div class="ttname"><a href="classdqm4hep_1_1net_1_1Crypto_1_1Base64.html#a23270685396b5ed726be6ce30743defa">dqm4hep::net::Crypto::Base64::encode</a></div><div class="ttdeci">static std::string encode(const std::string &amp;ascii)</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00088">WsServer.h:88</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a9da983d3f5b891243b1069c153300602"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a9da983d3f5b891243b1069c153300602">dqm4hep::net::SocketServerBase::ws_magic_string</a></div><div class="ttdeci">const std::string ws_magic_string</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00691">WsServer.h:691</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1Crypto_html_a51229f7a2fabc140bb32f4afb075e6a6"><div class="ttname"><a href="classdqm4hep_1_1net_1_1Crypto.html#a51229f7a2fabc140bb32f4afb075e6a6">dqm4hep::net::Crypto::sha1</a></div><div class="ttdeci">static std::string sha1(const std::string &amp;input, size_t iterations=1)</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00182">WsServer.h:182</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa6befe4a38f8468a7f8df79cd009764f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;std::shared_ptr&lt;<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a>&gt; &gt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::get_connections </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00654">654</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                                                    {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        std::unordered_set&lt;std::shared_ptr&lt;Connection&gt;&gt; all_connections;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;e : <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>) {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          std::lock_guard&lt;std::mutex&gt; lock(e.second.connections_mutex);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          all_connections.insert(e.second.connections.begin(), e.second.connections.end());</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">return</span> all_connections;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8dc85579f4c8875d8965174df8b09bbb"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">dqm4hep::net::SocketServerBase::endpoint</a></div><div class="ttdeci">std::map&lt; regex_orderable, Endpoint &gt; endpoint</div><div class="ttdoc">Warning: do not add or remove endpoints after start() is called. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00513">WsServer.h:513</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab17683d333147e40bf70b30aa5d59ef7"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;boost::asio::deadline_timer&gt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::get_timeout_timer </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>seconds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00702">702</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00718">dqm4hep::net::SocketServerBase&lt; WS &gt;::read_handshake()</a>.</p>
<div class="fragment"><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                                                                     {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">if</span> (seconds == 0)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keyword">auto</span> timer = std::make_shared&lt;boost::asio::deadline_timer&gt;(connection-&gt;socket-&gt;get_io_service());</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        timer-&gt;expires_from_now(boost::posix_time::seconds(static_cast&lt;long&gt;(seconds)));</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        timer-&gt;async_wait([connection](<span class="keyword">const</span> boost::system::error_code &amp;ec) {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          <span class="keywordflow">if</span> (!ec) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            connection-&gt;socket-&gt;lowest_layer().shutdown(boost::asio::ip::tcp::socket::shutdown_both);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            connection-&gt;socket-&gt;lowest_layer().close();</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;          }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        });</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">return</span> timer;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a956dda79c0c81accdc11e6c1121bdb3a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::parse_handshake </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00744">744</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00718">dqm4hep::net::SocketServerBase&lt; WS &gt;::read_handshake()</a>.</p>
<div class="fragment"><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                                                                                                  {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        std::string line;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        getline(stream, line);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordtype">size_t</span> method_end;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keywordflow">if</span> ((method_end = line.find(<span class="charliteral">&#39; &#39;</span>)) != std::string::npos) {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          <span class="keywordtype">size_t</span> path_end;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          <span class="keywordflow">if</span> ((path_end = line.find(<span class="charliteral">&#39; &#39;</span>, method_end + 1)) != std::string::npos) {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            connection-&gt;method = line.substr(0, method_end);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            connection-&gt;path = line.substr(method_end + 1, path_end - method_end - 1);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <span class="keywordflow">if</span> ((path_end + 6) &lt; line.size())</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;              connection-&gt;http_version = line.substr(path_end + 6, line.size() - (path_end + 6) - 1);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;              connection-&gt;http_version = <span class="stringliteral">&quot;1.1&quot;</span>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            getline(stream, line);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="keywordtype">size_t</span> param_end;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="keywordflow">while</span> ((param_end = line.find(<span class="charliteral">&#39;:&#39;</span>)) != std::string::npos) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;              <span class="keywordtype">size_t</span> value_start = param_end + 1;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;              <span class="keywordflow">if</span> ((value_start) &lt; line.size()) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                <span class="keywordflow">if</span> (line[value_start] == <span class="charliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                  value_start++;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                <span class="keywordflow">if</span> (value_start &lt; line.size())</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                  connection-&gt;header.emplace(line.substr(0, param_end),</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                             line.substr(value_start, line.size() - value_start - 1));</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;              }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;              getline(stream, line);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;          }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abe21ad77ce8a2da231ef7c8b57db179c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1SendStream.html">SendStream</a>&gt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::prepareHeader </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1SendStream.html">SendStream</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>message_stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>fin_rsv_opcode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00573">573</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00600">dqm4hep::net::SocketServerBase&lt; WS &gt;::forward()</a>, and <a class="el" href="WsServer_8h_source.html#l00620">dqm4hep::net::SocketServerBase&lt; WS &gt;::send()</a>.</p>
<div class="fragment"><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                                                                    {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keyword">auto</span> header_stream = std::make_shared&lt;SendStream&gt;();</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordtype">size_t</span> length = message_stream-&gt;size();</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        header_stream-&gt;put(fin_rsv_opcode);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="comment">// unmasked (first length byte&lt;128)</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">if</span> (length &gt;= 126) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;          <span class="keywordtype">int</span> num_bytes;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          <span class="keywordflow">if</span> (length &gt; 0xffff) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            num_bytes = 8;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            header_stream-&gt;put(127);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            num_bytes = 2;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            header_stream-&gt;put(126);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = num_bytes - 1; c &gt;= 0; c--) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            header_stream-&gt;put((static_cast&lt;unsigned long long&gt;(length) &gt;&gt; (8 * c)) % 256);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;          }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          header_stream-&gt;put(static_cast&lt;unsigned char&gt;(length));</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">return</span> header_stream;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6bf0f9a3697470c738b18c58993e1b65"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::read_handshake </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00718">718</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                                                                       {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        connection-&gt;read_remote_endpoint_data();</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="comment">// Create new read_buffer for async_read_until()</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">// Shared_ptr is used to pass temporary objects to the asynchronous functions</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keyword">auto</span> read_buffer = std::make_shared&lt;boost::asio::streambuf&gt;();</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="comment">// Set timeout on the following boost::asio::async-read or write function</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keyword">auto</span> timer = <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab17683d333147e40bf70b30aa5d59ef7">get_timeout_timer</a>(connection, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a8a2ec06c8b39429fb8c114dadb485d90">timeout_request</a>);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        boost::asio::async_read_until(</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            *connection-&gt;socket, *read_buffer, <span class="stringliteral">&quot;\r\n\r\n&quot;</span>,</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            [<span class="keyword">this</span>, connection, read_buffer, timer](<span class="keyword">const</span> boost::system::error_code &amp;ec, <span class="keywordtype">size_t</span> <span class="comment">/*bytes_transferred*/</span>) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;              if (timer)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                timer-&gt;cancel();</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;              <span class="keywordflow">if</span> (!ec) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <span class="comment">// Convert to istream to extract string-lines</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                std::istream stream(read_buffer.get());</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a956dda79c0c81accdc11e6c1121bdb3a">parse_handshake</a>(connection, stream);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa07433c182af43ad9866cb141f008371">write_handshake</a>(connection, read_buffer);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;              }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            });</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_aa07433c182af43ad9866cb141f008371"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa07433c182af43ad9866cb141f008371">dqm4hep::net::SocketServerBase::write_handshake</a></div><div class="ttdeci">void write_handshake(const std::shared_ptr&lt; Connection &gt; &amp;connection, const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;read_buffer)</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00776">WsServer.h:776</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ad2a44585e5e5c778d75948651e798705"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">dqm4hep::net::SocketServerBase::config</a></div><div class="ttdeci">Config config</div><div class="ttdoc">Set before calling start(). </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00495">WsServer.h:495</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ab17683d333147e40bf70b30aa5d59ef7"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab17683d333147e40bf70b30aa5d59ef7">dqm4hep::net::SocketServerBase::get_timeout_timer</a></div><div class="ttdeci">std::shared_ptr&lt; boost::asio::deadline_timer &gt; get_timeout_timer(const std::shared_ptr&lt; Connection &gt; &amp;connection, size_t seconds)</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00702">WsServer.h:702</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a956dda79c0c81accdc11e6c1121bdb3a"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a956dda79c0c81accdc11e6c1121bdb3a">dqm4hep::net::SocketServerBase::parse_handshake</a></div><div class="ttdeci">void parse_handshake(const std::shared_ptr&lt; Connection &gt; &amp;connection, std::istream &amp;stream) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00744">WsServer.h:744</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config_html_a8a2ec06c8b39429fb8c114dadb485d90"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a8a2ec06c8b39429fb8c114dadb485d90">dqm4hep::net::SocketServerBase::Config::timeout_request</a></div><div class="ttdeci">size_t timeout_request</div><div class="ttdoc">Timeout on request handling. Defaults to 5 seconds. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00484">WsServer.h:484</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab803fe550ac395f4c6903f76adab437b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::read_message </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;&#160;</td>
          <td class="paramname"><em>read_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &amp;&#160;</td>
          <td class="paramname"><em>endpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00819">819</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                                                                                        {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        boost::asio::async_read(</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            *connection-&gt;socket, *read_buffer, boost::asio::transfer_exactly(2),</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            [<span class="keyword">this</span>, connection, read_buffer, &amp;<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>](<span class="keyword">const</span> boost::system::error_code &amp;ec, <span class="keywordtype">size_t</span> bytes_transferred) {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;              if (!ec) {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="keywordflow">if</span> (bytes_transferred == 0) { <span class="comment">// TODO: why does this happen sometimes?</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                  <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab803fe550ac395f4c6903f76adab437b">read_message</a>(connection, read_buffer, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                std::istream stream(read_buffer.get());</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                std::vector&lt;unsigned char&gt; first_bytes;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                first_bytes.resize(2);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                stream.read((<span class="keywordtype">char</span> *)&amp;first_bytes[0], 2);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> fin_rsv_opcode = first_bytes[0];</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                <span class="comment">// Close connection if unmasked message from client (protocol error)</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                <span class="keywordflow">if</span> (first_bytes[1] &lt; 128) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                  <span class="keyword">const</span> std::string reason(<span class="stringliteral">&quot;message from client not masked&quot;</span>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                  <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa345c6d91ca77b6a8ed919ba5a65f387">send_close</a>(connection, 1002, reason, [<span class="keyword">this</span>, connection](<span class="keyword">const</span> boost::system::error_code &amp; <span class="comment">/*ec*/</span>) {});</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                  <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ae88d906b5680b56905e053c499f1e00a">connection_close</a>(connection, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, 1002, reason);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                <span class="keywordtype">size_t</span> length = (first_bytes[1] &amp; 127);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <span class="keywordflow">if</span> (length == 126) {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                  <span class="comment">// 2 next bytes is the size of content</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                  boost::asio::async_read(*connection-&gt;socket, *read_buffer, boost::asio::transfer_exactly(2),</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                                          [<span class="keyword">this</span>, connection, read_buffer, &amp;<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, fin_rsv_opcode](</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                              <span class="keyword">const</span> boost::system::error_code &amp;ec, <span class="keywordtype">size_t</span> <span class="comment">/*bytes_transferred*/</span>) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                                            if (!ec) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                                              std::istream stream(read_buffer.get());</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                                              std::vector&lt;unsigned char&gt; length_bytes;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                              length_bytes.resize(2);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                                              stream.read((<span class="keywordtype">char</span> *)&amp;length_bytes[0], 2);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                                              <span class="keywordtype">size_t</span> length = 0;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                                              <span class="keywordtype">int</span> num_bytes = 2;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; num_bytes; c++)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                                length += length_bytes[c] &lt;&lt; (8 * (num_bytes - 1 - c));</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                              <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#acd14d0483fbcc8165d0f2f3d37131c21">read_message_content</a>(connection, read_buffer, length, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>,</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                                                                   fin_rsv_opcode);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                                            } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                                              <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8d50d25bb410583480e3e4cea06fa182">connection_error</a>(connection, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, ec);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                          });</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (length == 127) {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                  <span class="comment">// 8 next bytes is the size of content</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                  boost::asio::async_read(*connection-&gt;socket, *read_buffer, boost::asio::transfer_exactly(8),</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                                          [<span class="keyword">this</span>, connection, read_buffer, &amp;<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, fin_rsv_opcode](</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                                              <span class="keyword">const</span> boost::system::error_code &amp;ec, <span class="keywordtype">size_t</span> <span class="comment">/*bytes_transferred*/</span>) {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                            if (!ec) {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                              std::istream stream(read_buffer.get());</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                              std::vector&lt;unsigned char&gt; length_bytes;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                                              length_bytes.resize(8);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                              stream.read((<span class="keywordtype">char</span> *)&amp;length_bytes[0], 8);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                                              <span class="keywordtype">size_t</span> length = 0;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                              <span class="keywordtype">int</span> num_bytes = 8;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                                              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; num_bytes; c++)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                                                length += length_bytes[c] &lt;&lt; (8 * (num_bytes - 1 - c));</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                              <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#acd14d0483fbcc8165d0f2f3d37131c21">read_message_content</a>(connection, read_buffer, length, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>,</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                                                   fin_rsv_opcode);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                                            } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                                              <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8d50d25bb410583480e3e4cea06fa182">connection_error</a>(connection, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, ec);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                                          });</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                  <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#acd14d0483fbcc8165d0f2f3d37131c21">read_message_content</a>(connection, read_buffer, length, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, fin_rsv_opcode);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;              } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8d50d25bb410583480e3e4cea06fa182">connection_error</a>(connection, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, ec);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            });</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_aa345c6d91ca77b6a8ed919ba5a65f387"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa345c6d91ca77b6a8ed919ba5a65f387">dqm4hep::net::SocketServerBase::send_close</a></div><div class="ttdeci">void send_close(const std::shared_ptr&lt; Connection &gt; &amp;connection, int status, const std::string &amp;reason=&quot;&quot;, const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;callback=nullptr) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00636">WsServer.h:636</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ae88d906b5680b56905e053c499f1e00a"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ae88d906b5680b56905e053c499f1e00a">dqm4hep::net::SocketServerBase::connection_close</a></div><div class="ttdeci">void connection_close(const std::shared_ptr&lt; Connection &gt; &amp;connection, Endpoint &amp;endpoint, int status, const std::string &amp;reason) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00966">WsServer.h:966</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8dc85579f4c8875d8965174df8b09bbb"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">dqm4hep::net::SocketServerBase::endpoint</a></div><div class="ttdeci">std::map&lt; regex_orderable, Endpoint &gt; endpoint</div><div class="ttdoc">Warning: do not add or remove endpoints after start() is called. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00513">WsServer.h:513</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8d50d25bb410583480e3e4cea06fa182"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8d50d25bb410583480e3e4cea06fa182">dqm4hep::net::SocketServerBase::connection_error</a></div><div class="ttdeci">void connection_error(const std::shared_ptr&lt; Connection &gt; &amp;connection, Endpoint &amp;endpoint, const boost::system::error_code &amp;ec) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00979">WsServer.h:979</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_acd14d0483fbcc8165d0f2f3d37131c21"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#acd14d0483fbcc8165d0f2f3d37131c21">dqm4hep::net::SocketServerBase::read_message_content</a></div><div class="ttdeci">void read_message_content(const std::shared_ptr&lt; Connection &gt; &amp;connection, const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;read_buffer, size_t length, Endpoint &amp;endpoint, unsigned char fin_rsv_opcode) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00898">WsServer.h:898</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ab803fe550ac395f4c6903f76adab437b"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab803fe550ac395f4c6903f76adab437b">dqm4hep::net::SocketServerBase::read_message</a></div><div class="ttdeci">void read_message(const std::shared_ptr&lt; Connection &gt; &amp;connection, const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;read_buffer, Endpoint &amp;endpoint) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00819">WsServer.h:819</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acd14d0483fbcc8165d0f2f3d37131c21"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::read_message_content </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;&#160;</td>
          <td class="paramname"><em>read_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a> &amp;&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>fin_rsv_opcode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00898">898</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                                                                                        {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        boost::asio::async_read(*connection-&gt;socket, *read_buffer, boost::asio::transfer_exactly(4 + length),</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                                [<span class="keyword">this</span>, connection, read_buffer, length, &amp;<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>,</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                 fin_rsv_opcode](<span class="keyword">const</span> boost::system::error_code &amp;ec, <span class="keywordtype">size_t</span> <span class="comment">/*bytes_transferred*/</span>) {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                  if (!ec) {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                    std::istream raw_message_data(read_buffer.get());</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                    <span class="comment">// Read mask</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                    std::vector&lt;unsigned char&gt; mask;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                    mask.resize(4);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                    raw_message_data.read((<span class="keywordtype">char</span> *)&amp;mask[0], 4);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                    std::shared_ptr&lt;Message&gt; message(<span class="keyword">new</span> Message());</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                    message-&gt;length = length;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                    message-&gt;fin_rsv_opcode = fin_rsv_opcode;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                    std::ostream message_data_out_stream(&amp;message-&gt;streambuf);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> c = 0; c &lt; length; c++) {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                                      message_data_out_stream.put(raw_message_data.get() ^ mask[c % 4]);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                    }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                    <span class="comment">// If connection close</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                    <span class="keywordflow">if</span> ((fin_rsv_opcode &amp; 0x0f) == 8) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                      <span class="keywordtype">int</span> status = 0;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                      <span class="keywordflow">if</span> (length &gt;= 2) {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> byte1 = message-&gt;get();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> byte2 = message-&gt;get();</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                        status = (byte1 &lt;&lt; 8) + byte2;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                      }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                                      <span class="keyword">auto</span> reason = message-&gt;string();</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                                      <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa345c6d91ca77b6a8ed919ba5a65f387">send_close</a>(connection, status, reason,</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                                                 [<span class="keyword">this</span>, connection](<span class="keyword">const</span> boost::system::error_code &amp; <span class="comment">/*ec*/</span>) {});</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                                      <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ae88d906b5680b56905e053c499f1e00a">connection_close</a>(connection, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, status, reason);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                      <span class="comment">// If ping</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                      <span class="keywordflow">if</span> ((fin_rsv_opcode &amp; 0x0f) == 9) {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                                        <span class="comment">// send pong</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                        <span class="keyword">auto</span> empty_send_stream = std::make_shared&lt;SendStream&gt;();</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8c9557d5442d9d957c4923f824cb4dfc">send</a>(connection, empty_send_stream, <span class="keyword">nullptr</span>, fin_rsv_opcode + 1);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.on_message) {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab93aeff2a658d0138bed8f37062cd35c">timer_idle_reset</a>(connection);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>.on_message(connection, message);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                      }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                      <span class="comment">// Next message</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                      <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab803fe550ac395f4c6903f76adab437b">read_message</a>(connection, read_buffer, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                    }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                    <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8d50d25bb410583480e3e4cea06fa182">connection_error</a>(connection, <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>, ec);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                });</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_aa345c6d91ca77b6a8ed919ba5a65f387"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa345c6d91ca77b6a8ed919ba5a65f387">dqm4hep::net::SocketServerBase::send_close</a></div><div class="ttdeci">void send_close(const std::shared_ptr&lt; Connection &gt; &amp;connection, int status, const std::string &amp;reason=&quot;&quot;, const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;callback=nullptr) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00636">WsServer.h:636</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ae88d906b5680b56905e053c499f1e00a"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ae88d906b5680b56905e053c499f1e00a">dqm4hep::net::SocketServerBase::connection_close</a></div><div class="ttdeci">void connection_close(const std::shared_ptr&lt; Connection &gt; &amp;connection, Endpoint &amp;endpoint, int status, const std::string &amp;reason) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00966">WsServer.h:966</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8dc85579f4c8875d8965174df8b09bbb"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">dqm4hep::net::SocketServerBase::endpoint</a></div><div class="ttdeci">std::map&lt; regex_orderable, Endpoint &gt; endpoint</div><div class="ttdoc">Warning: do not add or remove endpoints after start() is called. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00513">WsServer.h:513</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8d50d25bb410583480e3e4cea06fa182"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8d50d25bb410583480e3e4cea06fa182">dqm4hep::net::SocketServerBase::connection_error</a></div><div class="ttdeci">void connection_error(const std::shared_ptr&lt; Connection &gt; &amp;connection, Endpoint &amp;endpoint, const boost::system::error_code &amp;ec) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00979">WsServer.h:979</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ab93aeff2a658d0138bed8f37062cd35c"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab93aeff2a658d0138bed8f37062cd35c">dqm4hep::net::SocketServerBase::timer_idle_reset</a></div><div class="ttdeci">void timer_idle_reset(const std::shared_ptr&lt; Connection &gt; &amp;connection) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l01002">WsServer.h:1002</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ab803fe550ac395f4c6903f76adab437b"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab803fe550ac395f4c6903f76adab437b">dqm4hep::net::SocketServerBase::read_message</a></div><div class="ttdeci">void read_message(const std::shared_ptr&lt; Connection &gt; &amp;connection, const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;read_buffer, Endpoint &amp;endpoint) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00819">WsServer.h:819</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8c9557d5442d9d957c4923f824cb4dfc"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8c9557d5442d9d957c4923f824cb4dfc">dqm4hep::net::SocketServerBase::send</a></div><div class="ttdeci">void send(const std::shared_ptr&lt; Connection &gt; &amp;connection, const std::shared_ptr&lt; SendStream &gt; &amp;message_stream, const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;callback=nullptr, unsigned char fin_rsv_opcode=129) const </div><div class="ttdoc">fin_rsv_opcode: 129=one fragment, text, 130=one fragment, binary, 136=close connection. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00620">WsServer.h:620</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8c9557d5442d9d957c4923f824cb4dfc"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::send </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1SendStream.html">SendStream</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>message_stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;&#160;</td>
          <td class="paramname"><em>callback</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>fin_rsv_opcode</em> = <code>129</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>fin_rsv_opcode: 129=one fragment, text, 130=one fragment, binary, 136=close connection. </p>
<p>See <a href="http://tools.ietf.org/html/rfc6455#section-5.2">http://tools.ietf.org/html/rfc6455#section-5.2</a> for more information </p>

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00620">620</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00636">dqm4hep::net::SocketServerBase&lt; WS &gt;::send_close()</a>.</p>
<div class="fragment"><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                                                          {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">if</span> (fin_rsv_opcode != 136)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab93aeff2a658d0138bed8f37062cd35c">timer_idle_reset</a>(connection);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keyword">auto</span> header_stream = <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#abe21ad77ce8a2da231ef7c8b57db179c">prepareHeader</a>(message_stream, fin_rsv_opcode);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        connection-&gt;strand.post([<span class="keyword">this</span>, connection, header_stream, message_stream, callback]() {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          connection-&gt;send_queue.emplace_back(header_stream, message_stream, callback);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          <span class="keywordflow">if</span> (connection-&gt;send_queue.size() == 1)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            connection-&gt;send_from_queue(connection);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        });</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_abe21ad77ce8a2da231ef7c8b57db179c"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#abe21ad77ce8a2da231ef7c8b57db179c">dqm4hep::net::SocketServerBase::prepareHeader</a></div><div class="ttdeci">std::shared_ptr&lt; SendStream &gt; prepareHeader(const std::shared_ptr&lt; SendStream &gt; &amp;message_stream, unsigned char fin_rsv_opcode) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00573">WsServer.h:573</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ab93aeff2a658d0138bed8f37062cd35c"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab93aeff2a658d0138bed8f37062cd35c">dqm4hep::net::SocketServerBase::timer_idle_reset</a></div><div class="ttdeci">void timer_idle_reset(const std::shared_ptr&lt; Connection &gt; &amp;connection) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l01002">WsServer.h:1002</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa345c6d91ca77b6a8ed919ba5a65f387"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::send_close </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>reason</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;&#160;</td>
          <td class="paramname"><em>callback</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00636">636</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                                                                                        {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="comment">// Send close only once (in case close is initiated by server)</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordflow">if</span> (connection-&gt;closed)</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        connection-&gt;closed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keyword">auto</span> send_stream = std::make_shared&lt;SendStream&gt;();</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        send_stream-&gt;put(status &gt;&gt; 8);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        send_stream-&gt;put(status % 256);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        *send_stream &lt;&lt; reason;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="comment">// fin_rsv_opcode=136: message close</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8c9557d5442d9d957c4923f824cb4dfc">send</a>(connection, send_stream, callback, 136);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8c9557d5442d9d957c4923f824cb4dfc"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8c9557d5442d9d957c4923f824cb4dfc">dqm4hep::net::SocketServerBase::send</a></div><div class="ttdeci">void send(const std::shared_ptr&lt; Connection &gt; &amp;connection, const std::shared_ptr&lt; SendStream &gt; &amp;message_stream, const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;callback=nullptr, unsigned char fin_rsv_opcode=129) const </div><div class="ttdoc">fin_rsv_opcode: 129=one fragment, text, 130=one fragment, binary, 136=close connection. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00620">WsServer.h:620</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a16702a0101cc52df1dffad1d63ca05f4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00515">515</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                           {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;endp : <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          <span class="comment">// TODO: remove when onopen, onmessage, etc is removed:</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;          <span class="keywordflow">if</span> (endp.second.onopen)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            endp.second.on_open = endp.second.onopen;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          <span class="keywordflow">if</span> (endp.second.onmessage)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            endp.second.on_message = endp.second.onmessage;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;          <span class="keywordflow">if</span> (endp.second.onclose)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            endp.second.on_close = endp.second.onclose;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          <span class="keywordflow">if</span> (endp.second.onerror)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            endp.second.on_error = endp.second.onerror;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">io_service</a>)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">io_service</a> = std::make_shared&lt;boost::asio::io_service&gt;();</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">io_service</a>-&gt;stopped())</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">io_service</a>-&gt;reset();</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        boost::asio::ip::tcp::endpoint <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a6ba7920f0b330a2a0869a6a400ba1755">address</a>.size() &gt; 0)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;          endpoint = boost::asio::ip::tcp::endpoint(boost::asio::ip::address::from_string(<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a6ba7920f0b330a2a0869a6a400ba1755">address</a>), <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a181252e009cd01be1c3db421919bfeb2">port</a>);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;          endpoint = boost::asio::ip::tcp::endpoint(boost::asio::ip::tcp::v4(), <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a181252e009cd01be1c3db421919bfeb2">port</a>);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a91f4346e16c6c4b7e7fa30c8d8dac309">acceptor</a>)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a91f4346e16c6c4b7e7fa30c8d8dac309">acceptor</a> = std::unique_ptr&lt;boost::asio::ip::tcp::acceptor&gt;(<span class="keyword">new</span> boost::asio::ip::tcp::acceptor(*<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">io_service</a>));</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a91f4346e16c6c4b7e7fa30c8d8dac309">acceptor</a>-&gt;open(endpoint.protocol());</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a91f4346e16c6c4b7e7fa30c8d8dac309">acceptor</a>-&gt;set_option(boost::asio::socket_base::reuse_address(<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a9dbef13fac9d6fb4092e2fa2eece223c">reuse_address</a>));</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a91f4346e16c6c4b7e7fa30c8d8dac309">acceptor</a>-&gt;bind(endpoint);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a91f4346e16c6c4b7e7fa30c8d8dac309">acceptor</a>-&gt;listen();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa488ddcfbdd6e525e30603933ff7db46">accept</a>();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="comment">// If thread_pool_size&gt;1, start m_io_service.run() in (thread_pool_size-1) threads for thread-pooling</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a22180377e3d7391233273d45b0c09a63">threads</a>.clear();</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> c = 1; c &lt; <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a262eca5ffa6ba6914b17a3dec6d47106">thread_pool_size</a>; c++) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a22180377e3d7391233273d45b0c09a63">threads</a>.emplace_back([<span class="keyword">this</span>]() { <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">io_service</a>-&gt;run(); });</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="comment">// Main thread</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a262eca5ffa6ba6914b17a3dec6d47106">thread_pool_size</a> &gt; 0)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">io_service</a>-&gt;run();</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="comment">// Wait for the rest of the threads, if any, to finish as well</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;t : <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a22180377e3d7391233273d45b0c09a63">threads</a>) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;          t.join();</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config_html_a9dbef13fac9d6fb4092e2fa2eece223c"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a9dbef13fac9d6fb4092e2fa2eece223c">dqm4hep::net::SocketServerBase::Config::reuse_address</a></div><div class="ttdeci">bool reuse_address</div><div class="ttdoc">Set to false to avoid binding the socket to an address that is already in use. Defaults to true...</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00491">WsServer.h:491</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ad2a44585e5e5c778d75948651e798705"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">dqm4hep::net::SocketServerBase::config</a></div><div class="ttdeci">Config config</div><div class="ttdoc">Set before calling start(). </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00495">WsServer.h:495</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ab9dac38e21b01d2867f44c9c845c15e7"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">dqm4hep::net::SocketServerBase::io_service</a></div><div class="ttdeci">std::shared_ptr&lt; boost::asio::io_service &gt; io_service</div><div class="ttdoc">If you have your own boost::asio::io_service, store its pointer here before running start()...</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00688">WsServer.h:688</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a22180377e3d7391233273d45b0c09a63"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a22180377e3d7391233273d45b0c09a63">dqm4hep::net::SocketServerBase::threads</a></div><div class="ttdeci">std::vector&lt; std::thread &gt; threads</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00695">WsServer.h:695</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config_html_a181252e009cd01be1c3db421919bfeb2"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a181252e009cd01be1c3db421919bfeb2">dqm4hep::net::SocketServerBase::Config::port</a></div><div class="ttdeci">unsigned short port</div><div class="ttdoc">Port number to use. Defaults to 80 for HTTP and 443 for HTTPS. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00480">WsServer.h:480</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config_html_a262eca5ffa6ba6914b17a3dec6d47106"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a262eca5ffa6ba6914b17a3dec6d47106">dqm4hep::net::SocketServerBase::Config::thread_pool_size</a></div><div class="ttdeci">size_t thread_pool_size</div><div class="ttdoc">Number of threads that the server will use when start() is called. Defaults to 1 thread. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00482">WsServer.h:482</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8dc85579f4c8875d8965174df8b09bbb"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">dqm4hep::net::SocketServerBase::endpoint</a></div><div class="ttdeci">std::map&lt; regex_orderable, Endpoint &gt; endpoint</div><div class="ttdoc">Warning: do not add or remove endpoints after start() is called. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00513">WsServer.h:513</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_aa488ddcfbdd6e525e30603933ff7db46"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa488ddcfbdd6e525e30603933ff7db46">dqm4hep::net::SocketServerBase::accept</a></div><div class="ttdeci">virtual void accept()=0</div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a91f4346e16c6c4b7e7fa30c8d8dac309"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a91f4346e16c6c4b7e7fa30c8d8dac309">dqm4hep::net::SocketServerBase::acceptor</a></div><div class="ttdeci">std::unique_ptr&lt; boost::asio::ip::tcp::acceptor &gt; acceptor</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00693">WsServer.h:693</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config_html_a6ba7920f0b330a2a0869a6a400ba1755"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a6ba7920f0b330a2a0869a6a400ba1755">dqm4hep::net::SocketServerBase::Config::address</a></div><div class="ttdeci">std::string address</div><div class="ttdoc">IPv4 address in dotted decimal form or IPv6 address in hexadecimal notation. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00489">WsServer.h:489</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9c359458c531d453c9da57b313fcff4a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00564">564</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                  {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a91f4346e16c6c4b7e7fa30c8d8dac309">acceptor</a>-&gt;close();</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a262eca5ffa6ba6914b17a3dec6d47106">thread_pool_size</a> &gt; 0)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">io_service</a>-&gt;stop();</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;p : <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>)</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;          p.second.connections.clear();</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ad2a44585e5e5c778d75948651e798705"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">dqm4hep::net::SocketServerBase::config</a></div><div class="ttdeci">Config config</div><div class="ttdoc">Set before calling start(). </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00495">WsServer.h:495</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ab9dac38e21b01d2867f44c9c845c15e7"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab9dac38e21b01d2867f44c9c845c15e7">dqm4hep::net::SocketServerBase::io_service</a></div><div class="ttdeci">std::shared_ptr&lt; boost::asio::io_service &gt; io_service</div><div class="ttdoc">If you have your own boost::asio::io_service, store its pointer here before running start()...</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00688">WsServer.h:688</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config_html_a262eca5ffa6ba6914b17a3dec6d47106"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a262eca5ffa6ba6914b17a3dec6d47106">dqm4hep::net::SocketServerBase::Config::thread_pool_size</a></div><div class="ttdeci">size_t thread_pool_size</div><div class="ttdoc">Number of threads that the server will use when start() is called. Defaults to 1 thread. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00482">WsServer.h:482</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8dc85579f4c8875d8965174df8b09bbb"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">dqm4hep::net::SocketServerBase::endpoint</a></div><div class="ttdeci">std::map&lt; regex_orderable, Endpoint &gt; endpoint</div><div class="ttdoc">Warning: do not add or remove endpoints after start() is called. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00513">WsServer.h:513</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a91f4346e16c6c4b7e7fa30c8d8dac309"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a91f4346e16c6c4b7e7fa30c8d8dac309">dqm4hep::net::SocketServerBase::acceptor</a></div><div class="ttdeci">std::unique_ptr&lt; boost::asio::ip::tcp::acceptor &gt; acceptor</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00693">WsServer.h:693</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3c14ed034b6a93ed76d50f713320c83b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::timer_idle_cancel </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l01009">1009</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                                                                {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a773ddbf092a2e32f56f1e19b644672b2">timeout_idle</a> &gt; 0)</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          connection-&gt;timer_idle-&gt;cancel();</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ad2a44585e5e5c778d75948651e798705"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">dqm4hep::net::SocketServerBase::config</a></div><div class="ttdeci">Config config</div><div class="ttdoc">Set before calling start(). </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00495">WsServer.h:495</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config_html_a773ddbf092a2e32f56f1e19b644672b2"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a773ddbf092a2e32f56f1e19b644672b2">dqm4hep::net::SocketServerBase::Config::timeout_idle</a></div><div class="ttdeci">size_t timeout_idle</div><div class="ttdoc">Idle timeout. Defaults to no timeout. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00486">WsServer.h:486</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad347c3e9ee2ad4142c0bdbefffc8de6c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::timer_idle_expired_function </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l01014">1014</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                                                                                          {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        connection-&gt;timer_idle-&gt;async_wait([<span class="keyword">this</span>, connection](<span class="keyword">const</span> boost::system::error_code &amp;ec) {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          <span class="keywordflow">if</span> (!ec)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa345c6d91ca77b6a8ed919ba5a65f387">send_close</a>(connection, 1000, <span class="stringliteral">&quot;idle timeout&quot;</span>); <span class="comment">// 1000=normal closure</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        });</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_aa345c6d91ca77b6a8ed919ba5a65f387"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa345c6d91ca77b6a8ed919ba5a65f387">dqm4hep::net::SocketServerBase::send_close</a></div><div class="ttdeci">void send_close(const std::shared_ptr&lt; Connection &gt; &amp;connection, int status, const std::string &amp;reason=&quot;&quot;, const std::function&lt; void(const boost::system::error_code &amp;)&gt; &amp;callback=nullptr) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00636">WsServer.h:636</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa8a09dd1b531bc3d76f4ba4a55a01113"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::timer_idle_init </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00992">992</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                                                        {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a773ddbf092a2e32f56f1e19b644672b2">timeout_idle</a> &gt; 0) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;          connection-&gt;timer_idle = std::unique_ptr&lt;boost::asio::deadline_timer&gt;(</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;              <span class="keyword">new</span> boost::asio::deadline_timer(connection-&gt;socket-&gt;get_io_service()));</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;          connection-&gt;timer_idle-&gt;expires_from_now(</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;              boost::posix_time::seconds(static_cast&lt;unsigned long&gt;(<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a773ddbf092a2e32f56f1e19b644672b2">timeout_idle</a>)));</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad347c3e9ee2ad4142c0bdbefffc8de6c">timer_idle_expired_function</a>(connection);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ad2a44585e5e5c778d75948651e798705"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">dqm4hep::net::SocketServerBase::config</a></div><div class="ttdeci">Config config</div><div class="ttdoc">Set before calling start(). </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00495">WsServer.h:495</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config_html_a773ddbf092a2e32f56f1e19b644672b2"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a773ddbf092a2e32f56f1e19b644672b2">dqm4hep::net::SocketServerBase::Config::timeout_idle</a></div><div class="ttdeci">size_t timeout_idle</div><div class="ttdoc">Idle timeout. Defaults to no timeout. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00486">WsServer.h:486</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ad347c3e9ee2ad4142c0bdbefffc8de6c"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad347c3e9ee2ad4142c0bdbefffc8de6c">dqm4hep::net::SocketServerBase::timer_idle_expired_function</a></div><div class="ttdeci">void timer_idle_expired_function(const std::shared_ptr&lt; Connection &gt; &amp;connection) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l01014">WsServer.h:1014</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab93aeff2a658d0138bed8f37062cd35c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::timer_idle_reset </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l01002">1002</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00600">dqm4hep::net::SocketServerBase&lt; WS &gt;::forward()</a>, and <a class="el" href="WsServer_8h_source.html#l00620">dqm4hep::net::SocketServerBase&lt; WS &gt;::send()</a>.</p>
<div class="fragment"><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                                                                               {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a773ddbf092a2e32f56f1e19b644672b2">timeout_idle</a> &gt; 0 &amp;&amp;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            connection-&gt;timer_idle-&gt;expires_from_now(</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                boost::posix_time::seconds(static_cast&lt;unsigned long&gt;(<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">config</a>.<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a773ddbf092a2e32f56f1e19b644672b2">timeout_idle</a>))) &gt; 0)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;          <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad347c3e9ee2ad4142c0bdbefffc8de6c">timer_idle_expired_function</a>(connection);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ad2a44585e5e5c778d75948651e798705"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad2a44585e5e5c778d75948651e798705">dqm4hep::net::SocketServerBase::config</a></div><div class="ttdeci">Config config</div><div class="ttdoc">Set before calling start(). </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00495">WsServer.h:495</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config_html_a773ddbf092a2e32f56f1e19b644672b2"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html#a773ddbf092a2e32f56f1e19b644672b2">dqm4hep::net::SocketServerBase::Config::timeout_idle</a></div><div class="ttdeci">size_t timeout_idle</div><div class="ttdoc">Idle timeout. Defaults to no timeout. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00486">WsServer.h:486</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ad347c3e9ee2ad4142c0bdbefffc8de6c"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ad347c3e9ee2ad4142c0bdbefffc8de6c">dqm4hep::net::SocketServerBase::timer_idle_expired_function</a></div><div class="ttdeci">void timer_idle_expired_function(const std::shared_ptr&lt; Connection &gt; &amp;connection) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l01014">WsServer.h:1014</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3278baa010f69ff25265dddf4a96da18"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::upgrade </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Upgrades a request, from for instance Simple-Web-Server, to a WebSocket connection. </p>
<p>The parameters are moved to the <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> object. See also Server::on_upgrade in the Simple-Web-Server project. The socket's io_service is used, thus running <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a16702a0101cc52df1dffad1d63ca05f4">start()</a> is not needed.</p>
<p>Example use: server.on_upgrade=[&amp;socket_server] (auto socket, auto request) { auto connection=std::make_shared&lt;SimpleWeb::SocketServer&lt;SimpleWeb::WS&gt;::Connection&gt;(socket); connection-&gt;method=std::move(request-&gt;method); connection-&gt;path=std::move(request-&gt;path); connection-&gt;http_version=std::move(request-&gt;http_version); connection-&gt;header=std::move(request-&gt;header); connection-&gt;remote_endpoint_address=std::move(request-&gt;remote_endpoint_address); connection-&gt;remote_endpoint_port=request-&gt;remote_endpoint_port; socket_server.upgrade(connection); } </p>

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00681">681</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                                                {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keyword">auto</span> read_buffer = std::make_shared&lt;boost::asio::streambuf&gt;();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa07433c182af43ad9866cb141f008371">write_handshake</a>(connection, read_buffer);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_aa07433c182af43ad9866cb141f008371"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#aa07433c182af43ad9866cb141f008371">dqm4hep::net::SocketServerBase::write_handshake</a></div><div class="ttdeci">void write_handshake(const std::shared_ptr&lt; Connection &gt; &amp;connection, const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;read_buffer)</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00776">WsServer.h:776</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa07433c182af43ad9866cb141f008371"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::write_handshake </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Connection.html">Connection</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;&#160;</td>
          <td class="paramname"><em>read_buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00776">776</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00718">dqm4hep::net::SocketServerBase&lt; WS &gt;::read_handshake()</a>, and <a class="el" href="WsServer_8h_source.html#l00681">dqm4hep::net::SocketServerBase&lt; WS &gt;::upgrade()</a>.</p>
<div class="fragment"><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                                                                 {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="comment">// Find path- and method-match, and generate response</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;regex_endpoint : <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">endpoint</a>) {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;          REGEX_NS::smatch path_match;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;          <span class="keywordflow">if</span> (REGEX_NS::regex_match(connection-&gt;path, path_match, regex_endpoint.first)) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="keyword">auto</span> write_buffer = std::make_shared&lt;boost::asio::streambuf&gt;();</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            std::ostream handshake(write_buffer.get());</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a745537fddf9541eea42e0eeda1d74ac0">generate_handshake</a>(connection, handshake)) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;              connection-&gt;path_match = std::move(path_match);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;              <span class="comment">// Capture write_buffer in lambda so it is not destroyed before async_write is finished</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;              boost::asio::async_write(*connection-&gt;socket, *write_buffer,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                       [<span class="keyword">this</span>, connection, write_buffer, read_buffer, &amp;regex_endpoint](</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                           <span class="keyword">const</span> boost::system::error_code &amp;ec, <span class="keywordtype">size_t</span> <span class="comment">/*bytes_transferred*/</span>) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                         if (!ec) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                           <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#adfb0f346aee5f6c72a1306870f885c6f">connection_open</a>(connection, regex_endpoint.second);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                           <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab803fe550ac395f4c6903f76adab437b">read_message</a>(connection, read_buffer, regex_endpoint.second);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                         } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                           <a class="code" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8d50d25bb410583480e3e4cea06fa182">connection_error</a>(connection, regex_endpoint.second, ec);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                                       });</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_adfb0f346aee5f6c72a1306870f885c6f"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#adfb0f346aee5f6c72a1306870f885c6f">dqm4hep::net::SocketServerBase::connection_open</a></div><div class="ttdeci">void connection_open(const std::shared_ptr&lt; Connection &gt; &amp;connection, Endpoint &amp;endpoint)</div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00954">WsServer.h:954</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a745537fddf9541eea42e0eeda1d74ac0"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a745537fddf9541eea42e0eeda1d74ac0">dqm4hep::net::SocketServerBase::generate_handshake</a></div><div class="ttdeci">bool generate_handshake(const std::shared_ptr&lt; Connection &gt; &amp;connection, std::ostream &amp;handshake) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00803">WsServer.h:803</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8dc85579f4c8875d8965174df8b09bbb"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8dc85579f4c8875d8965174df8b09bbb">dqm4hep::net::SocketServerBase::endpoint</a></div><div class="ttdeci">std::map&lt; regex_orderable, Endpoint &gt; endpoint</div><div class="ttdoc">Warning: do not add or remove endpoints after start() is called. </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00513">WsServer.h:513</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_a8d50d25bb410583480e3e4cea06fa182"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#a8d50d25bb410583480e3e4cea06fa182">dqm4hep::net::SocketServerBase::connection_error</a></div><div class="ttdeci">void connection_error(const std::shared_ptr&lt; Connection &gt; &amp;connection, Endpoint &amp;endpoint, const boost::system::error_code &amp;ec) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00979">WsServer.h:979</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1SocketServerBase_html_ab803fe550ac395f4c6903f76adab437b"><div class="ttname"><a href="classdqm4hep_1_1net_1_1SocketServerBase.html#ab803fe550ac395f4c6903f76adab437b">dqm4hep::net::SocketServerBase::read_message</a></div><div class="ttdeci">void read_message(const std::shared_ptr&lt; Connection &gt; &amp;connection, const std::shared_ptr&lt; boost::asio::streambuf &gt; &amp;read_buffer, Endpoint &amp;endpoint) const </div><div class="ttdef"><b>Definition:</b> <a href="WsServer_8h_source.html#l00819">WsServer.h:819</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a91f4346e16c6c4b7e7fa30c8d8dac309"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;boost::asio::ip::tcp::acceptor&gt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::acceptor</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00693">693</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00515">dqm4hep::net::SocketServerBase&lt; WS &gt;::start()</a>, and <a class="el" href="WsServer_8h_source.html#l00564">dqm4hep::net::SocketServerBase&lt; WS &gt;::stop()</a>.</p>

</div>
</div>
<a class="anchor" id="ad2a44585e5e5c778d75948651e798705"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Config.html">Config</a> <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::config</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set before calling <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a16702a0101cc52df1dffad1d63ca05f4">start()</a>. </p>

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00495">495</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00718">dqm4hep::net::SocketServerBase&lt; WS &gt;::read_handshake()</a>, <a class="el" href="WsServer_8h_source.html#l00515">dqm4hep::net::SocketServerBase&lt; WS &gt;::start()</a>, and <a class="el" href="WsServer_8h_source.html#l00564">dqm4hep::net::SocketServerBase&lt; WS &gt;::stop()</a>.</p>

</div>
</div>
<a class="anchor" id="a8dc85579f4c8875d8965174df8b09bbb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1regex__orderable.html">regex_orderable</a>, <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase_1_1Endpoint.html">Endpoint</a>&gt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::endpoint</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Warning: do not add or remove endpoints after <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a16702a0101cc52df1dffad1d63ca05f4">start()</a> is called. </p>

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00513">513</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00654">dqm4hep::net::SocketServerBase&lt; WS &gt;::get_connections()</a>, <a class="el" href="WsServer_8h_source.html#l00515">dqm4hep::net::SocketServerBase&lt; WS &gt;::start()</a>, and <a class="el" href="WsServer_8h_source.html#l00564">dqm4hep::net::SocketServerBase&lt; WS &gt;::stop()</a>.</p>

</div>
</div>
<a class="anchor" id="ab9dac38e21b01d2867f44c9c845c15e7"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;boost::asio::io_service&gt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::io_service</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If you have your own boost::asio::io_service, store its pointer here before running <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html#a16702a0101cc52df1dffad1d63ca05f4">start()</a>. </p>
<p>You might also want to set config.thread_pool_size to 0. </p>

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00688">688</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00515">dqm4hep::net::SocketServerBase&lt; WS &gt;::start()</a>, and <a class="el" href="WsServer_8h_source.html#l00564">dqm4hep::net::SocketServerBase&lt; WS &gt;::stop()</a>.</p>

</div>
</div>
<a class="anchor" id="a22180377e3d7391233273d45b0c09a63"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::thread&gt; <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::threads</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00695">695</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

<p>Referenced by <a class="el" href="WsServer_8h_source.html#l00515">dqm4hep::net::SocketServerBase&lt; WS &gt;::start()</a>.</p>

</div>
</div>
<a class="anchor" id="a9da983d3f5b891243b1069c153300602"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class socket_type&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string <a class="el" href="classdqm4hep_1_1net_1_1SocketServerBase.html">dqm4hep::net::SocketServerBase</a>&lt; socket_type &gt;::ws_magic_string = &quot;258EAFA5-E914-47DA-95CA-C5AB0DC85B11&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="WsServer_8h_source.html#l00691">691</a> of file <a class="el" href="WsServer_8h_source.html">WsServer.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="WsServer_8h_source.html">WsServer.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 31 2018 11:34:36 for DQMNet by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>

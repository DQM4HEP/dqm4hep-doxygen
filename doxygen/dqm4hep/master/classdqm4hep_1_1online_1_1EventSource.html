<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DQM4hep: dqm4hep::online::EventSource Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DQM4hep
   &#160;<span id="projectnumber">1.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacedqm4hep.html">dqm4hep</a></li><li class="navelem"><a class="el" href="namespacedqm4hep_1_1online.html">online</a></li><li class="navelem"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html">EventSource</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classdqm4hep_1_1online_1_1EventSource-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">dqm4hep::online::EventSource Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html" title="EventSource class. ">EventSource</a> class.  
 <a href="classdqm4hep_1_1online_1_1EventSource.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="EventSource_8h_source.html">EventSource.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdqm4hep_1_1online_1_1EventSource_1_1CollectorInfo.html">CollectorInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structdqm4hep_1_1online_1_1EventSource_1_1CollectorInfo.html" title="CollectorInfo struct. ">CollectorInfo</a> struct.  <a href="structdqm4hep_1_1online_1_1EventSource_1_1CollectorInfo.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad647155972b0eb3f7d94fda0d33df177"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#ad647155972b0eb3f7d94fda0d33df177">~EventSource</a> ()</td></tr>
<tr class="memdesc:ad647155972b0eb3f7d94fda0d33df177"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#ad647155972b0eb3f7d94fda0d33df177">More...</a><br/></td></tr>
<tr class="separator:ad647155972b0eb3f7d94fda0d33df177"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c7a4052807e6d719e41dbf37331cebb"><td class="memItemLeft" align="right" valign="top">const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a0c7a4052807e6d719e41dbf37331cebb">sourceName</a> () const </td></tr>
<tr class="memdesc:a0c7a4052807e6d719e41dbf37331cebb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the source name.  <a href="#a0c7a4052807e6d719e41dbf37331cebb">More...</a><br/></td></tr>
<tr class="separator:a0c7a4052807e6d719e41dbf37331cebb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ad7a32fea642021dff3aa87788979c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a67ad7a32fea642021dff3aa87788979c">addCollector</a> (const std::string &amp;name)</td></tr>
<tr class="memdesc:a67ad7a32fea642021dff3aa87788979c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new collector server to which events will be sent.  <a href="#a67ad7a32fea642021dff3aa87788979c">More...</a><br/></td></tr>
<tr class="separator:a67ad7a32fea642021dff3aa87788979c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25ff0612616b74305d8819d721df1a58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a25ff0612616b74305d8819d721df1a58">start</a> ()</td></tr>
<tr class="memdesc:a25ff0612616b74305d8819d721df1a58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the event source.  <a href="#a25ff0612616b74305d8819d721df1a58">More...</a><br/></td></tr>
<tr class="separator:a25ff0612616b74305d8819d721df1a58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31a26daf8e643b818fd86a75abce04e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a31a26daf8e643b818fd86a75abce04e0">sendEvent</a> (<a class="el" href="namespacedqm4hep_1_1core.html#ab9609d26a565705b8805e0354461c2e8">core::EventPtr</a> event)</td></tr>
<tr class="memdesc:a31a26daf8e643b818fd86a75abce04e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a single event to all registered collectors.  <a href="#a31a26daf8e643b818fd86a75abce04e0">More...</a><br/></td></tr>
<tr class="separator:a31a26daf8e643b818fd86a75abce04e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a884a64f3746ff91c6c18640bd492f7cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a884a64f3746ff91c6c18640bd492f7cd">sendEvent</a> (const std::string &amp;collector, <a class="el" href="namespacedqm4hep_1_1core.html#ab9609d26a565705b8805e0354461c2e8">core::EventPtr</a> event)</td></tr>
<tr class="memdesc:a884a64f3746ff91c6c18640bd492f7cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a single event to a single collector.  <a href="#a884a64f3746ff91c6c18640bd492f7cd">More...</a><br/></td></tr>
<tr class="separator:a884a64f3746ff91c6c18640bd492f7cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a25d04e35b85cd033310cd1e407e27427"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacedqm4hep_1_1online.html#aa39d9cd1ccd9f19b5502de15957a34da">EventSourcePtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a25d04e35b85cd033310cd1e407e27427">make_shared</a> (const std::string &amp;name)</td></tr>
<tr class="memdesc:a25d04e35b85cd033310cd1e407e27427"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factory method to create a shared pointer of event source.  <a href="#a25d04e35b85cd033310cd1e407e27427">More...</a><br/></td></tr>
<tr class="separator:a25d04e35b85cd033310cd1e407e27427"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a24dd92e30ac741f8aeb2466f1d86aad8"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; std::string, <br class="typebreak"/>
<a class="el" href="structdqm4hep_1_1online_1_1EventSource_1_1CollectorInfo.html">CollectorInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a24dd92e30ac741f8aeb2466f1d86aad8">CollectorInfoMap</a></td></tr>
<tr class="separator:a24dd92e30ac741f8aeb2466f1d86aad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa72aa0d322337e7e9cdccea5992fe560"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#aa72aa0d322337e7e9cdccea5992fe560">getSourceInfo</a> (<a class="el" href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">core::json</a> &amp;info)</td></tr>
<tr class="memdesc:aa72aa0d322337e7e9cdccea5992fe560"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the source info (host info + source info)  <a href="#aa72aa0d322337e7e9cdccea5992fe560">More...</a><br/></td></tr>
<tr class="separator:aa72aa0d322337e7e9cdccea5992fe560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7c992768da87cfd3557b4544a3bdd76"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#ae7c992768da87cfd3557b4544a3bdd76">registerMe</a> (const std::string &amp;collector, const <a class="el" href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">core::json</a> &amp;info)</td></tr>
<tr class="memdesc:ae7c992768da87cfd3557b4544a3bdd76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register the event source to the specified collector.  <a href="#ae7c992768da87cfd3557b4544a3bdd76">More...</a><br/></td></tr>
<tr class="separator:ae7c992768da87cfd3557b4544a3bdd76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2afa8b71476aadbd125e68f0fc3aa7fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a2afa8b71476aadbd125e68f0fc3aa7fa">unregisterMe</a> (const std::string &amp;collector)</td></tr>
<tr class="memdesc:a2afa8b71476aadbd125e68f0fc3aa7fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Un-register the event source from the specified collector.  <a href="#a2afa8b71476aadbd125e68f0fc3aa7fa">More...</a><br/></td></tr>
<tr class="separator:a2afa8b71476aadbd125e68f0fc3aa7fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92f20640713c43b91f1de326b65244c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a92f20640713c43b91f1de326b65244c4">sendEvent</a> (const <a class="el" href="namespacedqm4hep_1_1core.html#a1ad5f93cca8ca24236779b1a0798fb63">core::StringVector</a> &amp;collectors, <a class="el" href="namespacedqm4hep_1_1core.html#ab9609d26a565705b8805e0354461c2e8">core::EventPtr</a> event)</td></tr>
<tr class="memdesc:a92f20640713c43b91f1de326b65244c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the actual event sending to the specified list of collectors.  <a href="#a92f20640713c43b91f1de326b65244c4">More...</a><br/></td></tr>
<tr class="separator:a92f20640713c43b91f1de326b65244c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63c228ca9cf0b22d09216e98be3b5400"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a63c228ca9cf0b22d09216e98be3b5400">EventSource</a> (const std::string &amp;<a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a0c7a4052807e6d719e41dbf37331cebb">sourceName</a>)</td></tr>
<tr class="memdesc:a63c228ca9cf0b22d09216e98be3b5400"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a63c228ca9cf0b22d09216e98be3b5400">More...</a><br/></td></tr>
<tr class="separator:a63c228ca9cf0b22d09216e98be3b5400"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ab4761b3a8abaa6219553bb7078d0fe78"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#ab4761b3a8abaa6219553bb7078d0fe78">m_started</a> = {false}</td></tr>
<tr class="memdesc:ab4761b3a8abaa6219553bb7078d0fe78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether the event source was started.  <a href="#ab4761b3a8abaa6219553bb7078d0fe78">More...</a><br/></td></tr>
<tr class="separator:ab4761b3a8abaa6219553bb7078d0fe78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3a7d1e7404b31e1d63fac960632b62e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">m_sourceName</a> = {&quot;&quot;}</td></tr>
<tr class="memdesc:ae3a7d1e7404b31e1d63fac960632b62e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The source name.  <a href="#ae3a7d1e7404b31e1d63fac960632b62e">More...</a><br/></td></tr>
<tr class="separator:ae3a7d1e7404b31e1d63fac960632b62e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96da5151d6d5f9423ee8732994598cba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdqm4hep_1_1core_1_1EventStreamer.html">core::EventStreamer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a96da5151d6d5f9423ee8732994598cba">m_eventStreamer</a> = {}</td></tr>
<tr class="memdesc:a96da5151d6d5f9423ee8732994598cba"><td class="mdescLeft">&#160;</td><td class="mdescRight">The event streamer.  <a href="#a96da5151d6d5f9423ee8732994598cba">More...</a><br/></td></tr>
<tr class="separator:a96da5151d6d5f9423ee8732994598cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab677c42a2ba64a89b25b54a1c5f95306"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a24dd92e30ac741f8aeb2466f1d86aad8">CollectorInfoMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a> = {}</td></tr>
<tr class="memdesc:ab677c42a2ba64a89b25b54a1c5f95306"><td class="mdescLeft">&#160;</td><td class="mdescRight">The map of event collector infos.  <a href="#ab677c42a2ba64a89b25b54a1c5f95306">More...</a><br/></td></tr>
<tr class="separator:ab677c42a2ba64a89b25b54a1c5f95306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35e526f1e321736f786fb3be287017b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdqm4hep_1_1net_1_1Client.html">net::Client</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a35e526f1e321736f786fb3be287017b4">m_client</a> = {}</td></tr>
<tr class="memdesc:a35e526f1e321736f786fb3be287017b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The networking client interface.  <a href="#a35e526f1e321736f786fb3be287017b4">More...</a><br/></td></tr>
<tr class="separator:a35e526f1e321736f786fb3be287017b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a217b3057ae0182f87346d76bd21773b0"><td class="memItemLeft" align="right" valign="top">TBufferFile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a217b3057ae0182f87346d76bd21773b0">m_buffer</a> = {TBuffer::kWrite, 2*1024*1024}</td></tr>
<tr class="memdesc:a217b3057ae0182f87346d76bd21773b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The serialized event raw buffer.  <a href="#a217b3057ae0182f87346d76bd21773b0">More...</a><br/></td></tr>
<tr class="separator:a217b3057ae0182f87346d76bd21773b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html" title="EventSource class. ">EventSource</a> class. </p>
<p>Main interface for sending events to collectors (server process). Only one event source is allowed per process as the source is registered using the network client id on the collector server side. It is possible to send events to multiple event collectors. A typical usage could be: </p>
<div class="fragment"><div class="line"><a class="code" href="namespacedqm4hep_1_1online.html#aa39d9cd1ccd9f19b5502de15957a34da">EventSourcePtr</a> source = <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a25d04e35b85cd033310cd1e407e27427">EventSource::make_shared</a>(<span class="stringliteral">&quot;EventBuilder&quot;</span>);</div>
<div class="line">source-&gt;addCollector(<span class="stringliteral">&quot;CentralCollector&quot;</span>);</div>
<div class="line">source-&gt;addCollector(<span class="stringliteral">&quot;PrivateCollector&quot;</span>);</div>
<div class="line">source-&gt;start();</div>
<div class="line"><span class="comment">// ...</span></div>
<div class="line"><a class="code" href="namespacedqm4hep_1_1core.html#ab9609d26a565705b8805e0354461c2e8">core::EventPtr</a> <span class="keyword">event</span> = getLastEvent(); <span class="comment">// hypothetical getter function  </span></div>
<div class="line">source-&gt;sendEvent(event); <span class="comment">// send to all collectors</span></div>
</div><!-- fragment --> 
<p>Definition at line <a class="el" href="EventSource_8h_source.html#l00048">48</a> of file <a class="el" href="EventSource_8h_source.html">EventSource.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a24dd92e30ac741f8aeb2466f1d86aad8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;std::string, <a class="el" href="structdqm4hep_1_1online_1_1EventSource_1_1CollectorInfo.html">CollectorInfo</a>&gt; <a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a24dd92e30ac741f8aeb2466f1d86aad8">dqm4hep::online::EventSource::CollectorInfoMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="EventSource_8h_source.html#l00146">146</a> of file <a class="el" href="EventSource_8h_source.html">EventSource.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ad647155972b0eb3f7d94fda0d33df177"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dqm4hep::online::EventSource::~EventSource </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00034">34</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="EventSource_8h_source.html#l00151">m_collectorInfos</a>, and <a class="el" href="EventSource_8cc_source.html#l00225">unregisterMe()</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                              {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keywordflow">for</span>(<span class="keyword">auto</span> colIter : <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        this-&gt;<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a2afa8b71476aadbd125e68f0fc3aa7fa">unregisterMe</a>(colIter.first);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ab677c42a2ba64a89b25b54a1c5f95306"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">dqm4hep::online::EventSource::m_collectorInfos</a></div><div class="ttdeci">CollectorInfoMap m_collectorInfos</div><div class="ttdoc">The map of event collector infos. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00151">EventSource.h:151</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_a2afa8b71476aadbd125e68f0fc3aa7fa"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#a2afa8b71476aadbd125e68f0fc3aa7fa">dqm4hep::online::EventSource::unregisterMe</a></div><div class="ttdeci">void unregisterMe(const std::string &amp;collector)</div><div class="ttdoc">Un-register the event source from the specified collector. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8cc_source.html#l00225">EventSource.cc:225</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a63c228ca9cf0b22d09216e98be3b5400"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dqm4hep::online::EventSource::EventSource </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>sourceName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sourceName</td><td>the source name </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00028">28</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00022">make_shared()</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                                  :</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">m_sourceName</a>(name) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ae3a7d1e7404b31e1d63fac960632b62e"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">dqm4hep::online::EventSource::m_sourceName</a></div><div class="ttdeci">std::string m_sourceName</div><div class="ttdoc">The source name. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00149">EventSource.h:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a67ad7a32fea642021dff3aa87788979c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::EventSource::addCollector </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new collector server to which events will be sent. </p>
<p>Can be used only before calling <a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a25ff0612616b74305d8819d721df1a58" title="Start the event source. ">start()</a>. Must be called at least one time before calling <a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a25ff0612616b74305d8819d721df1a58" title="Start the event source. ">start()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>the event collector name </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00048">48</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="EventSource_8h_source.html#l00151">m_collectorInfos</a>, <a class="el" href="EventSource_8h_source.html#l00142">dqm4hep::online::EventSource::CollectorInfo::m_registered</a>, and <a class="el" href="EventSource_8h_source.html#l00148">m_started</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                                        {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab4761b3a8abaa6219553bb7078d0fe78">m_started</a>) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">throw</span> core::StatusCodeException(core::STATUS_CODE_NOT_ALLOWED);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keyword">auto</span> findIter = <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>.find(name);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>.end() != findIter) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">throw</span> core::StatusCodeException(core::STATUS_CODE_ALREADY_PRESENT);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      CollectorInfo info;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      info.m_registered = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>.insert(CollectorInfoMap::value_type(name, info));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ab4761b3a8abaa6219553bb7078d0fe78"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ab4761b3a8abaa6219553bb7078d0fe78">dqm4hep::online::EventSource::m_started</a></div><div class="ttdeci">bool m_started</div><div class="ttdoc">Whether the event source was started. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00148">EventSource.h:148</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ab677c42a2ba64a89b25b54a1c5f95306"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">dqm4hep::online::EventSource::m_collectorInfos</a></div><div class="ttdeci">CollectorInfoMap m_collectorInfos</div><div class="ttdoc">The map of event collector infos. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00151">EventSource.h:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa72aa0d322337e7e9cdccea5992fe560"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::EventSource::getSourceInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">core::json</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the source info (host info + source info) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">info</td><td>the json value to receive </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00167">167</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="Internal_8h_source.html#l00449">dqm4hep::core::fillHostInfo()</a>, <a class="el" href="EventSource_8h_source.html#l00151">m_collectorInfos</a>, and <a class="el" href="EventSource_8h_source.html#l00149">m_sourceName</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00111">sendEvent()</a>, and <a class="el" href="EventSource_8cc_source.html#l00066">start()</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                                  {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">// host info</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="namespacedqm4hep_1_1core.html#adc020c7501c1db5825e0b12ff30f118c">core::StringMap</a> hostInfo;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="namespacedqm4hep_1_1core.html#a2c057cc6c31326dcc11094a917191836">core::fillHostInfo</a>(hostInfo);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                  </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="comment">// collectors</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <a class="code" href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">core::json</a> collectorsValue;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">for</span>(<span class="keyword">auto</span> colIter : <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        collectorsValue.push_back(colIter.first);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      info = {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        {<span class="stringliteral">&quot;source&quot;</span>, <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">m_sourceName</a>},</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        {<span class="stringliteral">&quot;host&quot;</span>, hostInfo},</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        {<span class="stringliteral">&quot;collectors&quot;</span>, collectorsValue}</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      };</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ab677c42a2ba64a89b25b54a1c5f95306"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">dqm4hep::online::EventSource::m_collectorInfos</a></div><div class="ttdeci">CollectorInfoMap m_collectorInfos</div><div class="ttdoc">The map of event collector infos. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00151">EventSource.h:151</a></div></div>
<div class="ttc" id="namespacedqm4hep_1_1core_html_a2c057cc6c31326dcc11094a917191836"><div class="ttname"><a href="namespacedqm4hep_1_1core.html#a2c057cc6c31326dcc11094a917191836">dqm4hep::core::fillHostInfo</a></div><div class="ttdeci">void fillHostInfo(StringMap &amp;info)</div><div class="ttdoc">Fill host info (uname result + host name). </div><div class="ttdef"><b>Definition:</b> <a href="Internal_8h_source.html#l00449">Internal.h:449</a></div></div>
<div class="ttc" id="namespacedqm4hep_1_1core_html_adc020c7501c1db5825e0b12ff30f118c"><div class="ttname"><a href="namespacedqm4hep_1_1core.html#adc020c7501c1db5825e0b12ff30f118c">dqm4hep::core::StringMap</a></div><div class="ttdeci">std::map&lt; std::string, std::string &gt; StringMap</div><div class="ttdef"><b>Definition:</b> <a href="Internal_8h_source.html#l00268">Internal.h:268</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ae3a7d1e7404b31e1d63fac960632b62e"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">dqm4hep::online::EventSource::m_sourceName</a></div><div class="ttdeci">std::string m_sourceName</div><div class="ttdoc">The source name. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00149">EventSource.h:149</a></div></div>
<div class="ttc" id="namespacedqm4hep_1_1core_html_adbf7ece0bddde655770fc3623b8e9445"><div class="ttname"><a href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">dqm4hep::core::json</a></div><div class="ttdeci">nlohmann::json json</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l00020">json.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a25d04e35b85cd033310cd1e407e27427"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacedqm4hep_1_1online.html#aa39d9cd1ccd9f19b5502de15957a34da">EventSourcePtr</a> dqm4hep::online::EventSource::make_shared </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Factory method to create a shared pointer of event source. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>the source name </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00022">22</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="EventSource_8cc_source.html#l00028">EventSource()</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                                                                       {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      <span class="keywordflow">return</span> std::shared_ptr&lt;EventSource&gt;(<span class="keyword">new</span> <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a63c228ca9cf0b22d09216e98be3b5400">EventSource</a>(<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a0c7a4052807e6d719e41dbf37331cebb">sourceName</a>));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_a63c228ca9cf0b22d09216e98be3b5400"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#a63c228ca9cf0b22d09216e98be3b5400">dqm4hep::online::EventSource::EventSource</a></div><div class="ttdeci">EventSource(const std::string &amp;sourceName)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8cc_source.html#l00028">EventSource.cc:28</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_a0c7a4052807e6d719e41dbf37331cebb"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#a0c7a4052807e6d719e41dbf37331cebb">dqm4hep::online::EventSource::sourceName</a></div><div class="ttdeci">const std::string &amp; sourceName() const </div><div class="ttdoc">Get the source name. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8cc_source.html#l00042">EventSource.cc:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae7c992768da87cfd3557b4544a3bdd76"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool dqm4hep::online::EventSource::registerMe </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>collector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">core::json</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Register the event source to the specified collector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">collector</td><td>the collector name to register to </td></tr>
    <tr><td class="paramname">info</td><td>the source info to send to the collector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool whether the source was registered </dd></dl>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00186">186</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="OnlineRoutes_8cc_source.html#l00049">dqm4hep::online::OnlineRoutes::EventCollector::applicationType()</a>, <a class="el" href="NetBuffer_8cc_source.html#l00095">dqm4hep::net::Buffer::begin()</a>, <a class="el" href="NetBuffer_8h_source.html#l00274">dqm4hep::net::Buffer::createModel()</a>, <a class="el" href="Logging_8h_source.html#l00026">dqm_debug</a>, <a class="el" href="Logging_8h_source.html#l00030">dqm_info</a>, <a class="el" href="Logging_8h_source.html#l00027">dqm_warning</a>, <a class="el" href="NetBuffer_8cc_source.html#l00101">dqm4hep::net::Buffer::end()</a>, <a class="el" href="EventSource_8h_source.html#l00152">m_client</a>, <a class="el" href="Client_8cc_source.html#l00054">dqm4hep::net::Client::notifyServerOnExit()</a>, <a class="el" href="OnlineRoutes_8cc_source.html#l00055">dqm4hep::online::OnlineRoutes::EventCollector::registerSource()</a>, <a class="el" href="Client_8h_source.html#l00148">dqm4hep::net::Client::sendRequest()</a>, <a class="el" href="OnlineRoutes_8cc_source.html#l00036">dqm4hep::online::OnlineRoutes::Application::serverName()</a>, <a class="el" href="NetBuffer_8cc_source.html#l00087">dqm4hep::net::Buffer::setModel()</a>, and <a class="el" href="NetBuffer_8cc_source.html#l00107">dqm4hep::net::Buffer::size()</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00111">sendEvent()</a>, and <a class="el" href="EventSource_8cc_source.html#l00066">start()</a>.</p>
<div class="fragment"><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                                                                 {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      std::string requestName = <a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector.html#a24117da5f444f17367ed34f7bf0f5dda">OnlineRoutes::EventCollector::registerSource</a>(collector);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordtype">bool</span> returnValue(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      net::Buffer requestBuffer;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keyword">auto</span> model = requestBuffer.createModel&lt;std::string&gt;();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      requestBuffer.setModel(model);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      std::string jsonDump(info.dump());</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      model-&gt;move(std::move(jsonDump));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <a class="code" href="Logging_8h.html#afeed011feb4159b13c3ae4873e1d0fcf">dqm_debug</a>( <span class="stringliteral">&quot;Sending request to collector {0} for registration, request: {1}&quot;</span>, collector , requestName);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a35e526f1e321736f786fb3be287017b4">m_client</a>.<a class="code" href="classdqm4hep_1_1net_1_1Client.html#a292bc066bcdb40e7578396f4362d5fed">sendRequest</a>(requestName, requestBuffer, [&amp;returnValue,&amp;collector](<span class="keyword">const</span> net::Buffer &amp;buffer){</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">core::json</a> response({});</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span>(0 != buffer.size()) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          response = core::json::parse(buffer.begin(), buffer.end());</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> registered(response.value&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;registered&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">if</span>(not registered) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          <span class="keyword">const</span> std::string message(response.value&lt;std::string&gt;(<span class="stringliteral">&quot;message&quot;</span>, <span class="stringliteral">&quot;The event collector is maybe not available or is down !&quot;</span>));</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          <a class="code" href="Logging_8h.html#a0bfc26706a9022c017dd03af3c7c91d7">dqm_warning</a>( <span class="stringliteral">&quot;EventSource::registerMe(): Couldn&#39;t register source to collector &#39;{0}&#39;: {1}&quot;</span>, collector, message );</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          returnValue = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <a class="code" href="Logging_8h.html#af06e81e068fdce66fa6920f65a774d13">dqm_info</a>( <span class="stringliteral">&quot;Event source registered to event collector &#39;{0}&#39; !&quot;</span>, collector );</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          returnValue = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      });</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">if</span>(returnValue) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <a class="code" href="Logging_8h.html#af06e81e068fdce66fa6920f65a774d13">dqm_info</a>( <span class="stringliteral">&quot;Will notify server on exit&quot;</span> );</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keyword">const</span> std::string serverName(<a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1Application.html#a218ca8c4cb4764f78ae04984049c023d">OnlineRoutes::Application::serverName</a>(<a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector.html#a712d6e1490b64f0127ed606350c3a623">OnlineRoutes::EventCollector::applicationType</a>(), collector));</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a35e526f1e321736f786fb3be287017b4">m_client</a>.<a class="code" href="classdqm4hep_1_1net_1_1Client.html#a546e7c38fbbc34d0d04b4fa5b2984086">notifyServerOnExit</a>(serverName);        </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      }      </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">return</span> returnValue;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector_html_a712d6e1490b64f0127ed606350c3a623"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector.html#a712d6e1490b64f0127ed606350c3a623">dqm4hep::online::OnlineRoutes::EventCollector::applicationType</a></div><div class="ttdeci">static std::string applicationType()</div><div class="ttdoc">Get the event collector application type. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00049">OnlineRoutes.cc:49</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1Client_html_a292bc066bcdb40e7578396f4362d5fed"><div class="ttname"><a href="classdqm4hep_1_1net_1_1Client.html#a292bc066bcdb40e7578396f4362d5fed">dqm4hep::net::Client::sendRequest</a></div><div class="ttdeci">void sendRequest(const std::string &amp;name, const Request &amp;request) const </div><div class="ttdoc">Send a command. </div><div class="ttdef"><b>Definition:</b> <a href="Client_8h_source.html#l00148">Client.h:148</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector_html_a24117da5f444f17367ed34f7bf0f5dda"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector.html#a24117da5f444f17367ed34f7bf0f5dda">dqm4hep::online::OnlineRoutes::EventCollector::registerSource</a></div><div class="ttdeci">static std::string registerSource(const std::string &amp;collector)</div><div class="ttdoc">Get the event collector request name to register a new event source. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00055">OnlineRoutes.cc:55</a></div></div>
<div class="ttc" id="Logging_8h_html_af06e81e068fdce66fa6920f65a774d13"><div class="ttname"><a href="Logging_8h.html#af06e81e068fdce66fa6920f65a774d13">dqm_info</a></div><div class="ttdeci">#define dqm_info(...)</div><div class="ttdef"><b>Definition:</b> <a href="Logging_8h_source.html#l00030">Logging.h:30</a></div></div>
<div class="ttc" id="Logging_8h_html_a0bfc26706a9022c017dd03af3c7c91d7"><div class="ttname"><a href="Logging_8h.html#a0bfc26706a9022c017dd03af3c7c91d7">dqm_warning</a></div><div class="ttdeci">#define dqm_warning(...)</div><div class="ttdef"><b>Definition:</b> <a href="Logging_8h_source.html#l00027">Logging.h:27</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1Client_html_a546e7c38fbbc34d0d04b4fa5b2984086"><div class="ttname"><a href="classdqm4hep_1_1net_1_1Client.html#a546e7c38fbbc34d0d04b4fa5b2984086">dqm4hep::net::Client::notifyServerOnExit</a></div><div class="ttdeci">void notifyServerOnExit(const std::string &amp;serverName)</div><div class="ttdoc">. </div><div class="ttdef"><b>Definition:</b> <a href="Client_8cc_source.html#l00054">Client.cc:54</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_a35e526f1e321736f786fb3be287017b4"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#a35e526f1e321736f786fb3be287017b4">dqm4hep::online::EventSource::m_client</a></div><div class="ttdeci">net::Client m_client</div><div class="ttdoc">The networking client interface. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00152">EventSource.h:152</a></div></div>
<div class="ttc" id="Logging_8h_html_afeed011feb4159b13c3ae4873e1d0fcf"><div class="ttname"><a href="Logging_8h.html#afeed011feb4159b13c3ae4873e1d0fcf">dqm_debug</a></div><div class="ttdeci">#define dqm_debug(...)</div><div class="ttdef"><b>Definition:</b> <a href="Logging_8h_source.html#l00026">Logging.h:26</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1Application_html_a218ca8c4cb4764f78ae04984049c023d"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1Application.html#a218ca8c4cb4764f78ae04984049c023d">dqm4hep::online::OnlineRoutes::Application::serverName</a></div><div class="ttdeci">static std::string serverName(const std::string &amp;type, const std::string &amp;name)</div><div class="ttdoc">Get the server name given an app type and name. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00036">OnlineRoutes.cc:36</a></div></div>
<div class="ttc" id="namespacedqm4hep_1_1core_html_adbf7ece0bddde655770fc3623b8e9445"><div class="ttname"><a href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">dqm4hep::core::json</a></div><div class="ttdeci">nlohmann::json json</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l00020">json.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a31a26daf8e643b818fd86a75abce04e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::EventSource::sendEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacedqm4hep_1_1core.html#ab9609d26a565705b8805e0354461c2e8">core::EventPtr</a>&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a single event to all registered collectors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event</td><td>the event pointer to serialize and send </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00089">89</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="EventSource_8h_source.html#l00151">m_collectorInfos</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00100">sendEvent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                                  {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="namespacedqm4hep_1_1core.html#a1ad5f93cca8ca24236779b1a0798fb63">core::StringVector</a> collectors;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">for</span>(<span class="keyword">auto</span> iter : <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        collectors.push_back(iter.first);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      this-&gt;<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a31a26daf8e643b818fd86a75abce04e0">sendEvent</a>(collectors, event);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ab677c42a2ba64a89b25b54a1c5f95306"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">dqm4hep::online::EventSource::m_collectorInfos</a></div><div class="ttdeci">CollectorInfoMap m_collectorInfos</div><div class="ttdoc">The map of event collector infos. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00151">EventSource.h:151</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_a31a26daf8e643b818fd86a75abce04e0"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#a31a26daf8e643b818fd86a75abce04e0">dqm4hep::online::EventSource::sendEvent</a></div><div class="ttdeci">void sendEvent(core::EventPtr event)</div><div class="ttdoc">Send a single event to all registered collectors. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8cc_source.html#l00089">EventSource.cc:89</a></div></div>
<div class="ttc" id="namespacedqm4hep_1_1core_html_a1ad5f93cca8ca24236779b1a0798fb63"><div class="ttname"><a href="namespacedqm4hep_1_1core.html#a1ad5f93cca8ca24236779b1a0798fb63">dqm4hep::core::StringVector</a></div><div class="ttdeci">std::vector&lt; std::string &gt; StringVector</div><div class="ttdef"><b>Definition:</b> <a href="Internal_8h_source.html#l00264">Internal.h:264</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a884a64f3746ff91c6c18640bd492f7cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::EventSource::sendEvent </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>collector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedqm4hep_1_1core.html#ab9609d26a565705b8805e0354461c2e8">core::EventPtr</a>&#160;</td>
          <td class="paramname"><em>event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a single event to a single collector. </p>
<p>The collector must have been registered with the function <a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a67ad7a32fea642021dff3aa87788979c" title="Add a new collector server to which events will be sent. ">addCollector()</a> before calling this function</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">collector</td><td>the event collector to send </td></tr>
    <tr><td class="paramname">event</td><td>the event pointer to serialize and send </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00100">100</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="Logging_8h_source.html#l00028">dqm_error</a>, <a class="el" href="EventSource_8h_source.html#l00151">m_collectorInfos</a>, and <a class="el" href="EventSource_8cc_source.html#l00089">sendEvent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                                                              {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>.end() == <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>.find(collector)) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="Logging_8h.html#a491803e6943ef6dac7a84b79dd9eaea7">dqm_error</a>( <span class="stringliteral">&quot;EventSource::sendEvent(col,evt): collector &#39;{0}&#39; not registered !&quot;</span>, collector );</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">throw</span> core::StatusCodeException(core::STATUS_CODE_NOT_FOUND);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      this-&gt;<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a31a26daf8e643b818fd86a75abce04e0">sendEvent</a>(<a class="code" href="namespacedqm4hep_1_1core.html#a1ad5f93cca8ca24236779b1a0798fb63">core::StringVector</a>({collector}), event);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ab677c42a2ba64a89b25b54a1c5f95306"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">dqm4hep::online::EventSource::m_collectorInfos</a></div><div class="ttdeci">CollectorInfoMap m_collectorInfos</div><div class="ttdoc">The map of event collector infos. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00151">EventSource.h:151</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_a31a26daf8e643b818fd86a75abce04e0"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#a31a26daf8e643b818fd86a75abce04e0">dqm4hep::online::EventSource::sendEvent</a></div><div class="ttdeci">void sendEvent(core::EventPtr event)</div><div class="ttdoc">Send a single event to all registered collectors. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8cc_source.html#l00089">EventSource.cc:89</a></div></div>
<div class="ttc" id="Logging_8h_html_a491803e6943ef6dac7a84b79dd9eaea7"><div class="ttname"><a href="Logging_8h.html#a491803e6943ef6dac7a84b79dd9eaea7">dqm_error</a></div><div class="ttdeci">#define dqm_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="Logging_8h_source.html#l00028">Logging.h:28</a></div></div>
<div class="ttc" id="namespacedqm4hep_1_1core_html_a1ad5f93cca8ca24236779b1a0798fb63"><div class="ttname"><a href="namespacedqm4hep_1_1core.html#a1ad5f93cca8ca24236779b1a0798fb63">dqm4hep::core::StringVector</a></div><div class="ttdeci">std::vector&lt; std::string &gt; StringVector</div><div class="ttdef"><b>Definition:</b> <a href="Internal_8h_source.html#l00264">Internal.h:264</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a92f20640713c43b91f1de326b65244c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::EventSource::sendEvent </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacedqm4hep_1_1core.html#a1ad5f93cca8ca24236779b1a0798fb63">core::StringVector</a> &amp;&#160;</td>
          <td class="paramname"><em>collectors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacedqm4hep_1_1core.html#ab9609d26a565705b8805e0354461c2e8">core::EventPtr</a>&#160;</td>
          <td class="paramname"><em>event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform the actual event sending to the specified list of collectors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">collectors</td><td>the list of collectors </td></tr>
    <tr><td class="paramname">event</td><td>the event to send </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00111">111</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="OnlineRoutes_8cc_source.html#l00049">dqm4hep::online::OnlineRoutes::EventCollector::applicationType()</a>, <a class="el" href="OnlineRoutes_8cc_source.html#l00067">dqm4hep::online::OnlineRoutes::EventCollector::collectEvent()</a>, <a class="el" href="NetBuffer_8h_source.html#l00274">dqm4hep::net::Buffer::createModel()</a>, <a class="el" href="Logging_8h_source.html#l00028">dqm_error</a>, <a class="el" href="Logging_8h_source.html#l00027">dqm_warning</a>, <a class="el" href="EventSource_8cc_source.html#l00167">getSourceInfo()</a>, <a class="el" href="Server_8cc_source.html#l00301">dqm4hep::net::Server::isServerRunning()</a>, <a class="el" href="EventSource_8h_source.html#l00153">m_buffer</a>, <a class="el" href="EventSource_8h_source.html#l00152">m_client</a>, <a class="el" href="EventSource_8h_source.html#l00151">m_collectorInfos</a>, <a class="el" href="EventSource_8h_source.html#l00150">m_eventStreamer</a>, <a class="el" href="EventSource_8h_source.html#l00149">m_sourceName</a>, <a class="el" href="EventSource_8h_source.html#l00148">m_started</a>, <a class="el" href="EventSource_8cc_source.html#l00186">registerMe()</a>, <a class="el" href="Client_8h_source.html#l00191">dqm4hep::net::Client::sendCommand()</a>, <a class="el" href="OnlineRoutes_8cc_source.html#l00036">dqm4hep::online::OnlineRoutes::Application::serverName()</a>, <a class="el" href="NetBuffer_8cc_source.html#l00087">dqm4hep::net::Buffer::setModel()</a>, <a class="el" href="StatusCodes_8h_source.html#l00048">THROW_RESULT_IF</a>, and <a class="el" href="EventStreamer_8cc_source.html#l00023">dqm4hep::core::EventStreamer::writeEvent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                                                                      {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">if</span>(not <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab4761b3a8abaa6219553bb7078d0fe78">m_started</a>) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">throw</span> core::StatusCodeException(core::STATUS_CODE_NOT_INITIALIZED);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">nullptr</span> == event) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">throw</span> core::StatusCodeException(core::STATUS_CODE_INVALID_PTR);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a217b3057ae0182f87346d76bd21773b0">m_buffer</a>.Reset();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="StatusCodes_8h.html#ab49c8013f48bd677d0e5e39cb506b8f9">THROW_RESULT_IF</a>(core::STATUS_CODE_SUCCESS, !=, <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a96da5151d6d5f9423ee8732994598cba">m_eventStreamer</a>.<a class="code" href="classdqm4hep_1_1core_1_1EventStreamer.html#a0e2e9d3f650a8d81e213424019f7be35">writeEvent</a>(event, <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a217b3057ae0182f87346d76bd21773b0">m_buffer</a>));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <a class="code" href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">core::json</a> sourceInfo;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      net::Buffer collectBuffer;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keyword">auto</span> model = collectBuffer.createModel();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      collectBuffer.setModel(model);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      model-&gt;handle(<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a217b3057ae0182f87346d76bd21773b0">m_buffer</a>.Buffer(), <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a217b3057ae0182f87346d76bd21773b0">m_buffer</a>.Length());</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="comment">// send serialized event to all collectors </span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">for</span>(<span class="keyword">auto</span> collector : collectors) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keyword">auto</span> iter = <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>.find(collector);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>.end() == iter) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          <a class="code" href="Logging_8h.html#a491803e6943ef6dac7a84b79dd9eaea7">dqm_error</a>( <span class="stringliteral">&quot;EventSource::sendEvent(): Collector &#39;{0}&#39; not found... Something is wrong !!!&quot;</span>, collector );</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          <span class="keywordflow">throw</span> core::StatusCodeException(core::STATUS_CODE_NOT_FOUND);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// Is the event collector server actually running ?</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keyword">const</span> std::string serverName(<a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1Application.html#a218ca8c4cb4764f78ae04984049c023d">OnlineRoutes::Application::serverName</a>(<a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector.html#a712d6e1490b64f0127ed606350c3a623">OnlineRoutes::EventCollector::applicationType</a>(), iter-&gt;first));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="classdqm4hep_1_1net_1_1Server.html#a2f58dc00ef5c48af7a9cbb9337568869">net::Server::isServerRunning</a>(serverName)) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          <span class="comment">// in case the server was stopped, we will need to send </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <span class="comment">// back the source registration on wake up</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          iter-&gt;second.m_registered = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// if not yet registered to the collector, do it</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span>(!iter-&gt;second.m_registered) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          <span class="comment">// get it once</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          <span class="keywordflow">if</span>(sourceInfo.empty()) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            this-&gt;<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#aa72aa0d322337e7e9cdccea5992fe560">getSourceInfo</a>(sourceInfo);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          }            </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          iter-&gt;second.m_registered = this-&gt;<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ae7c992768da87cfd3557b4544a3bdd76">registerMe</a>(iter-&gt;first, sourceInfo);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span>(!iter-&gt;second.m_registered) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          <a class="code" href="Logging_8h.html#a0bfc26706a9022c017dd03af3c7c91d7">dqm_warning</a>( <span class="stringliteral">&quot;EventSource::sendEvent(): Source &#39;{0}&#39; not registered yet to collector &#39;{1}&#39;. Skipping ...&quot;</span>, <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">m_sourceName</a>, collector );</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a35e526f1e321736f786fb3be287017b4">m_client</a>.<a class="code" href="classdqm4hep_1_1net_1_1Client.html#af909a5f8ebc100e7249082b90c8eddb1">sendCommand</a>(<a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector.html#a797ac8fa5b0828598ef21c1a08746795">OnlineRoutes::EventCollector::collectEvent</a>(collector), collectBuffer);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      }  </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ae7c992768da87cfd3557b4544a3bdd76"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ae7c992768da87cfd3557b4544a3bdd76">dqm4hep::online::EventSource::registerMe</a></div><div class="ttdeci">bool registerMe(const std::string &amp;collector, const core::json &amp;info)</div><div class="ttdoc">Register the event source to the specified collector. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8cc_source.html#l00186">EventSource.cc:186</a></div></div>
<div class="ttc" id="StatusCodes_8h_html_ab49c8013f48bd677d0e5e39cb506b8f9"><div class="ttname"><a href="StatusCodes_8h.html#ab49c8013f48bd677d0e5e39cb506b8f9">THROW_RESULT_IF</a></div><div class="ttdeci">#define THROW_RESULT_IF(StatusCode1, Operator, Command)</div><div class="ttdef"><b>Definition:</b> <a href="StatusCodes_8h_source.html#l00048">StatusCodes.h:48</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ab4761b3a8abaa6219553bb7078d0fe78"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ab4761b3a8abaa6219553bb7078d0fe78">dqm4hep::online::EventSource::m_started</a></div><div class="ttdeci">bool m_started</div><div class="ttdoc">Whether the event source was started. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00148">EventSource.h:148</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector_html_a712d6e1490b64f0127ed606350c3a623"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector.html#a712d6e1490b64f0127ed606350c3a623">dqm4hep::online::OnlineRoutes::EventCollector::applicationType</a></div><div class="ttdeci">static std::string applicationType()</div><div class="ttdoc">Get the event collector application type. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00049">OnlineRoutes.cc:49</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ab677c42a2ba64a89b25b54a1c5f95306"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">dqm4hep::online::EventSource::m_collectorInfos</a></div><div class="ttdeci">CollectorInfoMap m_collectorInfos</div><div class="ttdoc">The map of event collector infos. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00151">EventSource.h:151</a></div></div>
<div class="ttc" id="Logging_8h_html_a0bfc26706a9022c017dd03af3c7c91d7"><div class="ttname"><a href="Logging_8h.html#a0bfc26706a9022c017dd03af3c7c91d7">dqm_warning</a></div><div class="ttdeci">#define dqm_warning(...)</div><div class="ttdef"><b>Definition:</b> <a href="Logging_8h_source.html#l00027">Logging.h:27</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1Client_html_af909a5f8ebc100e7249082b90c8eddb1"><div class="ttname"><a href="classdqm4hep_1_1net_1_1Client.html#af909a5f8ebc100e7249082b90c8eddb1">dqm4hep::net::Client::sendCommand</a></div><div class="ttdeci">void sendCommand(const std::string &amp;name, const Command &amp;command, bool blocking=false) const </div><div class="ttdoc">Send a command. </div><div class="ttdef"><b>Definition:</b> <a href="Client_8h_source.html#l00191">Client.h:191</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_a35e526f1e321736f786fb3be287017b4"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#a35e526f1e321736f786fb3be287017b4">dqm4hep::online::EventSource::m_client</a></div><div class="ttdeci">net::Client m_client</div><div class="ttdoc">The networking client interface. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00152">EventSource.h:152</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_a96da5151d6d5f9423ee8732994598cba"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#a96da5151d6d5f9423ee8732994598cba">dqm4hep::online::EventSource::m_eventStreamer</a></div><div class="ttdeci">core::EventStreamer m_eventStreamer</div><div class="ttdoc">The event streamer. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00150">EventSource.h:150</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ae3a7d1e7404b31e1d63fac960632b62e"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">dqm4hep::online::EventSource::m_sourceName</a></div><div class="ttdeci">std::string m_sourceName</div><div class="ttdoc">The source name. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00149">EventSource.h:149</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector_html_a797ac8fa5b0828598ef21c1a08746795"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector.html#a797ac8fa5b0828598ef21c1a08746795">dqm4hep::online::OnlineRoutes::EventCollector::collectEvent</a></div><div class="ttdeci">static std::string collectEvent(const std::string &amp;collector)</div><div class="ttdoc">Get the event collector command name to collect an event. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00067">OnlineRoutes.cc:67</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1Application_html_a218ca8c4cb4764f78ae04984049c023d"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1Application.html#a218ca8c4cb4764f78ae04984049c023d">dqm4hep::online::OnlineRoutes::Application::serverName</a></div><div class="ttdeci">static std::string serverName(const std::string &amp;type, const std::string &amp;name)</div><div class="ttdoc">Get the server name given an app type and name. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00036">OnlineRoutes.cc:36</a></div></div>
<div class="ttc" id="classdqm4hep_1_1core_1_1EventStreamer_html_a0e2e9d3f650a8d81e213424019f7be35"><div class="ttname"><a href="classdqm4hep_1_1core_1_1EventStreamer.html#a0e2e9d3f650a8d81e213424019f7be35">dqm4hep::core::EventStreamer::writeEvent</a></div><div class="ttdeci">StatusCode writeEvent(EventPtr event, TBuffer &amp;buffer)</div><div class="ttdoc">Write an event using an xdrstream device. </div><div class="ttdef"><b>Definition:</b> <a href="EventStreamer_8cc_source.html#l00023">EventStreamer.cc:23</a></div></div>
<div class="ttc" id="Logging_8h_html_a491803e6943ef6dac7a84b79dd9eaea7"><div class="ttname"><a href="Logging_8h.html#a491803e6943ef6dac7a84b79dd9eaea7">dqm_error</a></div><div class="ttdeci">#define dqm_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="Logging_8h_source.html#l00028">Logging.h:28</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_a217b3057ae0182f87346d76bd21773b0"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#a217b3057ae0182f87346d76bd21773b0">dqm4hep::online::EventSource::m_buffer</a></div><div class="ttdeci">TBufferFile m_buffer</div><div class="ttdoc">The serialized event raw buffer. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00153">EventSource.h:153</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_aa72aa0d322337e7e9cdccea5992fe560"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#aa72aa0d322337e7e9cdccea5992fe560">dqm4hep::online::EventSource::getSourceInfo</a></div><div class="ttdeci">void getSourceInfo(core::json &amp;info)</div><div class="ttdoc">Get the source info (host info + source info) </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8cc_source.html#l00167">EventSource.cc:167</a></div></div>
<div class="ttc" id="namespacedqm4hep_1_1core_html_adbf7ece0bddde655770fc3623b8e9445"><div class="ttname"><a href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">dqm4hep::core::json</a></div><div class="ttdeci">nlohmann::json json</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l00020">json.h:20</a></div></div>
<div class="ttc" id="classdqm4hep_1_1net_1_1Server_html_a2f58dc00ef5c48af7a9cbb9337568869"><div class="ttname"><a href="classdqm4hep_1_1net_1_1Server.html#a2f58dc00ef5c48af7a9cbb9337568869">dqm4hep::net::Server::isServerRunning</a></div><div class="ttdeci">static bool isServerRunning(const std::string &amp;serverName)</div><div class="ttdoc">Whether the target server is already running on the network. </div><div class="ttdef"><b>Definition:</b> <a href="Server_8cc_source.html#l00301">Server.cc:301</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0c7a4052807e6d719e41dbf37331cebb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::string &amp; dqm4hep::online::EventSource::sourceName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the source name. </p>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00042">42</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="EventSource_8h_source.html#l00149">m_sourceName</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                                   {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">m_sourceName</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ae3a7d1e7404b31e1d63fac960632b62e"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">dqm4hep::online::EventSource::m_sourceName</a></div><div class="ttdeci">std::string m_sourceName</div><div class="ttdoc">The source name. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00149">EventSource.h:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a25ff0612616b74305d8819d721df1a58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::EventSource::start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the event source. </p>
<p>Setup raw buffers and register it to event collectors </p>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00066">66</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="Logging_8h_source.html#l00028">dqm_error</a>, <a class="el" href="EventSource_8cc_source.html#l00167">getSourceInfo()</a>, <a class="el" href="EventSource_8h_source.html#l00151">m_collectorInfos</a>, <a class="el" href="EventSource_8h_source.html#l00149">m_sourceName</a>, <a class="el" href="EventSource_8h_source.html#l00148">m_started</a>, and <a class="el" href="EventSource_8cc_source.html#l00186">registerMe()</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                            {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab4761b3a8abaa6219553bb7078d0fe78">m_started</a>) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">throw</span> core::StatusCodeException(core::STATUS_CODE_ALREADY_INITIALIZED);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>.empty()) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="Logging_8h.html#a491803e6943ef6dac7a84b79dd9eaea7">dqm_error</a>( <span class="stringliteral">&quot;EventSource::start(): Event source &#39;{0}&#39; has no collector to send event. Couldn&#39;t initialize!&quot;</span>, <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">m_sourceName</a> );</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">throw</span> core::StatusCodeException(core::STATUS_CODE_NOT_INITIALIZED);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">core::json</a> sourceInfo;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      this-&gt;<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#aa72aa0d322337e7e9cdccea5992fe560">getSourceInfo</a>(sourceInfo);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">for</span>(<span class="keyword">auto</span> colIter : <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">m_collectorInfos</a>) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordtype">bool</span> registered = this-&gt;<a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ae7c992768da87cfd3557b4544a3bdd76">registerMe</a>(colIter.first, sourceInfo);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        colIter.second.m_registered = registered;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#ab4761b3a8abaa6219553bb7078d0fe78">m_started</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ae7c992768da87cfd3557b4544a3bdd76"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ae7c992768da87cfd3557b4544a3bdd76">dqm4hep::online::EventSource::registerMe</a></div><div class="ttdeci">bool registerMe(const std::string &amp;collector, const core::json &amp;info)</div><div class="ttdoc">Register the event source to the specified collector. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8cc_source.html#l00186">EventSource.cc:186</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ab4761b3a8abaa6219553bb7078d0fe78"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ab4761b3a8abaa6219553bb7078d0fe78">dqm4hep::online::EventSource::m_started</a></div><div class="ttdeci">bool m_started</div><div class="ttdoc">Whether the event source was started. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00148">EventSource.h:148</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ab677c42a2ba64a89b25b54a1c5f95306"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ab677c42a2ba64a89b25b54a1c5f95306">dqm4hep::online::EventSource::m_collectorInfos</a></div><div class="ttdeci">CollectorInfoMap m_collectorInfos</div><div class="ttdoc">The map of event collector infos. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00151">EventSource.h:151</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_ae3a7d1e7404b31e1d63fac960632b62e"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#ae3a7d1e7404b31e1d63fac960632b62e">dqm4hep::online::EventSource::m_sourceName</a></div><div class="ttdeci">std::string m_sourceName</div><div class="ttdoc">The source name. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00149">EventSource.h:149</a></div></div>
<div class="ttc" id="Logging_8h_html_a491803e6943ef6dac7a84b79dd9eaea7"><div class="ttname"><a href="Logging_8h.html#a491803e6943ef6dac7a84b79dd9eaea7">dqm_error</a></div><div class="ttdeci">#define dqm_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="Logging_8h_source.html#l00028">Logging.h:28</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_aa72aa0d322337e7e9cdccea5992fe560"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#aa72aa0d322337e7e9cdccea5992fe560">dqm4hep::online::EventSource::getSourceInfo</a></div><div class="ttdeci">void getSourceInfo(core::json &amp;info)</div><div class="ttdoc">Get the source info (host info + source info) </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8cc_source.html#l00167">EventSource.cc:167</a></div></div>
<div class="ttc" id="namespacedqm4hep_1_1core_html_adbf7ece0bddde655770fc3623b8e9445"><div class="ttname"><a href="namespacedqm4hep_1_1core.html#adbf7ece0bddde655770fc3623b8e9445">dqm4hep::core::json</a></div><div class="ttdeci">nlohmann::json json</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l00020">json.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2afa8b71476aadbd125e68f0fc3aa7fa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::EventSource::unregisterMe </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>collector</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Un-register the event source from the specified collector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">collector</td><td>the collector name to un-register to </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="EventSource_8cc_source.html#l00225">225</a> of file <a class="el" href="EventSource_8cc_source.html">EventSource.cc</a>.</p>

<p>References <a class="el" href="EventSource_8h_source.html#l00152">m_client</a>, <a class="el" href="Client_8h_source.html#l00191">dqm4hep::net::Client::sendCommand()</a>, and <a class="el" href="OnlineRoutes_8cc_source.html#l00061">dqm4hep::online::OnlineRoutes::EventCollector::unregisterSource()</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00034">~EventSource()</a>.</p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                                             {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      std::string commandName = <a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector.html#a68f3d36ba3af760d34ba281d9b94ff3f">OnlineRoutes::EventCollector::unregisterSource</a>(collector);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1EventSource.html#a35e526f1e321736f786fb3be287017b4">m_client</a>.<a class="code" href="classdqm4hep_1_1net_1_1Client.html#af909a5f8ebc100e7249082b90c8eddb1">sendCommand</a>(commandName, std::string(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1net_1_1Client_html_af909a5f8ebc100e7249082b90c8eddb1"><div class="ttname"><a href="classdqm4hep_1_1net_1_1Client.html#af909a5f8ebc100e7249082b90c8eddb1">dqm4hep::net::Client::sendCommand</a></div><div class="ttdeci">void sendCommand(const std::string &amp;name, const Command &amp;command, bool blocking=false) const </div><div class="ttdoc">Send a command. </div><div class="ttdef"><b>Definition:</b> <a href="Client_8h_source.html#l00191">Client.h:191</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector_html_a68f3d36ba3af760d34ba281d9b94ff3f"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1EventCollector.html#a68f3d36ba3af760d34ba281d9b94ff3f">dqm4hep::online::OnlineRoutes::EventCollector::unregisterSource</a></div><div class="ttdeci">static std::string unregisterSource(const std::string &amp;collector)</div><div class="ttdoc">Get the event collector command name to unregister a new event source. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00061">OnlineRoutes.cc:61</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1EventSource_html_a35e526f1e321736f786fb3be287017b4"><div class="ttname"><a href="classdqm4hep_1_1online_1_1EventSource.html#a35e526f1e321736f786fb3be287017b4">dqm4hep::online::EventSource::m_client</a></div><div class="ttdeci">net::Client m_client</div><div class="ttdoc">The networking client interface. </div><div class="ttdef"><b>Definition:</b> <a href="EventSource_8h_source.html#l00152">EventSource.h:152</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a217b3057ae0182f87346d76bd21773b0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TBufferFile dqm4hep::online::EventSource::m_buffer = {TBuffer::kWrite, 2*1024*1024}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The serialized event raw buffer. </p>

<p>Definition at line <a class="el" href="EventSource_8h_source.html#l00153">153</a> of file <a class="el" href="EventSource_8h_source.html">EventSource.h</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00111">sendEvent()</a>.</p>

</div>
</div>
<a class="anchor" id="a35e526f1e321736f786fb3be287017b4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdqm4hep_1_1net_1_1Client.html">net::Client</a> dqm4hep::online::EventSource::m_client = {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The networking client interface. </p>

<p>Definition at line <a class="el" href="EventSource_8h_source.html#l00152">152</a> of file <a class="el" href="EventSource_8h_source.html">EventSource.h</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00186">registerMe()</a>, <a class="el" href="EventSource_8cc_source.html#l00111">sendEvent()</a>, and <a class="el" href="EventSource_8cc_source.html#l00225">unregisterMe()</a>.</p>

</div>
</div>
<a class="anchor" id="ab677c42a2ba64a89b25b54a1c5f95306"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdqm4hep_1_1online_1_1EventSource.html#a24dd92e30ac741f8aeb2466f1d86aad8">CollectorInfoMap</a> dqm4hep::online::EventSource::m_collectorInfos = {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The map of event collector infos. </p>

<p>Definition at line <a class="el" href="EventSource_8h_source.html#l00151">151</a> of file <a class="el" href="EventSource_8h_source.html">EventSource.h</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00048">addCollector()</a>, <a class="el" href="EventSource_8cc_source.html#l00167">getSourceInfo()</a>, <a class="el" href="EventSource_8cc_source.html#l00089">sendEvent()</a>, <a class="el" href="EventSource_8cc_source.html#l00066">start()</a>, and <a class="el" href="EventSource_8cc_source.html#l00034">~EventSource()</a>.</p>

</div>
</div>
<a class="anchor" id="a96da5151d6d5f9423ee8732994598cba"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdqm4hep_1_1core_1_1EventStreamer.html">core::EventStreamer</a> dqm4hep::online::EventSource::m_eventStreamer = {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The event streamer. </p>

<p>Definition at line <a class="el" href="EventSource_8h_source.html#l00150">150</a> of file <a class="el" href="EventSource_8h_source.html">EventSource.h</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00111">sendEvent()</a>.</p>

</div>
</div>
<a class="anchor" id="ae3a7d1e7404b31e1d63fac960632b62e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string dqm4hep::online::EventSource::m_sourceName = {&quot;&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The source name. </p>

<p>Definition at line <a class="el" href="EventSource_8h_source.html#l00149">149</a> of file <a class="el" href="EventSource_8h_source.html">EventSource.h</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00167">getSourceInfo()</a>, <a class="el" href="EventSource_8cc_source.html#l00111">sendEvent()</a>, <a class="el" href="EventSource_8cc_source.html#l00042">sourceName()</a>, and <a class="el" href="EventSource_8cc_source.html#l00066">start()</a>.</p>

</div>
</div>
<a class="anchor" id="ab4761b3a8abaa6219553bb7078d0fe78"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool dqm4hep::online::EventSource::m_started = {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether the event source was started. </p>

<p>Definition at line <a class="el" href="EventSource_8h_source.html#l00148">148</a> of file <a class="el" href="EventSource_8h_source.html">EventSource.h</a>.</p>

<p>Referenced by <a class="el" href="EventSource_8cc_source.html#l00048">addCollector()</a>, <a class="el" href="EventSource_8cc_source.html#l00111">sendEvent()</a>, and <a class="el" href="EventSource_8cc_source.html#l00066">start()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="EventSource_8h_source.html">EventSource.h</a></li>
<li><a class="el" href="EventSource_8cc_source.html">EventSource.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 16 2018 23:22:28 for DQM4hep by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>

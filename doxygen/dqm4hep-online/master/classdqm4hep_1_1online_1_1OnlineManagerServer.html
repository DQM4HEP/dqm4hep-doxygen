<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DQMOnline: dqm4hep::online::OnlineManagerServer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DQMOnline
   &#160;<span id="projectnumber">1.2.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacedqm4hep.html">dqm4hep</a></li><li class="navelem"><a class="el" href="namespacedqm4hep_1_1online.html">online</a></li><li class="navelem"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html">OnlineManagerServer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classdqm4hep_1_1online_1_1OnlineManagerServer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">dqm4hep::online::OnlineManagerServer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html" title="OnlineManagerServer class. ">OnlineManagerServer</a> class.  
 <a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1495ca87beb5ed462402ca9d57d33f13"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a1495ca87beb5ed462402ca9d57d33f13">OnlineManagerServer</a> ()=default</td></tr>
<tr class="memdesc:a1495ca87beb5ed462402ca9d57d33f13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a1495ca87beb5ed462402ca9d57d33f13">More...</a><br/></td></tr>
<tr class="separator:a1495ca87beb5ed462402ca9d57d33f13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb3d89cc8149b449317b98998ab5a105"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#adb3d89cc8149b449317b98998ab5a105">run</a> ()</td></tr>
<tr class="memdesc:adb3d89cc8149b449317b98998ab5a105"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the server.  <a href="#adb3d89cc8149b449317b98998ab5a105">More...</a><br/></td></tr>
<tr class="separator:adb3d89cc8149b449317b98998ab5a105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a408f1070a766e16d1c5d0e895e13d7fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a408f1070a766e16d1c5d0e895e13d7fd">stop</a> ()</td></tr>
<tr class="memdesc:a408f1070a766e16d1c5d0e895e13d7fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the server.  <a href="#a408f1070a766e16d1c5d0e895e13d7fd">More...</a><br/></td></tr>
<tr class="separator:a408f1070a766e16d1c5d0e895e13d7fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac186fa8a4a8ac9286aa55f3be1c77fe5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ac186fa8a4a8ac9286aa55f3be1c77fe5">setLogProperties</a> (const std::string &amp;fileBaseName, size_t maxFileSize, size_t maxNFiles)</td></tr>
<tr class="memdesc:ac186fa8a4a8ac9286aa55f3be1c77fe5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Â .  <a href="#ac186fa8a4a8ac9286aa55f3be1c77fe5">More...</a><br/></td></tr>
<tr class="separator:ac186fa8a4a8ac9286aa55f3be1c77fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ae06651a90935bfefa388e63231e22451"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ae06651a90935bfefa388e63231e22451">collectLog</a> (const net::Buffer &amp;buffer)</td></tr>
<tr class="memdesc:ae06651a90935bfefa388e63231e22451"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collect a log message (server command)  <a href="#ae06651a90935bfefa388e63231e22451">More...</a><br/></td></tr>
<tr class="separator:ae06651a90935bfefa388e63231e22451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad79ba93544bbfcc2d1d9a9a0720055a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad79ba93544bbfcc2d1d9a9a0720055a1">collectAppStat</a> (const net::Buffer &amp;buffer)</td></tr>
<tr class="memdesc:ad79ba93544bbfcc2d1d9a9a0720055a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collect an app stat (server command)  <a href="#ad79ba93544bbfcc2d1d9a9a0720055a1">More...</a><br/></td></tr>
<tr class="separator:ad79ba93544bbfcc2d1d9a9a0720055a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b6aad3ae00692c25fbf7fe381df7929"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a2b6aad3ae00692c25fbf7fe381df7929">logMessage</a> (const core::json &amp;message)</td></tr>
<tr class="memdesc:a2b6aad3ae00692c25fbf7fe381df7929"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log message in log file.  <a href="#a2b6aad3ae00692c25fbf7fe381df7929">More...</a><br/></td></tr>
<tr class="separator:a2b6aad3ae00692c25fbf7fe381df7929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55f40c2f2a0d9bae862d32833eeab84d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a55f40c2f2a0d9bae862d32833eeab84d">currentTimeToString</a> () const </td></tr>
<tr class="separator:a55f40c2f2a0d9bae862d32833eeab84d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:af0eb17a475b4eea0a8e0f2d702ea1157"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; net::Server &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af0eb17a475b4eea0a8e0f2d702ea1157">m_server</a> = {nullptr}</td></tr>
<tr class="memdesc:af0eb17a475b4eea0a8e0f2d702ea1157"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main server.  <a href="#af0eb17a475b4eea0a8e0f2d702ea1157">More...</a><br/></td></tr>
<tr class="separator:af0eb17a475b4eea0a8e0f2d702ea1157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c68a29da011beb95129a89f9f8cd580"><td class="memItemLeft" align="right" valign="top">net::Service *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a4c68a29da011beb95129a89f9f8cd580">m_logsService</a> = {nullptr}</td></tr>
<tr class="memdesc:a4c68a29da011beb95129a89f9f8cd580"><td class="mdescLeft">&#160;</td><td class="mdescRight">The logs service.  <a href="#a4c68a29da011beb95129a89f9f8cd580">More...</a><br/></td></tr>
<tr class="separator:a4c68a29da011beb95129a89f9f8cd580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a2e68cf25784d640988ecab343a2070"><td class="memItemLeft" align="right" valign="top">net::Service *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a2a2e68cf25784d640988ecab343a2070">m_appStatsService</a> = {nullptr}</td></tr>
<tr class="memdesc:a2a2e68cf25784d640988ecab343a2070"><td class="mdescLeft">&#160;</td><td class="mdescRight">The application stats service.  <a href="#a2a2e68cf25784d640988ecab343a2070">More...</a><br/></td></tr>
<tr class="separator:a2a2e68cf25784d640988ecab343a2070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783499755807f631bdcf87514b0bdcec"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a783499755807f631bdcf87514b0bdcec">m_stopFlag</a> = {false}</td></tr>
<tr class="memdesc:a783499755807f631bdcf87514b0bdcec"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main loop stop flag.  <a href="#a783499755807f631bdcf87514b0bdcec">More...</a><br/></td></tr>
<tr class="separator:a783499755807f631bdcf87514b0bdcec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d17c259028e3e781d00de27ca778712"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a7d17c259028e3e781d00de27ca778712">m_logFileBaseName</a> = {&quot;&quot;}</td></tr>
<tr class="separator:a7d17c259028e3e781d00de27ca778712"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af12773e7c322f144331e5b356b88ff44"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af12773e7c322f144331e5b356b88ff44">m_logFileMaxSize</a> = {2*1024*1024}</td></tr>
<tr class="separator:af12773e7c322f144331e5b356b88ff44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac708e506a18bc5b280bf46f33ad8cdc4"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ac708e506a18bc5b280bf46f33ad8cdc4">m_logFileNFiles</a> = {2}</td></tr>
<tr class="separator:ac708e506a18bc5b280bf46f33ad8cdc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad98680e5fb1c111021ff8886317373aa"><td class="memItemLeft" align="right" valign="top">core::Logger::LoggerPtr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad98680e5fb1c111021ff8886317373aa">m_logger</a> = {nullptr}</td></tr>
<tr class="separator:ad98680e5fb1c111021ff8886317373aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html" title="OnlineManagerServer class. ">OnlineManagerServer</a> class. </p>

<p>Definition at line <a class="el" href="OnlineManagerServer_8h_source.html#l00049">49</a> of file <a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1495ca87beb5ed462402ca9d57d33f13"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dqm4hep::online::OnlineManagerServer::OnlineManagerServer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ad79ba93544bbfcc2d1d9a9a0720055a1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::OnlineManagerServer::collectAppStat </td>
          <td>(</td>
          <td class="paramtype">const net::Buffer &amp;&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Collect an app stat (server command) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>the app stat as json buffer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="OnlineManagerServer_8cc_source.html#l00109">109</a> of file <a class="el" href="OnlineManagerServer_8cc_source.html">OnlineManagerServer.cc</a>.</p>

<p>References <a class="el" href="OnlineManagerServer_8h_source.html#l00102">m_appStatsService</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                                                    {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      core::json appStat;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        appStat = core::json::parse(buffer.begin(), buffer.end());</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">catch</span>(core::json::parse_error&amp; e) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        dqm_warning( <span class="stringliteral">&quot;OnlineManagerServer::collectAppStat: received unexpected app stat (json parse error)&quot;</span> );</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="comment">// check app stat consistency</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordtype">bool</span> appStatConsistent = (</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        1 == appStat.count(<span class="stringliteral">&quot;logger&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        1 == appStat.count(<span class="stringliteral">&quot;value&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        1 == appStat.count(<span class="stringliteral">&quot;appType&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        1 == appStat.count(<span class="stringliteral">&quot;appName&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        1 == appStat.count(<span class="stringliteral">&quot;time&quot;</span>)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      );</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">if</span>(not appStatConsistent) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        dqm_warning( <span class="stringliteral">&quot;OnlineManagerServer::collectAppStat: received inconsistent app stat&quot;</span> );</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="comment">// send the log message to listeners</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a2a2e68cf25784d640988ecab343a2070">m_appStatsService</a>-&gt;sendBuffer(buffer.begin(), buffer.size());</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_a2a2e68cf25784d640988ecab343a2070"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a2a2e68cf25784d640988ecab343a2070">dqm4hep::online::OnlineManagerServer::m_appStatsService</a></div><div class="ttdeci">net::Service * m_appStatsService</div><div class="ttdoc">The application stats service. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00102">OnlineManagerServer.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae06651a90935bfefa388e63231e22451"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::OnlineManagerServer::collectLog </td>
          <td>(</td>
          <td class="paramtype">const net::Buffer &amp;&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Collect a log message (server command) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>the log message as json buffer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="OnlineManagerServer_8cc_source.html#l00080">80</a> of file <a class="el" href="OnlineManagerServer_8cc_source.html">OnlineManagerServer.cc</a>.</p>

<p>References <a class="el" href="OnlineManagerServer_8cc_source.html#l00135">logMessage()</a>, <a class="el" href="OnlineManagerServer_8h_source.html#l00107">m_logger</a>, and <a class="el" href="OnlineManagerServer_8h_source.html#l00101">m_logsService</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                                                {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      core::json message;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        message = core::json::parse(buffer.begin(), buffer.end());</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">catch</span>(core::json::parse_error&amp; e) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        dqm_warning( <span class="stringliteral">&quot;OnlineManagerServer::collectLog: received unexpected log message (json parse error)&quot;</span> );</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="comment">// check log consistency</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordtype">bool</span> logConsistent = (</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        1 == message.count(<span class="stringliteral">&quot;logger&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        1 == message.count(<span class="stringliteral">&quot;level&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        1 == message.count(<span class="stringliteral">&quot;message&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        1 == message.count(<span class="stringliteral">&quot;host&quot;</span>) &amp;&amp;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        1 == message.count(<span class="stringliteral">&quot;pid&quot;</span>)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      );</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">if</span>(not logConsistent) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        dqm_warning( <span class="stringliteral">&quot;OnlineManagerServer::collectLog: received inconsistent log message&quot;</span> );</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">if</span>(<span class="keyword">nullptr</span> != <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad98680e5fb1c111021ff8886317373aa">m_logger</a>) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        this-&gt;<a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a2b6aad3ae00692c25fbf7fe381df7929">logMessage</a>(message);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="comment">// send the log message to listeners</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a4c68a29da011beb95129a89f9f8cd580">m_logsService</a>-&gt;sendBuffer(buffer.begin(), buffer.size());</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_a2b6aad3ae00692c25fbf7fe381df7929"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a2b6aad3ae00692c25fbf7fe381df7929">dqm4hep::online::OnlineManagerServer::logMessage</a></div><div class="ttdeci">void logMessage(const core::json &amp;message)</div><div class="ttdoc">Log message in log file. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8cc_source.html#l00135">OnlineManagerServer.cc:135</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_ad98680e5fb1c111021ff8886317373aa"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad98680e5fb1c111021ff8886317373aa">dqm4hep::online::OnlineManagerServer::m_logger</a></div><div class="ttdeci">core::Logger::LoggerPtr m_logger</div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00107">OnlineManagerServer.h:107</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_a4c68a29da011beb95129a89f9f8cd580"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a4c68a29da011beb95129a89f9f8cd580">dqm4hep::online::OnlineManagerServer::m_logsService</a></div><div class="ttdeci">net::Service * m_logsService</div><div class="ttdoc">The logs service. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00101">OnlineManagerServer.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a55f40c2f2a0d9bae862d32833eeab84d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string dqm4hep::online::OnlineManagerServer::currentTimeToString </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="OnlineManagerServer_8cc_source.html#l00156">156</a> of file <a class="el" href="OnlineManagerServer_8cc_source.html">OnlineManagerServer.cc</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00135">logMessage()</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                                             {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      std::time_t t = std::time(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      std::string currentTime;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      currentTime.resize(9);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      std::strftime(const_cast&lt;char*&gt;(currentTime.c_str()), 9, <span class="stringliteral">&quot;%T&quot;</span>, std::localtime(&amp;t));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">return</span> currentTime;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2b6aad3ae00692c25fbf7fe381df7929"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::OnlineManagerServer::logMessage </td>
          <td>(</td>
          <td class="paramtype">const core::json &amp;&#160;</td>
          <td class="paramname"><em>message</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log message in log file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>the json object describing the log message </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="OnlineManagerServer_8cc_source.html#l00135">135</a> of file <a class="el" href="OnlineManagerServer_8cc_source.html">OnlineManagerServer.cc</a>.</p>

<p>References <a class="el" href="OnlineManagerServer_8cc_source.html#l00156">currentTimeToString()</a>, and <a class="el" href="OnlineManagerServer_8h_source.html#l00107">m_logger</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00080">collectLog()</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                                {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="comment">// extract metadata</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      std::string loggerName = message.value&lt;std::string&gt;(<span class="stringliteral">&quot;logger&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      core::Logger::Level logLevel = <span class="keyword">static_cast&lt;</span>core::Logger::Level<span class="keyword">&gt;</span>(message.value&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;level&quot;</span>, 0));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      std::string logLevelStr = core::Logger::logLevelToString(logLevel);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      std::string msg = message.value&lt;std::string&gt;(<span class="stringliteral">&quot;message&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      std::string host = message.value&lt;std::string&gt;(<span class="stringliteral">&quot;host&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordtype">int</span> pid = message.value&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;pid&quot;</span>, 0);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="comment">// log message</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      dqm_logger_log(<a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad98680e5fb1c111021ff8886317373aa">m_logger</a>, logLevel, </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="stringliteral">&quot;[{0} on {1} ({2})] {3} - {4}: {5}&quot;</span>, </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        loggerName, </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        host, </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        pid,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a55f40c2f2a0d9bae862d32833eeab84d">currentTimeToString</a>(),</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        logLevelStr, </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        msg);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_ad98680e5fb1c111021ff8886317373aa"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad98680e5fb1c111021ff8886317373aa">dqm4hep::online::OnlineManagerServer::m_logger</a></div><div class="ttdeci">core::Logger::LoggerPtr m_logger</div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00107">OnlineManagerServer.h:107</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_a55f40c2f2a0d9bae862d32833eeab84d"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a55f40c2f2a0d9bae862d32833eeab84d">dqm4hep::online::OnlineManagerServer::currentTimeToString</a></div><div class="ttdeci">std::string currentTimeToString() const </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8cc_source.html#l00156">OnlineManagerServer.cc:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adb3d89cc8149b449317b98998ab5a105"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::OnlineManagerServer::run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the server. </p>

<p>Definition at line <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">37</a> of file <a class="el" href="OnlineManagerServer_8cc_source.html">OnlineManagerServer.cc</a>.</p>

<p>References <a class="el" href="OnlineRoutes_8cc_source.html#l00066">dqm4hep::online::OnlineRoutes::OnlineManager::appStats()</a>, <a class="el" href="OnlineManagerServer_8cc_source.html#l00109">collectAppStat()</a>, <a class="el" href="OnlineRoutes_8cc_source.html#l00078">dqm4hep::online::OnlineRoutes::OnlineManager::collectAppStat()</a>, <a class="el" href="OnlineManagerServer_8cc_source.html#l00080">collectLog()</a>, <a class="el" href="OnlineRoutes_8cc_source.html#l00072">dqm4hep::online::OnlineRoutes::OnlineManager::collectLog()</a>, <a class="el" href="OnlineRoutes_8cc_source.html#l00060">dqm4hep::online::OnlineRoutes::OnlineManager::logs()</a>, <a class="el" href="OnlineManagerServer_8h_source.html#l00102">m_appStatsService</a>, <a class="el" href="OnlineManagerServer_8h_source.html#l00104">m_logFileBaseName</a>, <a class="el" href="OnlineManagerServer_8h_source.html#l00105">m_logFileMaxSize</a>, <a class="el" href="OnlineManagerServer_8h_source.html#l00106">m_logFileNFiles</a>, <a class="el" href="OnlineManagerServer_8h_source.html#l00107">m_logger</a>, <a class="el" href="OnlineManagerServer_8h_source.html#l00101">m_logsService</a>, <a class="el" href="OnlineManagerServer_8h_source.html#l00100">m_server</a>, <a class="el" href="OnlineManagerServer_8h_source.html#l00103">m_stopFlag</a>, and <a class="el" href="OnlineRoutes_8cc_source.html#l00054">dqm4hep::online::OnlineRoutes::OnlineManager::serverName()</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                  {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordflow">if</span>(not <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a7d17c259028e3e781d00de27ca778712">m_logFileBaseName</a>.empty()) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad98680e5fb1c111021ff8886317373aa">m_logger</a> = core::Logger::createLogger(<span class="stringliteral">&quot;online-logger&quot;</span>, {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;          core::Logger::rotatingFile(</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a7d17c259028e3e781d00de27ca778712">m_logFileBaseName</a>,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af12773e7c322f144331e5b356b88ff44">m_logFileMaxSize</a>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ac708e506a18bc5b280bf46f33ad8cdc4">m_logFileNFiles</a></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;          )</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        });</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad98680e5fb1c111021ff8886317373aa">m_logger</a>-&gt;set_pattern(<span class="stringliteral">&quot;%v&quot;</span>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad98680e5fb1c111021ff8886317373aa">m_logger</a>-&gt;set_level(spdlog::level::trace); <span class="comment">// all message        </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af0eb17a475b4eea0a8e0f2d702ea1157">m_server</a> = std::make_shared&lt;net::Server&gt;(<a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager.html#ab5bcf54d24245deb7e9444ee7f610c44">OnlineRoutes::OnlineManager::serverName</a>());</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a4c68a29da011beb95129a89f9f8cd580">m_logsService</a> = <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af0eb17a475b4eea0a8e0f2d702ea1157">m_server</a>-&gt;createService(<a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager.html#a6fd172d90329fd86dd6301cb0434794a">OnlineRoutes::OnlineManager::logs</a>());</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a2a2e68cf25784d640988ecab343a2070">m_appStatsService</a> = <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af0eb17a475b4eea0a8e0f2d702ea1157">m_server</a>-&gt;createService(<a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager.html#a502899e69d24f49ce259f8a80699037e">OnlineRoutes::OnlineManager::appStats</a>());</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af0eb17a475b4eea0a8e0f2d702ea1157">m_server</a>-&gt;createCommandHandler(<a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager.html#ae9d518a92bc7b7f437eb4f0fccc08ff4">OnlineRoutes::OnlineManager::collectLog</a>(), <span class="keyword">this</span>, &amp;<a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ae06651a90935bfefa388e63231e22451">OnlineManagerServer::collectLog</a>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af0eb17a475b4eea0a8e0f2d702ea1157">m_server</a>-&gt;createCommandHandler(<a class="code" href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager.html#a0a6c6445d606c5b33d3165b236495fdd">OnlineRoutes::OnlineManager::collectAppStat</a>(), <span class="keyword">this</span>, &amp;<a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad79ba93544bbfcc2d1d9a9a0720055a1">OnlineManagerServer::collectAppStat</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af0eb17a475b4eea0a8e0f2d702ea1157">m_server</a>-&gt;start();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">while</span>(not <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a783499755807f631bdcf87514b0bdcec">m_stopFlag</a>.load())</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        core::sleep(std::chrono::seconds(1));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager_html_a0a6c6445d606c5b33d3165b236495fdd"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager.html#a0a6c6445d606c5b33d3165b236495fdd">dqm4hep::online::OnlineRoutes::OnlineManager::collectAppStat</a></div><div class="ttdeci">static const std::string collectAppStat()</div><div class="ttdoc">Get the name of the commmand to send (client) or collect (server) an app statistics. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00078">OnlineRoutes.cc:78</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager_html_a502899e69d24f49ce259f8a80699037e"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager.html#a502899e69d24f49ce259f8a80699037e">dqm4hep::online::OnlineRoutes::OnlineManager::appStats</a></div><div class="ttdeci">static const std::string appStats()</div><div class="ttdoc">Get the name of the service that sends (server) or receive (client) app statistics. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00066">OnlineRoutes.cc:66</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager_html_ab5bcf54d24245deb7e9444ee7f610c44"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager.html#ab5bcf54d24245deb7e9444ee7f610c44">dqm4hep::online::OnlineRoutes::OnlineManager::serverName</a></div><div class="ttdeci">static const std::string serverName()</div><div class="ttdoc">Get the online manager server name. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00054">OnlineRoutes.cc:54</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_ad79ba93544bbfcc2d1d9a9a0720055a1"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad79ba93544bbfcc2d1d9a9a0720055a1">dqm4hep::online::OnlineManagerServer::collectAppStat</a></div><div class="ttdeci">void collectAppStat(const net::Buffer &amp;buffer)</div><div class="ttdoc">Collect an app stat (server command) </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8cc_source.html#l00109">OnlineManagerServer.cc:109</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager_html_ae9d518a92bc7b7f437eb4f0fccc08ff4"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager.html#ae9d518a92bc7b7f437eb4f0fccc08ff4">dqm4hep::online::OnlineRoutes::OnlineManager::collectLog</a></div><div class="ttdeci">static const std::string collectLog()</div><div class="ttdoc">Get the name of the commmand to send (client) or collect (server) a log message. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00072">OnlineRoutes.cc:72</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_ad98680e5fb1c111021ff8886317373aa"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ad98680e5fb1c111021ff8886317373aa">dqm4hep::online::OnlineManagerServer::m_logger</a></div><div class="ttdeci">core::Logger::LoggerPtr m_logger</div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00107">OnlineManagerServer.h:107</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_a7d17c259028e3e781d00de27ca778712"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a7d17c259028e3e781d00de27ca778712">dqm4hep::online::OnlineManagerServer::m_logFileBaseName</a></div><div class="ttdeci">std::string m_logFileBaseName</div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00104">OnlineManagerServer.h:104</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_af12773e7c322f144331e5b356b88ff44"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af12773e7c322f144331e5b356b88ff44">dqm4hep::online::OnlineManagerServer::m_logFileMaxSize</a></div><div class="ttdeci">std::size_t m_logFileMaxSize</div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00105">OnlineManagerServer.h:105</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_af0eb17a475b4eea0a8e0f2d702ea1157"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af0eb17a475b4eea0a8e0f2d702ea1157">dqm4hep::online::OnlineManagerServer::m_server</a></div><div class="ttdeci">std::shared_ptr&lt; net::Server &gt; m_server</div><div class="ttdoc">The main server. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00100">OnlineManagerServer.h:100</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_a2a2e68cf25784d640988ecab343a2070"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a2a2e68cf25784d640988ecab343a2070">dqm4hep::online::OnlineManagerServer::m_appStatsService</a></div><div class="ttdeci">net::Service * m_appStatsService</div><div class="ttdoc">The application stats service. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00102">OnlineManagerServer.h:102</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_a783499755807f631bdcf87514b0bdcec"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a783499755807f631bdcf87514b0bdcec">dqm4hep::online::OnlineManagerServer::m_stopFlag</a></div><div class="ttdeci">std::atomic&lt; bool &gt; m_stopFlag</div><div class="ttdoc">The main loop stop flag. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00103">OnlineManagerServer.h:103</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_ae06651a90935bfefa388e63231e22451"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ae06651a90935bfefa388e63231e22451">dqm4hep::online::OnlineManagerServer::collectLog</a></div><div class="ttdeci">void collectLog(const net::Buffer &amp;buffer)</div><div class="ttdoc">Collect a log message (server command) </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8cc_source.html#l00080">OnlineManagerServer.cc:80</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager_html_a6fd172d90329fd86dd6301cb0434794a"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineRoutes_1_1OnlineManager.html#a6fd172d90329fd86dd6301cb0434794a">dqm4hep::online::OnlineRoutes::OnlineManager::logs</a></div><div class="ttdeci">static const std::string logs()</div><div class="ttdoc">Get the name of the service that sends (server) or receives (client) logs. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineRoutes_8cc_source.html#l00060">OnlineRoutes.cc:60</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_ac708e506a18bc5b280bf46f33ad8cdc4"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ac708e506a18bc5b280bf46f33ad8cdc4">dqm4hep::online::OnlineManagerServer::m_logFileNFiles</a></div><div class="ttdeci">std::size_t m_logFileNFiles</div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00106">OnlineManagerServer.h:106</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_a4c68a29da011beb95129a89f9f8cd580"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a4c68a29da011beb95129a89f9f8cd580">dqm4hep::online::OnlineManagerServer::m_logsService</a></div><div class="ttdeci">net::Service * m_logsService</div><div class="ttdoc">The logs service. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00101">OnlineManagerServer.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac186fa8a4a8ac9286aa55f3be1c77fe5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::OnlineManagerServer::setLogProperties </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fileBaseName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maxFileSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maxNFiles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Â . </p>
<p>Set the rotating log file properties</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fileBaseName</td><td>the log file base name (.log appended) </td></tr>
    <tr><td class="paramname">maxFileSize</td><td>the maximum single file size (unit bytes) </td></tr>
    <tr><td class="paramname">maxNFiles</td><td>the maximum number of rotating files </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="OnlineManagerServer_8cc_source.html#l00072">72</a> of file <a class="el" href="OnlineManagerServer_8cc_source.html">OnlineManagerServer.cc</a>.</p>

<p>References <a class="el" href="OnlineManagerServer_8h_source.html#l00104">m_logFileBaseName</a>, <a class="el" href="OnlineManagerServer_8h_source.html#l00105">m_logFileMaxSize</a>, and <a class="el" href="OnlineManagerServer_8h_source.html#l00106">m_logFileNFiles</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                                                                                                  {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a7d17c259028e3e781d00de27ca778712">m_logFileBaseName</a> = fileBaseName;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af12773e7c322f144331e5b356b88ff44">m_logFileMaxSize</a> = maxFileSize;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ac708e506a18bc5b280bf46f33ad8cdc4">m_logFileNFiles</a> = maxNFiles;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_a7d17c259028e3e781d00de27ca778712"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a7d17c259028e3e781d00de27ca778712">dqm4hep::online::OnlineManagerServer::m_logFileBaseName</a></div><div class="ttdeci">std::string m_logFileBaseName</div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00104">OnlineManagerServer.h:104</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_af12773e7c322f144331e5b356b88ff44"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#af12773e7c322f144331e5b356b88ff44">dqm4hep::online::OnlineManagerServer::m_logFileMaxSize</a></div><div class="ttdeci">std::size_t m_logFileMaxSize</div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00105">OnlineManagerServer.h:105</a></div></div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_ac708e506a18bc5b280bf46f33ad8cdc4"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#ac708e506a18bc5b280bf46f33ad8cdc4">dqm4hep::online::OnlineManagerServer::m_logFileNFiles</a></div><div class="ttdeci">std::size_t m_logFileNFiles</div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00106">OnlineManagerServer.h:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a408f1070a766e16d1c5d0e895e13d7fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dqm4hep::online::OnlineManagerServer::stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the server. </p>

<p>Definition at line <a class="el" href="OnlineManagerServer_8cc_source.html#l00066">66</a> of file <a class="el" href="OnlineManagerServer_8cc_source.html">OnlineManagerServer.cc</a>.</p>

<p>References <a class="el" href="OnlineManagerServer_8h_source.html#l00103">m_stopFlag</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                   {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <a class="code" href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a783499755807f631bdcf87514b0bdcec">m_stopFlag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="ttc" id="classdqm4hep_1_1online_1_1OnlineManagerServer_html_a783499755807f631bdcf87514b0bdcec"><div class="ttname"><a href="classdqm4hep_1_1online_1_1OnlineManagerServer.html#a783499755807f631bdcf87514b0bdcec">dqm4hep::online::OnlineManagerServer::m_stopFlag</a></div><div class="ttdeci">std::atomic&lt; bool &gt; m_stopFlag</div><div class="ttdoc">The main loop stop flag. </div><div class="ttdef"><b>Definition:</b> <a href="OnlineManagerServer_8h_source.html#l00103">OnlineManagerServer.h:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a2a2e68cf25784d640988ecab343a2070"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">net::Service* dqm4hep::online::OnlineManagerServer::m_appStatsService = {nullptr}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The application stats service. </p>

<p>Definition at line <a class="el" href="OnlineManagerServer_8h_source.html#l00102">102</a> of file <a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00109">collectAppStat()</a>, and <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a7d17c259028e3e781d00de27ca778712"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string dqm4hep::online::OnlineManagerServer::m_logFileBaseName = {&quot;&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="OnlineManagerServer_8h_source.html#l00104">104</a> of file <a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">run()</a>, and <a class="el" href="OnlineManagerServer_8cc_source.html#l00072">setLogProperties()</a>.</p>

</div>
</div>
<a class="anchor" id="af12773e7c322f144331e5b356b88ff44"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t dqm4hep::online::OnlineManagerServer::m_logFileMaxSize = {2*1024*1024}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="OnlineManagerServer_8h_source.html#l00105">105</a> of file <a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">run()</a>, and <a class="el" href="OnlineManagerServer_8cc_source.html#l00072">setLogProperties()</a>.</p>

</div>
</div>
<a class="anchor" id="ac708e506a18bc5b280bf46f33ad8cdc4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t dqm4hep::online::OnlineManagerServer::m_logFileNFiles = {2}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="OnlineManagerServer_8h_source.html#l00106">106</a> of file <a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">run()</a>, and <a class="el" href="OnlineManagerServer_8cc_source.html#l00072">setLogProperties()</a>.</p>

</div>
</div>
<a class="anchor" id="ad98680e5fb1c111021ff8886317373aa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core::Logger::LoggerPtr dqm4hep::online::OnlineManagerServer::m_logger = {nullptr}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="OnlineManagerServer_8h_source.html#l00107">107</a> of file <a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00080">collectLog()</a>, <a class="el" href="OnlineManagerServer_8cc_source.html#l00135">logMessage()</a>, and <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a4c68a29da011beb95129a89f9f8cd580"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">net::Service* dqm4hep::online::OnlineManagerServer::m_logsService = {nullptr}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The logs service. </p>

<p>Definition at line <a class="el" href="OnlineManagerServer_8h_source.html#l00101">101</a> of file <a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00080">collectLog()</a>, and <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">run()</a>.</p>

</div>
</div>
<a class="anchor" id="af0eb17a475b4eea0a8e0f2d702ea1157"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;net::Server&gt; dqm4hep::online::OnlineManagerServer::m_server = {nullptr}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The main server. </p>

<p>Definition at line <a class="el" href="OnlineManagerServer_8h_source.html#l00100">100</a> of file <a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a783499755807f631bdcf87514b0bdcec"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;bool&gt; dqm4hep::online::OnlineManagerServer::m_stopFlag = {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The main loop stop flag. </p>

<p>Definition at line <a class="el" href="OnlineManagerServer_8h_source.html#l00103">103</a> of file <a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a>.</p>

<p>Referenced by <a class="el" href="OnlineManagerServer_8cc_source.html#l00037">run()</a>, and <a class="el" href="OnlineManagerServer_8cc_source.html#l00066">stop()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="OnlineManagerServer_8h_source.html">OnlineManagerServer.h</a></li>
<li><a class="el" href="OnlineManagerServer_8cc_source.html">OnlineManagerServer.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 23 2018 12:03:47 for DQMOnline by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>

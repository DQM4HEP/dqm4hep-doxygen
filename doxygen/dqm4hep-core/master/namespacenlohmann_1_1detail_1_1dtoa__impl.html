<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DQMCore: nlohmann::detail::dtoa_impl Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DQMCore
   &#160;<span id="projectnumber">2.3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacenlohmann.html">nlohmann</a></li><li class="navelem"><a class="el" href="namespacenlohmann_1_1detail.html">detail</a></li><li class="navelem"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html">dtoa_impl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">nlohmann::detail::dtoa_impl Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>implements the Grisu2 algorithm for binary to decimal floating-point conversion.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1diyfp.html">diyfp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1boundaries.html">boundaries</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1cached__power.html">cached_power</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1c5d30eb51e5e994a3f48bde104d2ce8"><td class="memTemplParams" colspan="2">template&lt;typename Target , typename Source &gt; </td></tr>
<tr class="memitem:a1c5d30eb51e5e994a3f48bde104d2ce8"><td class="memTemplItemLeft" align="right" valign="top">Target&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a1c5d30eb51e5e994a3f48bde104d2ce8">reinterpret_bits</a> (const Source source)</td></tr>
<tr class="separator:a1c5d30eb51e5e994a3f48bde104d2ce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22b6e37654ac93c6d0d9c06ec1bf5ded"><td class="memTemplParams" colspan="2">template&lt;typename FloatType &gt; </td></tr>
<tr class="memitem:a22b6e37654ac93c6d0d9c06ec1bf5ded"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1boundaries.html">boundaries</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a22b6e37654ac93c6d0d9c06ec1bf5ded">compute_boundaries</a> (FloatType value)</td></tr>
<tr class="separator:a22b6e37654ac93c6d0d9c06ec1bf5ded"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbf329a18c5cf854a3477327afd2200b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1cached__power.html">cached_power</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#adbf329a18c5cf854a3477327afd2200b">get_cached_power_for_binary_exponent</a> (int e)</td></tr>
<tr class="separator:adbf329a18c5cf854a3477327afd2200b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a264df2b5a7e19b864859161f3501155e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a264df2b5a7e19b864859161f3501155e">find_largest_pow10</a> (const uint32_t n, uint32_t &amp;pow10)</td></tr>
<tr class="separator:a264df2b5a7e19b864859161f3501155e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e66e6d0f072aa4fc0627bffc5b1cbd8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a9e66e6d0f072aa4fc0627bffc5b1cbd8">grisu2_round</a> (char *buf, int len, uint64_t dist, uint64_t delta, uint64_t rest, uint64_t ten_k)</td></tr>
<tr class="separator:a9e66e6d0f072aa4fc0627bffc5b1cbd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b899c72b0e1e3dd46d75c2b4e6bcdfb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a9b899c72b0e1e3dd46d75c2b4e6bcdfb">grisu2_digit_gen</a> (char *buffer, int &amp;length, int &amp;decimal_exponent, <a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> M_minus, <a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> w, <a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> M_plus)</td></tr>
<tr class="separator:a9b899c72b0e1e3dd46d75c2b4e6bcdfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05b681dcb8569b9784c6dccfadb01633"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a05b681dcb8569b9784c6dccfadb01633">grisu2</a> (char *buf, int &amp;len, int &amp;decimal_exponent, <a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> m_minus, <a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> v, <a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1diyfp.html">diyfp</a> m_plus)</td></tr>
<tr class="separator:a05b681dcb8569b9784c6dccfadb01633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab7a9670a4f4704a5d0347ad7588576b"><td class="memTemplParams" colspan="2">template&lt;typename FloatType &gt; </td></tr>
<tr class="memitem:aab7a9670a4f4704a5d0347ad7588576b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#aab7a9670a4f4704a5d0347ad7588576b">grisu2</a> (char *buf, int &amp;len, int &amp;decimal_exponent, FloatType value)</td></tr>
<tr class="separator:aab7a9670a4f4704a5d0347ad7588576b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84733638b826eda624488f5fa4521e0b"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a84733638b826eda624488f5fa4521e0b">append_exponent</a> (char *buf, int e)</td></tr>
<tr class="memdesc:a84733638b826eda624488f5fa4521e0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">appends a decimal representation of e to buf  <a href="#a84733638b826eda624488f5fa4521e0b">More...</a><br/></td></tr>
<tr class="separator:a84733638b826eda624488f5fa4521e0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12c1c5d8b46ba9702186445e73f86afe"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a12c1c5d8b46ba9702186445e73f86afe">format_buffer</a> (char *buf, int len, int decimal_exponent, int min_exp, int max_exp)</td></tr>
<tr class="memdesc:a12c1c5d8b46ba9702186445e73f86afe"><td class="mdescLeft">&#160;</td><td class="mdescRight">prettify v = buf * 10^decimal_exponent  <a href="#a12c1c5d8b46ba9702186445e73f86afe">More...</a><br/></td></tr>
<tr class="separator:a12c1c5d8b46ba9702186445e73f86afe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac1ea1316de0b4a219f707c76b1db1966"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#ac1ea1316de0b4a219f707c76b1db1966">kAlpha</a> = -60</td></tr>
<tr class="separator:ac1ea1316de0b4a219f707c76b1db1966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a750fcc38da1ce68b7e25ab3a230e20"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a4a750fcc38da1ce68b7e25ab3a230e20">kGamma</a> = -32</td></tr>
<tr class="separator:a4a750fcc38da1ce68b7e25ab3a230e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>implements the Grisu2 algorithm for binary to decimal floating-point conversion. </p>
<p>This implementation is a slightly modified version of the reference implementation which may be obtained from <a href="http://florian.loitsch.com/publications">http://florian.loitsch.com/publications</a> (bench.tar.gz).</p>
<p>The code is distributed under the MIT license, Copyright (c) 2009 Florian Loitsch.</p>
<p>For a detailed description of the algorithm see:</p>
<p>[1] Loitsch, "Printing Floating-Point Numbers Quickly and Accurately with
    Integers", Proceedings of the ACM SIGPLAN 2010 Conference on Programming Language Design and Implementation, PLDI 2010 [2] Burger, Dybvig, "Printing Floating-Point Numbers Quickly and Accurately", Proceedings of the ACM SIGPLAN 1996 Conference on Programming Language Design and Implementation, PLDI 1996 </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a84733638b826eda624488f5fa4521e0b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char* nlohmann::detail::dtoa_impl::append_exponent </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>appends a decimal representation of e to buf </p>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the element following the exponent. </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>-1000 &lt; e &lt; 1000 </dd></dl>

<p>Definition at line <a class="el" href="json_8h_source.html#l07122">7122</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>Referenced by <a class="el" href="json_8h_source.html#l07163">format_buffer()</a>.</p>
<div class="fragment"><div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;                                                     {</div>
<div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;        assert(e &gt; -1000);</div>
<div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;        assert(e &lt; 1000);</div>
<div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;</div>
<div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;        <span class="keywordflow">if</span> (e &lt; 0) {</div>
<div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;          e = -e;</div>
<div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;          *buf++ = <span class="charliteral">&#39;-&#39;</span>;</div>
<div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;          *buf++ = <span class="charliteral">&#39;+&#39;</span>;</div>
<div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;        }</div>
<div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;</div>
<div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;        uint32_t k = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(e);</div>
<div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;        <span class="keywordflow">if</span> (k &lt; 10) {</div>
<div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;          <span class="comment">// Always print at least two digits in the exponent.</span></div>
<div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;          <span class="comment">// This is for compatibility with printf(&quot;%g&quot;).</span></div>
<div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;          *buf++ = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;          *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k);</div>
<div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &lt; 100) {</div>
<div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;          *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k / 10);</div>
<div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;          k %= 10;</div>
<div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;          *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k);</div>
<div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;          *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k / 100);</div>
<div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;          k %= 100;</div>
<div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;          *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k / 10);</div>
<div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;          k %= 10;</div>
<div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;          *buf++ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + k);</div>
<div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;        }</div>
<div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;</div>
<div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;        <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;      }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a22b6e37654ac93c6d0d9c06ec1bf5ded"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename FloatType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1boundaries.html">boundaries</a> nlohmann::detail::dtoa_impl::compute_boundaries </td>
          <td>(</td>
          <td class="paramtype">FloatType&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the (normalized) diyfp representing the input number 'value' and its boundaries.</p>
<dl class="section pre"><dt>Precondition</dt><dd>value must be finite and positive </dd></dl>

<p>Definition at line <a class="el" href="json_8h_source.html#l06474">6474</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>References <a class="el" href="json_8h_source.html#l06350">nlohmann::detail::dtoa_impl::diyfp::e</a>, <a class="el" href="json_8h_source.html#l06349">nlohmann::detail::dtoa_impl::diyfp::f</a>, <a class="el" href="json_8h_source.html#l06436">nlohmann::detail::dtoa_impl::diyfp::normalize()</a>, and <a class="el" href="json_8h_source.html#l06451">nlohmann::detail::dtoa_impl::diyfp::normalize_to()</a>.</p>

<p>Referenced by <a class="el" href="json_8h_source.html#l07085">grisu2()</a>.</p>
<div class="fragment"><div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;                                                     {</div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;        assert(std::isfinite(value));</div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;        assert(value &gt; 0);</div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;</div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;        <span class="comment">// Convert the IEEE representation into a diyfp.</span></div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;        <span class="comment">// If v is denormal:</span></div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;        <span class="comment">//      value = 0.F * 2^(1 - bias) = (          F) * 2^(1 - bias - (p-1))</span></div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;        <span class="comment">// If v is normalized:</span></div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;        <span class="comment">//      value = 1.F * 2^(E - bias) = (2^(p-1) + F) * 2^(E - bias - (p-1))</span></div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;</div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;        static_assert(std::numeric_limits&lt;FloatType&gt;::is_iec559,</div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;                      <span class="stringliteral">&quot;internal error: dtoa_short requires an IEEE-754 floating-point implementation&quot;</span>);</div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;</div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;        constexpr <span class="keywordtype">int</span> kPrecision = std::numeric_limits&lt;FloatType&gt;::digits; <span class="comment">// = p (includes the hidden bit)</span></div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;        constexpr <span class="keywordtype">int</span> kBias = std::numeric_limits&lt;FloatType&gt;::max_exponent - 1 + (kPrecision - 1);</div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;        constexpr <span class="keywordtype">int</span> kMinExp = 1 - kBias;</div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;        constexpr uint64_t kHiddenBit = uint64_t{1} &lt;&lt; (kPrecision - 1); <span class="comment">// = 2^(p-1)</span></div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;</div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;        <span class="keyword">using</span> bits_type = <span class="keyword">typename</span> std::conditional&lt;kPrecision == 24, uint32_t, uint64_t&gt;::type;</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;</div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;        <span class="keyword">const</span> uint64_t bits = reinterpret_bits&lt;bits_type&gt;(value);</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;        <span class="keyword">const</span> uint64_t E = bits &gt;&gt; (kPrecision - 1);</div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;        <span class="keyword">const</span> uint64_t F = bits &amp; (kHiddenBit - 1);</div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> is_denormal = (E == 0);</div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;        <span class="keyword">const</span> diyfp v = is_denormal ? diyfp(F, kMinExp) : diyfp(F + kHiddenBit, static_cast&lt;int&gt;(E) - kBias);</div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;</div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;        <span class="comment">// Compute the boundaries m- and m+ of the floating-point value</span></div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;        <span class="comment">// v = f * 2^e.</span></div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;        <span class="comment">// Determine v- and v+, the floating-point predecessor and successor if v,</span></div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;        <span class="comment">// respectively.</span></div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;        <span class="comment">//      v- = v - 2^e        if f != 2^(p-1) or e == e_min                (A)</span></div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;        <span class="comment">//         = v - 2^(e-1)    if f == 2^(p-1) and e &gt; e_min                (B)</span></div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;        <span class="comment">//      v+ = v + 2^e</span></div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;        <span class="comment">// Let m- = (v- + v) / 2 and m+ = (v + v+) / 2. All real numbers _strictly_</span></div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;        <span class="comment">// between m- and m+ round to v, regardless of how the input rounding</span></div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;        <span class="comment">// algorithm breaks ties.</span></div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;        <span class="comment">//      ---+-------------+-------------+-------------+-------------+---  (A)</span></div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;        <span class="comment">//         v-            m-            v             m+            v+</span></div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;        <span class="comment">//      -----------------+------+------+-------------+-------------+---  (B)</span></div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;        <span class="comment">//                       v-     m-     v             m+            v+</span></div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;</div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> lower_boundary_is_closer = (F == 0 and E &gt; 1);</div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;        <span class="keyword">const</span> diyfp m_plus = diyfp(2 * v.f + 1, v.e - 1);</div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;        <span class="keyword">const</span> diyfp m_minus = lower_boundary_is_closer ? diyfp(4 * v.f - 1, v.e - 2)  <span class="comment">// (B)</span></div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;                                                       : diyfp(2 * v.f - 1, v.e - 1); <span class="comment">// (A)</span></div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;</div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;        <span class="comment">// Determine the normalized w+ = m+.</span></div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;        <span class="keyword">const</span> diyfp w_plus = diyfp::normalize(m_plus);</div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;</div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;        <span class="comment">// Determine w- = m- such that e_(w-) = e_(w+).</span></div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;        <span class="keyword">const</span> diyfp w_minus = diyfp::normalize_to(m_minus, w_plus.e);</div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;</div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;        <span class="keywordflow">return</span> {diyfp::normalize(v), w_minus, w_plus};</div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;      }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a264df2b5a7e19b864859161f3501155e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int nlohmann::detail::dtoa_impl::find_largest_pow10 </td>
          <td>(</td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t &amp;&#160;</td>
          <td class="paramname"><em>pow10</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>For n != 0, returns k, such that pow10 := 10^(k-1) &lt;= n &lt; 10^k. For n == 0, returns 1 and sets pow10 := 1. </p>

<p>Definition at line <a class="el" href="json_8h_source.html#l06719">6719</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>Referenced by <a class="el" href="json_8h_source.html#l06792">grisu2_digit_gen()</a>.</p>
<div class="fragment"><div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;                                                                       {</div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;        <span class="comment">// LCOV_EXCL_START</span></div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;        <span class="keywordflow">if</span> (n &gt;= 1000000000) {</div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;          pow10 = 1000000000;</div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;          <span class="keywordflow">return</span> 10;</div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;        }</div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;        <span class="comment">// LCOV_EXCL_STOP</span></div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &gt;= 100000000) {</div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;          pow10 = 100000000;</div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;          <span class="keywordflow">return</span> 9;</div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &gt;= 10000000) {</div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;          pow10 = 10000000;</div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;          <span class="keywordflow">return</span> 8;</div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &gt;= 1000000) {</div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;          pow10 = 1000000;</div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;          <span class="keywordflow">return</span> 7;</div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &gt;= 100000) {</div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;          pow10 = 100000;</div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;          <span class="keywordflow">return</span> 6;</div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &gt;= 10000) {</div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;          pow10 = 10000;</div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;          <span class="keywordflow">return</span> 5;</div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &gt;= 1000) {</div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;          pow10 = 1000;</div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;          <span class="keywordflow">return</span> 4;</div>
<div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &gt;= 100) {</div>
<div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;          pow10 = 100;</div>
<div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;          <span class="keywordflow">return</span> 3;</div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n &gt;= 10) {</div>
<div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;          pow10 = 10;</div>
<div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;          <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;          pow10 = 1;</div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;          <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;        }</div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;      }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a12c1c5d8b46ba9702186445e73f86afe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char* nlohmann::detail::dtoa_impl::format_buffer </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>decimal_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>min_exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_exp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>prettify v = buf * 10^decimal_exponent </p>
<p>If v is in the range [10^min_exp, 10^max_exp) it will be printed in fixed-point notation. Otherwise it will be printed in exponential notation.</p>
<dl class="section pre"><dt>Precondition</dt><dd>min_exp &lt; 0 </dd>
<dd>
max_exp &gt; 0 </dd></dl>

<p>Definition at line <a class="el" href="json_8h_source.html#l07163">7163</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>References <a class="el" href="json_8h_source.html#l07122">append_exponent()</a>.</p>

<p>Referenced by <a class="el" href="json_8h_source.html#l07238">nlohmann::detail::to_chars()</a>.</p>
<div class="fragment"><div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;                                                                                                     {</div>
<div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;        assert(min_exp &lt; 0);</div>
<div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;        assert(max_exp &gt; 0);</div>
<div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;</div>
<div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> k = len;</div>
<div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> n = len + decimal_exponent;</div>
<div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;</div>
<div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;        <span class="comment">// v = buf * 10^(n-k)</span></div>
<div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;        <span class="comment">// k is the length of the buffer (number of decimal digits)</span></div>
<div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;        <span class="comment">// n is the position of the decimal point relative to the start of the buffer.</span></div>
<div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;</div>
<div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;        <span class="keywordflow">if</span> (k &lt;= n and n &lt;= max_exp) {</div>
<div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;          <span class="comment">// digits[000]</span></div>
<div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;          <span class="comment">// len &lt;= max_exp + 2</span></div>
<div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;</div>
<div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;          std::memset(buf + k, <span class="charliteral">&#39;0&#39;</span>, static_cast&lt;size_t&gt;(n - k));</div>
<div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;          <span class="comment">// Make it look like a floating-point number (#362, #378)</span></div>
<div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;          buf[n + 0] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;          buf[n + 1] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;          <span class="keywordflow">return</span> buf + (n + 2);</div>
<div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;        }</div>
<div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;</div>
<div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;        <span class="keywordflow">if</span> (0 &lt; n and n &lt;= max_exp) {</div>
<div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;          <span class="comment">// dig.its</span></div>
<div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160;          <span class="comment">// len &lt;= max_digits10 + 1</span></div>
<div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;</div>
<div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;          assert(k &gt; n);</div>
<div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;</div>
<div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;          std::memmove(buf + (n + 1), buf + n, static_cast&lt;size_t&gt;(k - n));</div>
<div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;          buf[n] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;          <span class="keywordflow">return</span> buf + (k + 1);</div>
<div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;        }</div>
<div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;</div>
<div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;        <span class="keywordflow">if</span> (min_exp &lt; n and n &lt;= 0) {</div>
<div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;          <span class="comment">// 0.[000]digits</span></div>
<div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;          <span class="comment">// len &lt;= 2 + (-min_exp - 1) + max_digits10</span></div>
<div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;</div>
<div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;          std::memmove(buf + (2 + -n), buf, static_cast&lt;size_t&gt;(k));</div>
<div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;          buf[0] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;          buf[1] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;          std::memset(buf + 2, <span class="charliteral">&#39;0&#39;</span>, static_cast&lt;size_t&gt;(-n));</div>
<div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;          <span class="keywordflow">return</span> buf + (2 + (-n) + k);</div>
<div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;        }</div>
<div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;</div>
<div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;        <span class="keywordflow">if</span> (k == 1) {</div>
<div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;          <span class="comment">// dE+123</span></div>
<div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;          <span class="comment">// len &lt;= 1 + 5</span></div>
<div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;</div>
<div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;          buf += 1;</div>
<div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;          <span class="comment">// d.igitsE+123</span></div>
<div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;          <span class="comment">// len &lt;= max_digits10 + 1 + 5</span></div>
<div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;</div>
<div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;          std::memmove(buf + 2, buf + 1, static_cast&lt;size_t&gt;(k - 1));</div>
<div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;          buf[1] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;          buf += 1 + k;</div>
<div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;        }</div>
<div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;</div>
<div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;        *buf++ = <span class="charliteral">&#39;e&#39;</span>;</div>
<div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a84733638b826eda624488f5fa4521e0b">append_exponent</a>(buf, n - 1);</div>
<div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;      }</div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_a84733638b826eda624488f5fa4521e0b"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a84733638b826eda624488f5fa4521e0b">nlohmann::detail::dtoa_impl::append_exponent</a></div><div class="ttdeci">char * append_exponent(char *buf, int e)</div><div class="ttdoc">appends a decimal representation of e to buf </div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l07122">json.h:7122</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adbf329a18c5cf854a3477327afd2200b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnlohmann_1_1detail_1_1dtoa__impl_1_1cached__power.html">cached_power</a> nlohmann::detail::dtoa_impl::get_cached_power_for_binary_exponent </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>For a normalized diyfp w = f * 2^e, this function returns a (normalized) cached power-of-ten c = f_c * 2^e_c, such that the exponent of the product w * c satisfies (Definition 3.2 from [1]) </p>
<pre class="fragment"> alpha &lt;= e_c + e + q &lt;= gamma.</pre> 
<p>Definition at line <a class="el" href="json_8h_source.html#l06609">6609</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>References <a class="el" href="json_8h_source.html#l06598">nlohmann::detail::dtoa_impl::cached_power::e</a>, <a class="el" href="json_8h_source.html#l06592">kAlpha</a>, and <a class="el" href="json_8h_source.html#l06593">kGamma</a>.</p>

<p>Referenced by <a class="el" href="json_8h_source.html#l07028">grisu2()</a>.</p>
<div class="fragment"><div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;                                                                      {</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;        <span class="comment">// Now</span></div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;        <span class="comment">//      alpha &lt;= e_c + e + q &lt;= gamma                                    (1)</span></div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;        <span class="comment">//      ==&gt; f_c * 2^alpha &lt;= c * 2^e * 2^q</span></div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;        <span class="comment">// and since the c&#39;s are normalized, 2^(q-1) &lt;= f_c,</span></div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;        <span class="comment">//      ==&gt; 2^(q - 1 + alpha) &lt;= c * 2^(e + q)</span></div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;        <span class="comment">//      ==&gt; 2^(alpha - e - 1) &lt;= c</span></div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;        <span class="comment">// If c were an exakt power of ten, i.e. c = 10^k, one may determine k as</span></div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;        <span class="comment">//      k = ceil( log_10( 2^(alpha - e - 1) ) )</span></div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;        <span class="comment">//        = ceil( (alpha - e - 1) * log_10(2) )</span></div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;        <span class="comment">// From the paper:</span></div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;        <span class="comment">// &quot;In theory the result of the procedure could be wrong since c is rounded,</span></div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;        <span class="comment">//  and the computation itself is approximated [...]. In practice, however,</span></div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;        <span class="comment">//  this simple function is sufficient.&quot;</span></div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;        <span class="comment">// For IEEE double precision floating-point numbers converted into</span></div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;        <span class="comment">// normalized diyfp&#39;s w = f * 2^e, with q = 64,</span></div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;        <span class="comment">//      e &gt;= -1022      (min IEEE exponent)</span></div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;        <span class="comment">//           -52        (p - 1)</span></div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;        <span class="comment">//           -52        (p - 1, possibly normalize denormal IEEE numbers)</span></div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;        <span class="comment">//           -11        (normalize the diyfp)</span></div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;        <span class="comment">//         = -1137</span></div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;        <span class="comment">// and</span></div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;        <span class="comment">//      e &lt;= +1023      (max IEEE exponent)</span></div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;        <span class="comment">//           -52        (p - 1)</span></div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;        <span class="comment">//           -11        (normalize the diyfp)</span></div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;        <span class="comment">//         = 960</span></div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;        <span class="comment">// This binary exponent range [-1137,960] results in a decimal exponent</span></div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;        <span class="comment">// range [-307,324]. One does not need to store a cached power for each</span></div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;        <span class="comment">// k in this range. For each such k it suffices to find a cached power</span></div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;        <span class="comment">// such that the exponent of the product lies in [alpha,gamma].</span></div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;        <span class="comment">// This implies that the difference of the decimal exponents of adjacent</span></div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;        <span class="comment">// table entries must be less than or equal to</span></div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;        <span class="comment">//      floor( (gamma - alpha) * log_10(2) ) = 8.</span></div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;        <span class="comment">// (A smaller distance gamma-alpha would require a larger table.)</span></div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;</div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;        <span class="comment">// NB:</span></div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;        <span class="comment">// Actually this function returns c, such that -60 &lt;= e_c + e + 64 &lt;= -34.</span></div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;</div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;        constexpr <span class="keywordtype">int</span> kCachedPowersSize = 79;</div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;        constexpr <span class="keywordtype">int</span> kCachedPowersMinDecExp = -300;</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;        constexpr <span class="keywordtype">int</span> kCachedPowersDecStep = 8;</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;</div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;        <span class="keyword">static</span> constexpr cached_power kCachedPowers[] = {</div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;            {0xAB70FE17C79AC6CA, -1060, -300}, {0xFF77B1FCBEBCDC4F, -1034, -292}, {0xBE5691EF416BD60C, -1007, -284},</div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;            {0x8DD01FAD907FFC3C, -980, -276},  {0xD3515C2831559A83, -954, -268},  {0x9D71AC8FADA6C9B5, -927, -260},</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;            {0xEA9C227723EE8BCB, -901, -252},  {0xAECC49914078536D, -874, -244},  {0x823C12795DB6CE57, -847, -236},</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;            {0xC21094364DFB5637, -821, -228},  {0x9096EA6F3848984F, -794, -220},  {0xD77485CB25823AC7, -768, -212},</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;            {0xA086CFCD97BF97F4, -741, -204},  {0xEF340A98172AACE5, -715, -196},  {0xB23867FB2A35B28E, -688, -188},</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;            {0x84C8D4DFD2C63F3B, -661, -180},  {0xC5DD44271AD3CDBA, -635, -172},  {0x936B9FCEBB25C996, -608, -164},</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;            {0xDBAC6C247D62A584, -582, -156},  {0xA3AB66580D5FDAF6, -555, -148},  {0xF3E2F893DEC3F126, -529, -140},</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;            {0xB5B5ADA8AAFF80B8, -502, -132},  {0x87625F056C7C4A8B, -475, -124},  {0xC9BCFF6034C13053, -449, -116},</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;            {0x964E858C91BA2655, -422, -108},  {0xDFF9772470297EBD, -396, -100},  {0xA6DFBD9FB8E5B88F, -369, -92},</div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;            {0xF8A95FCF88747D94, -343, -84},   {0xB94470938FA89BCF, -316, -76},   {0x8A08F0F8BF0F156B, -289, -68},</div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;            {0xCDB02555653131B6, -263, -60},   {0x993FE2C6D07B7FAC, -236, -52},   {0xE45C10C42A2B3B06, -210, -44},</div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;            {0xAA242499697392D3, -183, -36},   {0xFD87B5F28300CA0E, -157, -28},   {0xBCE5086492111AEB, -130, -20},</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;            {0x8CBCCC096F5088CC, -103, -12},   {0xD1B71758E219652C, -77, -4},     {0x9C40000000000000, -50, 4},</div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;            {0xE8D4A51000000000, -24, 12},     {0xAD78EBC5AC620000, 3, 20},       {0x813F3978F8940984, 30, 28},</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;            {0xC097CE7BC90715B3, 56, 36},      {0x8F7E32CE7BEA5C70, 83, 44},      {0xD5D238A4ABE98068, 109, 52},</div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;            {0x9F4F2726179A2245, 136, 60},     {0xED63A231D4C4FB27, 162, 68},     {0xB0DE65388CC8ADA8, 189, 76},</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;            {0x83C7088E1AAB65DB, 216, 84},     {0xC45D1DF942711D9A, 242, 92},     {0x924D692CA61BE758, 269, 100},</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;            {0xDA01EE641A708DEA, 295, 108},    {0xA26DA3999AEF774A, 322, 116},    {0xF209787BB47D6B85, 348, 124},</div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;            {0xB454E4A179DD1877, 375, 132},    {0x865B86925B9BC5C2, 402, 140},    {0xC83553C5C8965D3D, 428, 148},</div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;            {0x952AB45CFA97A0B3, 455, 156},    {0xDE469FBD99A05FE3, 481, 164},    {0xA59BC234DB398C25, 508, 172},</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;            {0xF6C69A72A3989F5C, 534, 180},    {0xB7DCBF5354E9BECE, 561, 188},    {0x88FCF317F22241E2, 588, 196},</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;            {0xCC20CE9BD35C78A5, 614, 204},    {0x98165AF37B2153DF, 641, 212},    {0xE2A0B5DC971F303A, 667, 220},</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;            {0xA8D9D1535CE3B396, 694, 228},    {0xFB9B7CD9A4A7443C, 720, 236},    {0xBB764C4CA7A44410, 747, 244},</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;            {0x8BAB8EEFB6409C1A, 774, 252},    {0xD01FEF10A657842C, 800, 260},    {0x9B10A4E5E9913129, 827, 268},</div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;            {0xE7109BFBA19C0C9D, 853, 276},    {0xAC2820D9623BF429, 880, 284},    {0x80444B5E7AA7CF85, 907, 292},</div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;            {0xBF21E44003ACDD2D, 933, 300},    {0x8E679C2F5E44FF8F, 960, 308},    {0xD433179D9C8CB841, 986, 316},</div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;            {0x9E19DB92B4E31BA9, 1013, 324},</div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;        };</div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;</div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;        <span class="comment">// This computation gives exactly the same results for k as</span></div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;        <span class="comment">//      k = ceil((kAlpha - e - 1) * 0.30102999566398114)</span></div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;        <span class="comment">// for |e| &lt;= 1500, but doesn&#39;t require floating-point operations.</span></div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;        <span class="comment">// NB: log_10(2) ~= 78913 / 2^18</span></div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;        assert(e &gt;= -1500);</div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;        assert(e &lt;= 1500);</div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> f = <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#ac1ea1316de0b4a219f707c76b1db1966">kAlpha</a> - e - 1;</div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> k = (f * 78913) / (1 &lt;&lt; 18) + (f &gt; 0);</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;</div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> index = (-kCachedPowersMinDecExp + k + (kCachedPowersDecStep - 1)) / kCachedPowersDecStep;</div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;        assert(index &gt;= 0);</div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;        assert(index &lt; kCachedPowersSize);</div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;        <span class="keyword">static_cast&lt;</span><span class="keywordtype">void</span><span class="keyword">&gt;</span>(kCachedPowersSize); <span class="comment">// Fix warning.</span></div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;</div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;        <span class="keyword">const</span> cached_power cached = kCachedPowers[index];</div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;        assert(<a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#ac1ea1316de0b4a219f707c76b1db1966">kAlpha</a> &lt;= cached.e + e + 64);</div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;        assert(<a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a4a750fcc38da1ce68b7e25ab3a230e20">kGamma</a> &gt;= cached.e + e + 64);</div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;</div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;        <span class="keywordflow">return</span> cached;</div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;      }</div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_ac1ea1316de0b4a219f707c76b1db1966"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#ac1ea1316de0b4a219f707c76b1db1966">nlohmann::detail::dtoa_impl::kAlpha</a></div><div class="ttdeci">constexpr int kAlpha</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l06592">json.h:6592</a></div></div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_a4a750fcc38da1ce68b7e25ab3a230e20"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a4a750fcc38da1ce68b7e25ab3a230e20">nlohmann::detail::dtoa_impl::kGamma</a></div><div class="ttdeci">constexpr int kGamma</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l06593">json.h:6593</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a05b681dcb8569b9784c6dccfadb01633"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nlohmann::detail::dtoa_impl::grisu2 </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>decimal_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">diyfp&#160;</td>
          <td class="paramname"><em>m_minus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">diyfp&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">diyfp&#160;</td>
          <td class="paramname"><em>m_plus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>v = buf * 10^decimal_exponent len is the length of the buffer (number of decimal digits) The buffer must be large enough, i.e. &gt;= max_digits10. </p>

<p>Definition at line <a class="el" href="json_8h_source.html#l07028">7028</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>References <a class="el" href="json_8h_source.html#l06350">nlohmann::detail::dtoa_impl::diyfp::e</a>, <a class="el" href="json_8h_source.html#l06598">nlohmann::detail::dtoa_impl::cached_power::e</a>, <a class="el" href="json_8h_source.html#l06349">nlohmann::detail::dtoa_impl::diyfp::f</a>, <a class="el" href="json_8h_source.html#l06597">nlohmann::detail::dtoa_impl::cached_power::f</a>, <a class="el" href="json_8h_source.html#l06609">get_cached_power_for_binary_exponent()</a>, <a class="el" href="json_8h_source.html#l06792">grisu2_digit_gen()</a>, <a class="el" href="json_8h_source.html#l06599">nlohmann::detail::dtoa_impl::cached_power::k</a>, and <a class="el" href="json_8h_source.html#l06372">nlohmann::detail::dtoa_impl::diyfp::mul()</a>.</p>

<p>Referenced by <a class="el" href="json_8h_source.html#l07085">grisu2()</a>, and <a class="el" href="json_8h_source.html#l07238">nlohmann::detail::to_chars()</a>.</p>
<div class="fragment"><div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;                                                                                                           {</div>
<div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;        assert(m_plus.e == m_minus.e);</div>
<div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;        assert(m_plus.e == v.e);</div>
<div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;</div>
<div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;        <span class="comment">//  --------(-----------------------+-----------------------)--------    (A)</span></div>
<div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;        <span class="comment">//          m-                      v                       m+</span></div>
<div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;        <span class="comment">//  --------------------(-----------+-----------------------)--------    (B)</span></div>
<div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;        <span class="comment">//                      m-          v                       m+</span></div>
<div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;        <span class="comment">// First scale v (and m- and m+) such that the exponent is in the range</span></div>
<div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;        <span class="comment">// [alpha, gamma].</span></div>
<div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;</div>
<div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;        <span class="keyword">const</span> cached_power cached = <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#adbf329a18c5cf854a3477327afd2200b">get_cached_power_for_binary_exponent</a>(m_plus.e);</div>
<div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;</div>
<div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;        <span class="keyword">const</span> diyfp c_minus_k(cached.f, cached.e); <span class="comment">// = c ~= 10^-k</span></div>
<div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;</div>
<div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;        <span class="comment">// The exponent of the products is = v.e + c_minus_k.e + q and is in the range [alpha,gamma]</span></div>
<div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;        <span class="keyword">const</span> diyfp w = diyfp::mul(v, c_minus_k);</div>
<div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;        <span class="keyword">const</span> diyfp w_minus = diyfp::mul(m_minus, c_minus_k);</div>
<div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;        <span class="keyword">const</span> diyfp w_plus = diyfp::mul(m_plus, c_minus_k);</div>
<div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;</div>
<div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;        <span class="comment">//  ----(---+---)---------------(---+---)---------------(---+---)----</span></div>
<div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;        <span class="comment">//          w-                      w                       w+</span></div>
<div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;        <span class="comment">//          = c*m-                  = c*v                   = c*m+</span></div>
<div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;        <span class="comment">// diyfp::mul rounds its result and c_minus_k is approximated too. w, w- and</span></div>
<div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;        <span class="comment">// w+ are now off by a small amount.</span></div>
<div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;        <span class="comment">// In fact:</span></div>
<div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;        <span class="comment">//      w - v * 10^k &lt; 1 ulp</span></div>
<div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;        <span class="comment">// To account for this inaccuracy, add resp. subtract 1 ulp.</span></div>
<div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;        <span class="comment">//  --------+---[---------------(---+---)---------------]---+--------</span></div>
<div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;        <span class="comment">//          w-  M-                  w                   M+  w+</span></div>
<div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;        <span class="comment">// Now any number in [M-, M+] (bounds included) will round to w when input,</span></div>
<div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;        <span class="comment">// regardless of how the input rounding algorithm breaks ties.</span></div>
<div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;        <span class="comment">// And digit_gen generates the shortest possible such number in [M-, M+].</span></div>
<div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;        <span class="comment">// Note that this does not mean that Grisu2 always generates the shortest</span></div>
<div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;        <span class="comment">// possible number in the interval (m-, m+).</span></div>
<div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;        <span class="keyword">const</span> diyfp M_minus(w_minus.f + 1, w_minus.e);</div>
<div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;        <span class="keyword">const</span> diyfp M_plus(w_plus.f - 1, w_plus.e);</div>
<div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;</div>
<div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;        decimal_exponent = -cached.k; <span class="comment">// = -(-k) = k</span></div>
<div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;</div>
<div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;        <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a9b899c72b0e1e3dd46d75c2b4e6bcdfb">grisu2_digit_gen</a>(buf, len, decimal_exponent, M_minus, w, M_plus);</div>
<div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;      }</div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_a9b899c72b0e1e3dd46d75c2b4e6bcdfb"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a9b899c72b0e1e3dd46d75c2b4e6bcdfb">nlohmann::detail::dtoa_impl::grisu2_digit_gen</a></div><div class="ttdeci">void grisu2_digit_gen(char *buffer, int &amp;length, int &amp;decimal_exponent, diyfp M_minus, diyfp w, diyfp M_plus)</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l06792">json.h:6792</a></div></div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_adbf329a18c5cf854a3477327afd2200b"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#adbf329a18c5cf854a3477327afd2200b">nlohmann::detail::dtoa_impl::get_cached_power_for_binary_exponent</a></div><div class="ttdeci">cached_power get_cached_power_for_binary_exponent(int e)</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l06609">json.h:6609</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aab7a9670a4f4704a5d0347ad7588576b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename FloatType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void nlohmann::detail::dtoa_impl::grisu2 </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>decimal_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FloatType&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>v = buf * 10^decimal_exponent len is the length of the buffer (number of decimal digits) The buffer must be large enough, i.e. &gt;= max_digits10. </p>

<p>Definition at line <a class="el" href="json_8h_source.html#l07085">7085</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>References <a class="el" href="json_8h_source.html#l06474">compute_boundaries()</a>, <a class="el" href="json_8h_source.html#l07028">grisu2()</a>, <a class="el" href="json_8h_source.html#l06347">nlohmann::detail::dtoa_impl::diyfp::kPrecision</a>, <a class="el" href="json_8h_source.html#l06463">nlohmann::detail::dtoa_impl::boundaries::minus</a>, <a class="el" href="json_8h_source.html#l06464">nlohmann::detail::dtoa_impl::boundaries::plus</a>, and <a class="el" href="json_8h_source.html#l06462">nlohmann::detail::dtoa_impl::boundaries::w</a>.</p>
<div class="fragment"><div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;                                                                               {</div>
<div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;        static_assert(diyfp::kPrecision &gt;= std::numeric_limits&lt;FloatType&gt;::digits + 3,</div>
<div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;                      <span class="stringliteral">&quot;internal error: not enough precision&quot;</span>);</div>
<div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;</div>
<div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;        assert(std::isfinite(value));</div>
<div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;        assert(value &gt; 0);</div>
<div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;</div>
<div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;<span class="comment">// If the neighbors (and boundaries) of &#39;value&#39; are always computed for double-precision</span></div>
<div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;<span class="comment">// numbers, all float&#39;s can be recovered using strtod (and strtof). However, the resulting</span></div>
<div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;<span class="comment">// decimal representations are not exactly &quot;short&quot;.</span></div>
<div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;<span class="comment">// The documentation for &#39;std::to_chars&#39; (http://en.cppreference.com/w/cpp/utility/to_chars)</span></div>
<div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;<span class="comment">// says &quot;value is converted to a string as if by std::sprintf in the default (&quot;C&quot;) locale&quot;</span></div>
<div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;<span class="comment">// and since sprintf promotes float&#39;s to double&#39;s, I think this is exactly what &#39;std::to_chars&#39;</span></div>
<div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;<span class="comment">// does.</span></div>
<div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;<span class="comment">// On the other hand, the documentation for &#39;std::to_chars&#39; requires that &quot;parsing the</span></div>
<div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;<span class="comment">// representation using the corresponding std::from_chars function recovers value exactly&quot;. That</span></div>
<div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;<span class="comment">// indicates that single precision floating-point numbers should be recovered using</span></div>
<div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;<span class="comment">// &#39;std::strtof&#39;.</span></div>
<div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;<span class="comment">// NB: If the neighbors are computed for single-precision numbers, there is a single float</span></div>
<div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;<span class="comment">//     (7.0385307e-26f) which can&#39;t be recovered using strtod. The resulting double precision</span></div>
<div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;<span class="comment">//     value is off by 1 ulp.</span></div>
<div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;<span class="preprocessor"></span>    <span class="keyword">const</span> boundaries w = <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a22b6e37654ac93c6d0d9c06ec1bf5ded">compute_boundaries</a>(static_cast&lt;double&gt;(value));</div>
<div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;<span class="preprocessor"></span>        <span class="keyword">const</span> boundaries w = <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a22b6e37654ac93c6d0d9c06ec1bf5ded">compute_boundaries</a>(value);</div>
<div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;        <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#aab7a9670a4f4704a5d0347ad7588576b">grisu2</a>(buf, len, decimal_exponent, w.minus, w.w, w.plus);</div>
<div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;      }</div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_a22b6e37654ac93c6d0d9c06ec1bf5ded"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a22b6e37654ac93c6d0d9c06ec1bf5ded">nlohmann::detail::dtoa_impl::compute_boundaries</a></div><div class="ttdeci">boundaries compute_boundaries(FloatType value)</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l06474">json.h:6474</a></div></div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_aab7a9670a4f4704a5d0347ad7588576b"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#aab7a9670a4f4704a5d0347ad7588576b">nlohmann::detail::dtoa_impl::grisu2</a></div><div class="ttdeci">void grisu2(char *buf, int &amp;len, int &amp;decimal_exponent, FloatType value)</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l07085">json.h:7085</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9b899c72b0e1e3dd46d75c2b4e6bcdfb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nlohmann::detail::dtoa_impl::grisu2_digit_gen </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>decimal_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">diyfp&#160;</td>
          <td class="paramname"><em>M_minus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">diyfp&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">diyfp&#160;</td>
          <td class="paramname"><em>M_plus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generates V = buffer * 10^decimal_exponent, such that M- &lt;= V &lt;= M+. M- and M+ must be normalized and share the same exponent -60 &lt;= e &lt;= -32. </p>

<p>Definition at line <a class="el" href="json_8h_source.html#l06792">6792</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>References <a class="el" href="json_8h_source.html#l06350">nlohmann::detail::dtoa_impl::diyfp::e</a>, <a class="el" href="json_8h_source.html#l06349">nlohmann::detail::dtoa_impl::diyfp::f</a>, <a class="el" href="json_8h_source.html#l06719">find_largest_pow10()</a>, <a class="el" href="json_8h_source.html#l06756">grisu2_round()</a>, <a class="el" href="json_8h_source.html#l06592">kAlpha</a>, <a class="el" href="json_8h_source.html#l06593">kGamma</a>, and <a class="el" href="json_8h_source.html#l06361">nlohmann::detail::dtoa_impl::diyfp::sub()</a>.</p>

<p>Referenced by <a class="el" href="json_8h_source.html#l07028">grisu2()</a>.</p>
<div class="fragment"><div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;                                                 {</div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;        static_assert(<a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#ac1ea1316de0b4a219f707c76b1db1966">kAlpha</a> &gt;= -60, <span class="stringliteral">&quot;internal error&quot;</span>);</div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;        static_assert(<a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a4a750fcc38da1ce68b7e25ab3a230e20">kGamma</a> &lt;= -32, <span class="stringliteral">&quot;internal error&quot;</span>);</div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;        <span class="comment">// Generates the digits (and the exponent) of a decimal floating-point</span></div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;        <span class="comment">// number V = buffer * 10^decimal_exponent in the range [M-, M+]. The diyfp&#39;s</span></div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;        <span class="comment">// w, M- and M+ share the same exponent e, which satisfies alpha &lt;= e &lt;= gamma.</span></div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;        <span class="comment">//               &lt;--------------------------- delta ----&gt;</span></div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;        <span class="comment">//                                  &lt;---- dist ---------&gt;</span></div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;        <span class="comment">// --------------[------------------+-------------------]--------------</span></div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;        <span class="comment">//               M-                 w                   M+</span></div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;        <span class="comment">// Grisu2 generates the digits of M+ from left to right and stops as soon as</span></div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;        <span class="comment">// V is in [M-,M+].</span></div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;</div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;        assert(M_plus.e &gt;= <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#ac1ea1316de0b4a219f707c76b1db1966">kAlpha</a>);</div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;        assert(M_plus.e &lt;= <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a4a750fcc38da1ce68b7e25ab3a230e20">kGamma</a>);</div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;</div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;        uint64_t delta = diyfp::sub(M_plus, M_minus).f; <span class="comment">// (significand of (M+ - M-), implicit exponent is e)</span></div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;        uint64_t dist = diyfp::sub(M_plus, w).f;        <span class="comment">// (significand of (M+ - w ), implicit exponent is e)</span></div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;        <span class="comment">// Split M+ = f * 2^e into two parts p1 and p2 (note: e &lt; 0):</span></div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;        <span class="comment">//      M+ = f * 2^e</span></div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;        <span class="comment">//         = ((f div 2^-e) * 2^-e + (f mod 2^-e)) * 2^e</span></div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;        <span class="comment">//         = ((p1        ) * 2^-e + (p2        )) * 2^e</span></div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;        <span class="comment">//         = p1 + p2 * 2^e</span></div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;</div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;        <span class="keyword">const</span> diyfp one(uint64_t{1} &lt;&lt; -M_plus.e, M_plus.e);</div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;</div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;        uint32_t p1 =</div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;            <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(M_plus.f &gt;&gt; -one.e); <span class="comment">// p1 = f div 2^-e (Since -e &gt;= 32, p1 fits into a 32-bit int.)</span></div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;        uint64_t p2 = M_plus.f &amp; (one.f - 1);          <span class="comment">// p2 = f mod 2^-e</span></div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;</div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;        <span class="comment">// 1)</span></div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;        <span class="comment">// Generate the digits of the integral part p1 = d[n-1]...d[1]d[0]</span></div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;</div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;        assert(p1 &gt; 0);</div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;</div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;        uint32_t pow10;</div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> k = <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a264df2b5a7e19b864859161f3501155e">find_largest_pow10</a>(p1, pow10);</div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;</div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;        <span class="comment">//      10^(k-1) &lt;= p1 &lt; 10^k, pow10 = 10^(k-1)</span></div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;        <span class="comment">//      p1 = (p1 div 10^(k-1)) * 10^(k-1) + (p1 mod 10^(k-1))</span></div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;        <span class="comment">//         = (d[k-1]         ) * 10^(k-1) + (p1 mod 10^(k-1))</span></div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;        <span class="comment">//      M+ = p1                                             + p2 * 2^e</span></div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;        <span class="comment">//         = d[k-1] * 10^(k-1) + (p1 mod 10^(k-1))          + p2 * 2^e</span></div>
<div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;        <span class="comment">//         = d[k-1] * 10^(k-1) + ((p1 mod 10^(k-1)) * 2^-e + p2) * 2^e</span></div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;        <span class="comment">//         = d[k-1] * 10^(k-1) + (                         rest) * 2^e</span></div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;        <span class="comment">// Now generate the digits d[n] of p1 from left to right (n = k-1,...,0)</span></div>
<div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;        <span class="comment">//      p1 = d[k-1]...d[n] * 10^n + d[n-1]...d[0]</span></div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;        <span class="comment">// but stop as soon as</span></div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;        <span class="comment">//      rest * 2^e = (d[n-1]...d[0] * 2^-e + p2) * 2^e &lt;= delta * 2^e</span></div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;</div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;        <span class="keywordtype">int</span> n = k;</div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;        <span class="keywordflow">while</span> (n &gt; 0) {</div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;          <span class="comment">// Invariants:</span></div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;          <span class="comment">//      M+ = buffer * 10^n + (p1 + p2 * 2^e)    (buffer = 0 for n = k)</span></div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;          <span class="comment">//      pow10 = 10^(n-1) &lt;= p1 &lt; 10^n</span></div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;          <span class="keyword">const</span> uint32_t d = p1 / pow10; <span class="comment">// d = p1 div 10^(n-1)</span></div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;          <span class="keyword">const</span> uint32_t r = p1 % pow10; <span class="comment">// r = p1 mod 10^(n-1)</span></div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;          <span class="comment">//      M+ = buffer * 10^n + (d * 10^(n-1) + r) + p2 * 2^e</span></div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;          <span class="comment">//         = (buffer * 10 + d) * 10^(n-1) + (r + p2 * 2^e)</span></div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;          assert(d &lt;= 9);</div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;          buffer[length++] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + d); <span class="comment">// buffer := buffer * 10 + d</span></div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;          <span class="comment">//      M+ = buffer * 10^(n-1) + (r + p2 * 2^e)</span></div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;          p1 = r;</div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;          n--;</div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;          <span class="comment">//      M+ = buffer * 10^n + (p1 + p2 * 2^e)</span></div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;          <span class="comment">//      pow10 = 10^n</span></div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;</div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;          <span class="comment">// Now check if enough digits have been generated.</span></div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;          <span class="comment">// Compute</span></div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;          <span class="comment">//      p1 + p2 * 2^e = (p1 * 2^-e + p2) * 2^e = rest * 2^e</span></div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;          <span class="comment">// Note:</span></div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;          <span class="comment">// Since rest and delta share the same exponent e, it suffices to</span></div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;          <span class="comment">// compare the significands.</span></div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;          <span class="keyword">const</span> uint64_t rest = (uint64_t{p1} &lt;&lt; -one.e) + p2;</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;          <span class="keywordflow">if</span> (rest &lt;= delta) {</div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;            <span class="comment">// V = buffer * 10^n, with M- &lt;= V &lt;= M+.</span></div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;</div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;            decimal_exponent += n;</div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;</div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;            <span class="comment">// We may now just stop. But instead look if the buffer could be</span></div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;            <span class="comment">// decremented to bring V closer to w.</span></div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;            <span class="comment">// pow10 = 10^n is now 1 ulp in the decimal representation V.</span></div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;            <span class="comment">// The rounding procedure works with diyfp&#39;s with an implicit</span></div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;            <span class="comment">// exponent of e.</span></div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;            <span class="comment">//      10^n = (10^n * 2^-e) * 2^e = ulp * 2^e</span></div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;            <span class="keyword">const</span> uint64_t ten_n = uint64_t{pow10} &lt;&lt; -one.e;</div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;            <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a9e66e6d0f072aa4fc0627bffc5b1cbd8">grisu2_round</a>(buffer, length, dist, delta, rest, ten_n);</div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;</div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;          }</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;</div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;          pow10 /= 10;</div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;          <span class="comment">//      pow10 = 10^(n-1) &lt;= p1 &lt; 10^n</span></div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;          <span class="comment">// Invariants restored.</span></div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;        }</div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;</div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;        <span class="comment">// 2)</span></div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;        <span class="comment">// The digits of the integral part have been generated:</span></div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;        <span class="comment">//      M+ = d[k-1]...d[1]d[0] + p2 * 2^e</span></div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;        <span class="comment">//         = buffer            + p2 * 2^e</span></div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;        <span class="comment">// Now generate the digits of the fractional part p2 * 2^e.</span></div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;        <span class="comment">// Note:</span></div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;        <span class="comment">// No decimal point is generated: the exponent is adjusted instead.</span></div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;        <span class="comment">// p2 actually represents the fraction</span></div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;        <span class="comment">//      p2 * 2^e</span></div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;        <span class="comment">//          = p2 / 2^-e</span></div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;        <span class="comment">//          = d[-1] / 10^1 + d[-2] / 10^2 + ...</span></div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;        <span class="comment">// Now generate the digits d[-m] of p1 from left to right (m = 1,2,...)</span></div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;        <span class="comment">//      p2 * 2^e = d[-1]d[-2]...d[-m] * 10^-m</span></div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;        <span class="comment">//                      + 10^-m * (d[-m-1] / 10^1 + d[-m-2] / 10^2 + ...)</span></div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;        <span class="comment">// using</span></div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;        <span class="comment">//      10^m * p2 = ((10^m * p2) div 2^-e) * 2^-e + ((10^m * p2) mod 2^-e)</span></div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;        <span class="comment">//                = (                   d) * 2^-e + (                   r)</span></div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;        <span class="comment">// or</span></div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;        <span class="comment">//      10^m * p2 * 2^e = d + r * 2^e</span></div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;        <span class="comment">// i.e.</span></div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;        <span class="comment">//      M+ = buffer + p2 * 2^e</span></div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;        <span class="comment">//         = buffer + 10^-m * (d + r * 2^e)</span></div>
<div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;        <span class="comment">//         = (buffer * 10^m + d) * 10^-m + 10^-m * r * 2^e</span></div>
<div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;        <span class="comment">// and stop as soon as 10^-m * r * 2^e &lt;= delta * 2^e</span></div>
<div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;</div>
<div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;        assert(p2 &gt; delta);</div>
<div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;</div>
<div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;        <span class="keywordtype">int</span> m = 0;</div>
<div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;        <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;          <span class="comment">// Invariant:</span></div>
<div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;          <span class="comment">//      M+ = buffer * 10^-m + 10^-m * (d[-m-1] / 10 + d[-m-2] / 10^2 + ...) * 2^e</span></div>
<div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;          <span class="comment">//         = buffer * 10^-m + 10^-m * (p2                                 ) * 2^e</span></div>
<div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;          <span class="comment">//         = buffer * 10^-m + 10^-m * (1/10 * (10 * p2)                   ) * 2^e</span></div>
<div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;          <span class="comment">//         = buffer * 10^-m + 10^-m * (1/10 * ((10*p2 div 2^-e) * 2^-e + (10*p2 mod 2^-e)) * 2^e</span></div>
<div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;          assert(p2 &lt;= UINT64_MAX / 10);</div>
<div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;          p2 *= 10;</div>
<div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;          <span class="keyword">const</span> uint64_t d = p2 &gt;&gt; -one.e;     <span class="comment">// d = (10 * p2) div 2^-e</span></div>
<div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;          <span class="keyword">const</span> uint64_t r = p2 &amp; (one.f - 1); <span class="comment">// r = (10 * p2) mod 2^-e</span></div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;          <span class="comment">//      M+ = buffer * 10^-m + 10^-m * (1/10 * (d * 2^-e + r) * 2^e</span></div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;          <span class="comment">//         = buffer * 10^-m + 10^-m * (1/10 * (d + r * 2^e))</span></div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;          <span class="comment">//         = (buffer * 10 + d) * 10^(-m-1) + 10^(-m-1) * r * 2^e</span></div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;          assert(d &lt;= 9);</div>
<div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;          buffer[length++] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(<span class="charliteral">&#39;0&#39;</span> + d); <span class="comment">// buffer := buffer * 10 + d</span></div>
<div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;          <span class="comment">//      M+ = buffer * 10^(-m-1) + 10^(-m-1) * r * 2^e</span></div>
<div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;          p2 = r;</div>
<div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;          m++;</div>
<div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;          <span class="comment">//      M+ = buffer * 10^-m + 10^-m * p2 * 2^e</span></div>
<div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;          <span class="comment">// Invariant restored.</span></div>
<div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;</div>
<div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;          <span class="comment">// Check if enough digits have been generated.</span></div>
<div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;          <span class="comment">//      10^-m * p2 * 2^e &lt;= delta * 2^e</span></div>
<div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;          <span class="comment">//              p2 * 2^e &lt;= 10^m * delta * 2^e</span></div>
<div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;          <span class="comment">//                    p2 &lt;= 10^m * delta</span></div>
<div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;          delta *= 10;</div>
<div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;          dist *= 10;</div>
<div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;          <span class="keywordflow">if</span> (p2 &lt;= delta) {</div>
<div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;          }</div>
<div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;        }</div>
<div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;</div>
<div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;        <span class="comment">// V = buffer * 10^-m, with M- &lt;= V &lt;= M+.</span></div>
<div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;</div>
<div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;        decimal_exponent -= m;</div>
<div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;</div>
<div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;        <span class="comment">// 1 ulp in the decimal representation is now 10^-m.</span></div>
<div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;        <span class="comment">// Since delta and dist are now scaled by 10^m, we need to do the</span></div>
<div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;        <span class="comment">// same with ulp in order to keep the units in sync.</span></div>
<div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;        <span class="comment">//      10^m * 10^-m = 1 = 2^-e * 2^e = ten_m * 2^e</span></div>
<div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;        <span class="keyword">const</span> uint64_t ten_m = one.f;</div>
<div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;        <a class="code" href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a9e66e6d0f072aa4fc0627bffc5b1cbd8">grisu2_round</a>(buffer, length, dist, delta, p2, ten_m);</div>
<div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;</div>
<div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;        <span class="comment">// By construction this algorithm generates the shortest possible decimal</span></div>
<div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;        <span class="comment">// number (Loitsch, Theorem 6.2) which rounds back to w.</span></div>
<div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;        <span class="comment">// For an input number of precision p, at least</span></div>
<div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;        <span class="comment">//      N = 1 + ceil(p * log_10(2))</span></div>
<div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;        <span class="comment">// decimal digits are sufficient to identify all binary floating-point</span></div>
<div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;        <span class="comment">// numbers (Matula, &quot;In-and-Out conversions&quot;).</span></div>
<div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;        <span class="comment">// This implies that the algorithm does not produce more than N decimal</span></div>
<div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;        <span class="comment">// digits.</span></div>
<div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;        <span class="comment">//      N = 17 for p = 53 (IEEE double precision)</span></div>
<div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;        <span class="comment">//      N = 9  for p = 24 (IEEE single precision)</span></div>
<div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;      }</div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_ac1ea1316de0b4a219f707c76b1db1966"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#ac1ea1316de0b4a219f707c76b1db1966">nlohmann::detail::dtoa_impl::kAlpha</a></div><div class="ttdeci">constexpr int kAlpha</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l06592">json.h:6592</a></div></div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_a4a750fcc38da1ce68b7e25ab3a230e20"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a4a750fcc38da1ce68b7e25ab3a230e20">nlohmann::detail::dtoa_impl::kGamma</a></div><div class="ttdeci">constexpr int kGamma</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l06593">json.h:6593</a></div></div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_a9e66e6d0f072aa4fc0627bffc5b1cbd8"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a9e66e6d0f072aa4fc0627bffc5b1cbd8">nlohmann::detail::dtoa_impl::grisu2_round</a></div><div class="ttdeci">void grisu2_round(char *buf, int len, uint64_t dist, uint64_t delta, uint64_t rest, uint64_t ten_k)</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l06756">json.h:6756</a></div></div>
<div class="ttc" id="namespacenlohmann_1_1detail_1_1dtoa__impl_html_a264df2b5a7e19b864859161f3501155e"><div class="ttname"><a href="namespacenlohmann_1_1detail_1_1dtoa__impl.html#a264df2b5a7e19b864859161f3501155e">nlohmann::detail::dtoa_impl::find_largest_pow10</a></div><div class="ttdeci">int find_largest_pow10(const uint32_t n, uint32_t &amp;pow10)</div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l06719">json.h:6719</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9e66e6d0f072aa4fc0627bffc5b1cbd8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nlohmann::detail::dtoa_impl::grisu2_round </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>rest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>ten_k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="json_8h_source.html#l06756">6756</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>Referenced by <a class="el" href="json_8h_source.html#l06792">grisu2_digit_gen()</a>.</p>
<div class="fragment"><div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;                                                                                                                 {</div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;        assert(len &gt;= 1);</div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;        assert(dist &lt;= delta);</div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;        assert(rest &lt;= delta);</div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;        assert(ten_k &gt; 0);</div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;</div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;        <span class="comment">//               &lt;--------------------------- delta ----&gt;</span></div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;        <span class="comment">//                                  &lt;---- dist ---------&gt;</span></div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;        <span class="comment">// --------------[------------------+-------------------]--------------</span></div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;        <span class="comment">//               M-                 w                   M+</span></div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;        <span class="comment">//                                  ten_k</span></div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;        <span class="comment">//                                &lt;------&gt;</span></div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;        <span class="comment">//                                       &lt;---- rest ----&gt;</span></div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;        <span class="comment">// --------------[------------------+----+--------------]--------------</span></div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;        <span class="comment">//                                  w    V</span></div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;        <span class="comment">//                                       = buf * 10^k</span></div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;        <span class="comment">// ten_k represents a unit-in-the-last-place in the decimal representation</span></div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;        <span class="comment">// stored in buf.</span></div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;        <span class="comment">// Decrement buf by ten_k while this takes buf closer to w.</span></div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;</div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;        <span class="comment">// The tests are written in this order to avoid overflow in unsigned</span></div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;        <span class="comment">// integer arithmetic.</span></div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;</div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;        <span class="keywordflow">while</span> (rest &lt; dist and delta - rest &gt;= ten_k and (rest + ten_k &lt; dist or dist - rest &gt; rest + ten_k - dist)) {</div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;          assert(buf[len - 1] != <span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;          buf[len - 1]--;</div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;          rest += ten_k;</div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;        }</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;      }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1c5d30eb51e5e994a3f48bde104d2ce8"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Target , typename Source &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Target nlohmann::detail::dtoa_impl::reinterpret_bits </td>
          <td>(</td>
          <td class="paramtype">const Source&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="json_8h_source.html#l06337">6337</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>
<div class="fragment"><div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;                                                   {</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;        static_assert(<span class="keyword">sizeof</span>(Target) == <span class="keyword">sizeof</span>(Source), <span class="stringliteral">&quot;size mismatch&quot;</span>);</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;</div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;        Target target;</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;        std::memcpy(&amp;target, &amp;source, <span class="keyword">sizeof</span>(Source));</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;        <span class="keywordflow">return</span> target;</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;      }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ac1ea1316de0b4a219f707c76b1db1966"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int nlohmann::detail::dtoa_impl::kAlpha = -60</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="json_8h_source.html#l06592">6592</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>Referenced by <a class="el" href="json_8h_source.html#l06609">get_cached_power_for_binary_exponent()</a>, and <a class="el" href="json_8h_source.html#l06792">grisu2_digit_gen()</a>.</p>

</div>
</div>
<a class="anchor" id="a4a750fcc38da1ce68b7e25ab3a230e20"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int nlohmann::detail::dtoa_impl::kGamma = -32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="json_8h_source.html#l06593">6593</a> of file <a class="el" href="json_8h_source.html">json.h</a>.</p>

<p>Referenced by <a class="el" href="json_8h_source.html#l06609">get_cached_power_for_binary_exponent()</a>, and <a class="el" href="json_8h_source.html#l06792">grisu2_digit_gen()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 7 2018 11:25:31 for DQMCore by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
